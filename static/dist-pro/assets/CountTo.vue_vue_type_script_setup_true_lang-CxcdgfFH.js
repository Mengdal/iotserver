import{p as r,b as k,m as q}from"./index-CAdyeJt3.js";import{x as v,X as E,R as M,j as N,c as R,w as z,u as c,y as B,z as $,M as j,C as P}from"./vue-chunks-C1K3ngR7.js";const H=v({__name:"CountTo",props:{startVal:r.number.def(0),endVal:r.number.def(2021),duration:r.number.def(3e3),autoplay:r.bool.def(!0),decimals:r.number.validate(o=>o>=0).def(0),decimal:r.string.def("."),separator:r.string.def(","),prefix:r.string.def(""),suffix:r.string.def(""),useEasing:r.bool.def(!0),easingFn:{type:Function,default(o,p,m,d){return m*(-Math.pow(2,-10*o/d)+1)*1024/1023+p}}},emits:["mounted","callback"],setup(o,{expose:p,emit:m}){const{getPrefixCls:d}=k(),S=d("count-to"),t=o,b=m,V=l=>{const{decimals:n,decimal:i,separator:e,suffix:s,prefix:h}=t;l=Number(l).toFixed(n),l+="";const F=l.split(".");let u=F[0];const w=F.length>1?i+F[1]:"",D=/(\d+)(\d{3})/;if(e&&!q(e))for(;D.test(u);)u=u.replace(D,"$1"+e+"$2");return h+u+w+s},a=E({localStartVal:t.startVal,displayValue:V(t.startVal),printVal:null,paused:!1,localDuration:t.duration,startTime:null,timestamp:null,remaining:null,rAF:null}),A=M(a,"displayValue");N(()=>{t.autoplay&&g(),b("mounted")});const f=R(()=>t.startVal>t.endVal);z([()=>t.startVal,()=>t.endVal],()=>{t.autoplay&&g()});const g=()=>{const{startVal:l,duration:n}=t;a.localStartVal=l,a.startTime=null,a.localDuration=n,a.paused=!1,a.rAF=requestAnimationFrame(x)},T=()=>{a.paused?(C(),a.paused=!1):(y(),a.paused=!0)},y=()=>{cancelAnimationFrame(a.rAF)},C=()=>{a.startTime=null,a.localDuration=+a.remaining,a.localStartVal=+a.printVal,requestAnimationFrame(x)},_=()=>{a.startTime=null,cancelAnimationFrame(a.rAF),a.displayValue=V(t.startVal)},x=l=>{const{useEasing:n,easingFn:i,endVal:e}=t;a.startTime||(a.startTime=l),a.timestamp=l;const s=l-a.startTime;a.remaining=a.localDuration-s,n?c(f)?a.printVal=a.localStartVal-i(s,0,a.localStartVal-e,a.localDuration):a.printVal=i(s,a.localStartVal,e-a.localStartVal,a.localDuration):c(f)?a.printVal=a.localStartVal-(a.localStartVal-e)*(s/a.localDuration):a.printVal=a.localStartVal+(e-a.localStartVal)*(s/a.localDuration),c(f)?a.printVal=a.printVal<e?e:a.printVal:a.printVal=a.printVal>e?e:a.printVal,a.displayValue=V(a.printVal),s<a.localDuration?a.rAF=requestAnimationFrame(x):b("callback")};return p({pauseResume:T,reset:_,start:g,pause:y}),(l,n)=>(B(),$("span",{class:P(c(S))},j(A.value),3))}});export{H as _};
