import{_ as X}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CrtdylkU.js";import{_ as J}from"./Search.vue_vue_type_script_setup_true_lang-BCCD0GAn.js";import{_ as Q}from"./Dialog.vue_vue_type_style_index_0_lang-aEWcq84Q.js";import{c as W,i}from"./index-CAdyeJt3.js";/* empty css               */import{_ as Y}from"./Table.vue_vue_type_script_lang-D3v-kC-o.js";import{r as D}from"./index-DfycOL0q.js";import{u as Z}from"./useTable-Cg8mTZpf.js";import{_ as ee}from"./Write.vue_vue_type_script_setup_true_lang-DsOEgzsF.js";import{_ as te}from"./Detail.vue_vue_type_script_setup_true_lang-CUrTjpX0.js";import{u as ae}from"./useCrudSchemas-CWNcgDVA.js";import{m as E}from"./element-plus--V1NSjC4.js";import{x as le,r as n,X as oe,P as o,O as m,u as e,y as v,z as re,H as u,A as se,L as b,M as h,l as B,G as C,K as P,aa as ne}from"./vue-chunks-C1K3ngR7.js";/* empty css                *//* empty css                  */import"./Form-CzZbC4Aj.js";/* empty css               *//* empty css                */import"./el-checkbox-group-Cm0j4lwI.js";/* empty css                       *//* empty css                  */import"./Highlight.vue_vue_type_script_lang-BYSr0XZy.js";/* empty css                */import"./wang-editor-Bckixh16.js";import"./useForm-CD85wrwf.js";/* empty css                  *//* empty css                        *//* empty css                         *//* empty css                  */import"./useValidator-Barz9SCp.js";import"./Descriptions-wDWhutuy.js";import"./tree-R6XTZANN.js";const ie=()=>D.get({url:"/mock/department/list"}),me=s=>D.post({url:"/mock/department/save",data:s}),ue=s=>D.post({url:"/mock/department/delete",data:{ids:s}}),de=s=>D.get({url:"/mock/department/table/list",params:s}),ce={class:"mb-10px"};function T(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!ne(s)}const Fe=le({__name:"Department",setup(s){const y=n([]),{tableRegister:j,tableState:A,tableMethods:I}=Z({fetchDataApi:async()=>{const{currentPage:t,pageSize:a}=A,r=await de({pageIndex:e(t),pageSize:e(a),...e(R)});return{list:r.data.list,total:r.data.total}},fetchDelApi:async()=>!!await ue(e(y))}),{loading:O,dataList:U,total:K,currentPage:p,pageSize:_}=A,{getList:N,getElTableExpose:M,delList:q}=I,R=n({}),V=t=>{R.value=t,N()},{t:l}=W(),F=oe([{field:"selection",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0},table:{type:"selection"}},{field:"index",label:l("tableDemo.index"),type:"index",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0}},{field:"id",label:l("userDemo.departmentName"),table:{slots:{default:t=>o(m,null,[t.row.departmentName])}},form:{component:"TreeSelect",componentProps:{nodeKey:"id",props:{label:"departmentName"}},optionApi:async()=>(await ie()).data.list},detail:{slots:{default:t=>o(m,null,[t.departmentName])}}},{field:"status",label:l("userDemo.status"),search:{hidden:!0},table:{slots:{default:t=>{const a=t.row.status;return o(m,null,[o(E,{type:a===0?"danger":"success"},{default:()=>[l(a===1?"userDemo.enable":"userDemo.disable")]})])}}},form:{component:"Select",componentProps:{options:[{value:0,label:l("userDemo.disable")},{value:1,label:l("userDemo.enable")}]}},detail:{slots:{default:t=>o(m,null,[o(E,{type:t.status===0?"danger":"success"},{default:()=>[t.status===1?l("userDemo.enable"):l("userDemo.disable")]})])}}},{field:"createTime",label:l("tableDemo.displayTime"),search:{hidden:!0},form:{hidden:!0}},{field:"remark",label:l("userDemo.remark"),search:{hidden:!0},form:{component:"Input",componentProps:{type:"textarea",rows:5},colProps:{span:24}},detail:{slots:{default:t=>o(m,null,[t.remark])}}},{field:"action",width:"260px",label:l("tableDemo.action"),search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0},table:{slots:{default:t=>{let a,r,S;return o(m,null,[o(i,{type:"primary",onClick:()=>z(t.row,"edit")},T(a=l("exampleDemo.edit"))?a:{default:()=>[a]}),o(i,{type:"success",onClick:()=>z(t.row,"detail")},T(r=l("exampleDemo.detail"))?r:{default:()=>[r]}),o(i,{type:"danger",onClick:()=>$(t.row)},T(S=l("exampleDemo.del"))?S:{default:()=>[S]})])}}}}]),{allSchemas:f}=ae(F),d=n(!1),w=n(""),g=n(null),c=n(""),G=()=>{w.value=l("exampleDemo.add"),g.value=null,d.value=!0,c.value=""},x=n(!1),$=async t=>{const a=await M();y.value=t?[t.id]:a?.getSelectionRows().map(r=>r.id)||[],x.value=!0,await q(e(y).length).finally(()=>{x.value=!1})},z=(t,a)=>{w.value=l(a==="edit"?"exampleDemo.edit":"exampleDemo.detail"),c.value=a,g.value=t,d.value=!0},L=n(),k=n(!1),H=async()=>{const a=await e(L)?.submit();a&&(k.value=!0,await me(a).catch(()=>{}).finally(()=>{k.value=!1})&&(d.value=!1,p.value=1,N()))};return(t,a)=>(v(),re(m,null,[o(e(X),null,{default:u(()=>[o(e(J),{schema:e(f).searchSchema,onSearch:V,onReset:V},null,8,["schema"]),se("div",ce,[o(e(i),{type:"primary",onClick:G},{default:u(()=>[b(h(e(l)("exampleDemo.add")),1)]),_:1}),o(e(i),{loading:x.value,type:"danger",onClick:a[0]||(a[0]=r=>$(null))},{default:u(()=>[b(h(e(l)("exampleDemo.del")),1)]),_:1},8,["loading"])]),o(e(Y),{pageSize:e(_),"onUpdate:pageSize":a[1]||(a[1]=r=>B(_)?_.value=r:null),currentPage:e(p),"onUpdate:currentPage":a[2]||(a[2]=r=>B(p)?p.value=r:null),columns:e(f).tableColumns,data:e(U),loading:e(O),pagination:{total:e(K)},onRegister:e(j)},null,8,["pageSize","currentPage","columns","data","loading","pagination","onRegister"])]),_:1}),o(e(Q),{modelValue:d.value,"onUpdate:modelValue":a[4]||(a[4]=r=>d.value=r),title:w.value},{footer:u(()=>[c.value!=="detail"?(v(),C(e(i),{key:0,type:"primary",loading:k.value,onClick:H},{default:u(()=>[b(h(e(l)("exampleDemo.save")),1)]),_:1},8,["loading"])):P("",!0),o(e(i),{onClick:a[3]||(a[3]=r=>d.value=!1)},{default:u(()=>[b(h(e(l)("dialogDemo.close")),1)]),_:1})]),default:u(()=>[c.value!=="detail"?(v(),C(ee,{key:0,ref_key:"writeRef",ref:L,"form-schema":e(f).formSchema,"current-row":g.value},null,8,["form-schema","current-row"])):P("",!0),c.value==="detail"?(v(),C(te,{key:1,"detail-schema":e(f).detailSchema,"current-row":g.value},null,8,["detail-schema","current-row"])):P("",!0)]),_:1},8,["modelValue","title"])],64))}});export{Fe as default};
