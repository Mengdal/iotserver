import{_ as Ce}from"./Table.vue_vue_type_script_lang-D3v-kC-o.js";import{o as ae,b as He,c as Ue,u as De}from"./index-CIdFgJMS.js";import{_ as ie}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CrtdylkU.js";import{u as Ee}from"./useTable-Cg8mTZpf.js";import{g as Se,c as qe,f as Ne,e as O,_ as Pe}from"./index-CAdyeJt3.js";import{d as S,i as ue,b as k,p as Ae}from"./element-plus--V1NSjC4.js";import{g as ze,a as Le,b as Be}from"./index-BTXJkdku.js";import{x as Me,r as y,c as We,X as re,P as o,O as V,w as Fe,ag as _,aq as Oe,y as p,z as R,H as n,u as t,L as f,M as b,I as $e,G as T,A as w,l as je,K as x,a4 as $,aa as Je}from"./vue-chunks-C1K3ngR7.js";/* empty css                        *//* empty css                *//* empty css                  *//* empty css               */import"./el-checkbox-group-Cm0j4lwI.js";/* empty css                *//* empty css                         *//* empty css                  *//* empty css                       */import"./index-DfycOL0q.js";const Ke={class:"mb-10px"},Ge={class:"flex items-center"},Xe={class:"flex items-center"},Ze={class:"mx-2"},Qe={class:"flex items-center"},Ye={class:"mx-2"},el={class:"flex items-center"},ll={class:"mx-2"},tl={class:"flex items-center"},ol={class:"mx-2"},al={class:"drawer-footer"};function de(P){return typeof P=="function"||Object.prototype.toString.call(P)==="[object Object]"&&!Je(P)}const il=Me({__name:"AlarmRules",setup(P){const Q=Se(),{t:e}=qe(),A=y({}),z=y({}),L=y({}),j=y({}),J=y(!1),K=y(e("device.addRule")),U=y(!1),D=y("add"),ne=We(()=>window.innerHeight-303),m=y({searName:"",status:"",page:1,size:20,name:"",alarmtype:e("device.deviceAlarm"),alert_level:"",description:""}),g=y(["告警中心"]),a=y({id:"",condition:"anyone",sub_rule:[{product_id:"",device_ids:[],option:{code:"",value_type:"",value_cycle:"",decide:">",name:"",threshold:null,status:"",event:""},trigger:e("device.deviceDataTrigger")}],silence_time:null,notify:[{name:e("device.wecomRobot"),option:{webhook:""},start_effect_time:"",end_effect_time:""},{name:e("device.dingtalkRobot"),option:{webhook:""},start_effect_time:"",end_effect_time:""},{name:e("device.feishuRobot"),option:{webhook:""},start_effect_time:"",end_effect_time:""},{name:e("device.apiInterface"),option:{webhook:""},start_effect_time:"",end_effect_time:""}]}),Y=y({}),{tableRegister:se,tableState:ee,tableMethods:ce}=Ee({fetchDataApi:async()=>{const{currentPage:r,pageSize:l}=ee,u=await He({page:t(r),size:t(l),...t(Y)});return{list:u.data.list,total:u.data.totalRow}}}),{dataList:ve,total:me,currentPage:B,pageSize:ul}=ee,{getList:q}=ce,pe=re([{field:"name",label:e("device.alarmRuleName")},{field:"description",label:e("device.description")},{field:"alert_type",label:e("device.alarmType")},{field:"alert_level",label:e("device.alarmLevel")},{field:"created",label:e("device.createTime"),formatter:r=>Ne(r.created*1e3,"yyyy-MM-dd HH:mm:ss")},{field:"status",label:e("device.status"),formatter:r=>r.status==="running"?e("userDemo.enable"):e("userDemo.disable")},{field:"action",label:e("device.operation"),width:"240px",formatter:r=>{let l,u;return o(V,null,[o(O,{permission:"Enable"},{default:()=>[o(S,{text:!0,type:r.status==="running"?"danger":"success",onClick:()=>X(r,"Initiation")},{default:()=>[r.status==="running"?e("userDemo.disable"):e("userDemo.enable")]})]}),o(O,{permission:"Edit"},{default:()=>[o(S,{text:!0,type:"primary",onClick:()=>X(r,"edit")},de(l=e("device.edit"))?l:{default:()=>[l]})]}),o(O,{permission:"Delete"},{default:()=>[o(S,{text:!0,type:"danger",onClick:()=>X(r,"delete")},de(u=e("device.delete"))?u:{default:()=>[u]})]})])}}]),G=(r,l=null)=>{try{return!r||typeof r!="string"?l:JSON.parse(r)}catch(u){return console.error("JSON解析失败:",u),l}},X=async(r,l)=>{try{if(a.value.id=r.id,l==="Initiation"){const u=r.status==="running"?"stop":"start",d=r.status==="running"?e("device.confirmDisableThisRule"):e("device.confirmEnableThisRule");await ue.confirm(d,e("common.delWarning"),{confirmButtonText:e("common.delOk"),cancelButtonText:e("common.cancel"),type:"warning"});const c=await ae({ruleId:r.name,action:u});c.code===200?(k.success(e("device.operationSuccess")),await q()):k.error(c.message||e("device.operationFailed"))}else if(l==="edit"){J.value=!0;try{const u={...r,device_id:G(r.device_id,[]),sub_rule:G(r.sub_rule,[]),notify:G(r.notify,[])};if(m.value={name:u.name||"",alarmtype:u.alert_type||"设备告警",alert_level:u.alert_level||"",description:u.description||""},a.value={id:u.id||"",condition:u.condition||"anyone",sub_rule:[{product_id:"",device_ids:[],trigger:"设备数据触发",option:{code:"",value_type:"",value_cycle:"",decide:">",threshold:null,name:"",event:"",status:""}}],silence_time:u.silence_time||"0",notify:[{name:e("device.wecomRobot"),option:{webhook:""},start_effect_time:"",end_effect_time:""},{name:e("device.dingtalkRobot"),option:{webhook:""},start_effect_time:"",end_effect_time:""},{name:e("device.feishuRobot"),option:{webhook:""},start_effect_time:"",end_effect_time:""},{name:e("device.apiInterface"),option:{webhook:""},start_effect_time:"",end_effect_time:""}]},u.sub_rule&&u.sub_rule.length>0){const d=u.sub_rule[0];a.value.sub_rule[0]={product_id:d.productId||d.product_id||"",device_ids:Array.isArray(d.deviceId)?d.deviceId:d.deviceId?[d.deviceId]:[],trigger:d.trigger||"设备数据触发",option:{code:d.option?.code||"",value_type:d.option?.value_type||"",value_cycle:d.option?.value_cycle||"",decide:d.option?.decide_condition?.split(" ")[0]||">",threshold:d.option?.decide_condition?.split(" ")[1]||null,name:d.option?.name||"",event:d.option?.event||"",status:d.option?.status||""}}}u.notify&&u.notify.length>0&&u.notify.forEach(d=>{const c=a.value.notify.findIndex(I=>I.name===d.name);c!==-1&&(a.value.notify[c]={name:d.name,option:{webhook:d.option?.webhook||""},start_effect_time:d.start_effect_time||"",end_effect_time:d.end_effect_time||""})}),g.value=u.notify?u.notify.filter(d=>d.name).map(d=>d.name):["告警中心"],g.value.push("告警中心"),g.value,K.value=e("device.editRule"),D.value="edit",await we(),a.value.sub_rule[0]?.product_id&&(await Z(a.value.sub_rule[0].product_id),await F(a.value.sub_rule[0].product_id)),U.value=!0}catch(u){console.error("解析或初始化编辑数据失败:",u),k.error(e("device.initEditDataFailed"))}finally{J.value=!1}}else if(l==="delete"){await ue.confirm(e("common.delMessage"),e("common.delWarning"),{confirmButtonText:e("common.ok"),cancelButtonText:e("common.cancel"),type:"error"});const u=await ae({ruleId:r.name,action:"delete"});u.code===200?(k.success(e("device.operationSuccess")),await q()):k.error(u.message||e("device.operationFailed"))}}catch(u){console.error("操作取消:",u)}},v=(r,l)=>(a.value.notify||(a.value.notify=[]),a.value.notify[r]||(a.value.notify[r]={name:l,option:{webhook:""},start_effect_time:"",end_effect_time:""}),a.value.notify[r].name!==l&&(a.value.notify[r].name=l),a.value.notify[r].option||(a.value.notify[r].option={webhook:""}),a.value.notify[r]),fe=r=>{const l=z.value.find(u=>u.value===r);l&&(a.value.sub_rule[0].option.name=l.label)},be=async()=>{try{B.value=1,Y.value={name:m.value.searName.trim()},await q(),k.success(e("device.operationSuccess"))}catch(r){console.error("查询失败:",r),k.error(e("device.operationFailed"))}},_e=()=>{D.value="add",U.value=!0,K.value=e("device.addRule")},ge=(r,l,u)=>{if(!l)return u(new Error(e("device.pleaseEnterIdentifier")));if(/^[0-9]/.test(l))return u(new Error(e("device.identifierCannotStartWithNumber")));if(!/^[a-zA-Z0-9\-_#@\s]+$/.test(l))return u(new Error(e("device.identifierOnlyAllowChars")));u()},le=(r,l,u)=>{const d=a.value.sub_rule[0]?.option?.decide,c=a.value.sub_rule[0]?.option?.threshold;if(!d)return u(new Error(e("device.pleaseSelectJudgmentOperator")));if(c==null||c==="")return u(new Error(e("device.pleaseInputThreshold")));if(isNaN(Number(c)))return u(new Error(e("device.thresholdMustBeValidNumber")));u()},M=(r,l)=>(u,d,c)=>{if(!g.value.includes(l)){c();return}if(!d||d.trim()===""){c(new Error(`${e("common.inputText")}${l}Webhook${e("descriptionsDemo.addr")}`));return}if(!d.startsWith("http://")&&!d.startsWith("https://")){c(new Error(e("device.webhookFormatIncorrect")));return}c()},W=(r,l)=>(u,d,c)=>{if(!g.value.includes(l)){c();return}const I=a.value.notify[r].start_effect_time,C=a.value.notify[r].end_effect_time;if(!I||!C){c(new Error(e("device.pleaseSelectCompleteEffectiveTimeRangeOf")));return}if(I>=C){c(new Error(e("device.pleaseSelectCorrectTimeRange")));return}c()},te=re({name:[{required:!0,message:e("common.inputText"),trigger:"blur"},{validator:ge,trigger:"blur"}],alert_level:[{required:!0,message:e("common.selectText"),trigger:"change"}],"sub_rule[0].trigger":[{required:!0,message:e("common.selectText"),trigger:"change"}],"sub_rule[0].product_id":[{required:!0,message:e("common.selectText"),trigger:"change"}],"sub_rule[0].device_ids":[{required:!0,message:e("common.selectText"),trigger:"change",validator:(r,l,u)=>{!l||l.length===0?u(new Error(r.message)):u()}}],"sub_rule[0].option.event":[{required:!0,message:e("common.selectText"),trigger:"change"}],"sub_rule[0].option.status":[{required:!0,message:e("common.selectText"),trigger:"change"}],"sub_rule[0].option.code":[{required:!0,message:e("common.selectText"),trigger:"change"}],"sub_rule[0].option.value_type":[{required:!0,message:e("common.selectText"),trigger:"change"}],"sub_rule[0].option.value_cycle":[{required:!0,message:e("common.selectText"),trigger:"change"}],"sub_rule[0].option.decide":[{required:!0,validator:le,trigger:["change","blur"]}],"sub_rule[0].option.threshold":[{required:!0,validator:le,trigger:["change","blur"]}],"notify[0].option.webhook":[{required:!0,validator:M(0,e("device.wecomRobot")),trigger:["change","blur"]}],"notify[0].time":[{required:!0,validator:W(0,e("device.wecomRobot")),trigger:["change","blur"]}],"notify[1].option.webhook":[{required:!0,validator:M(1,e("device.dingtalkRobot")),trigger:["change","blur"]}],"notify[1].time":[{required:!0,validator:W(1,e("device.dingtalkRobot")),trigger:["change","blur"]}],"notify[2].option.webhook":[{required:!0,validator:M(2,e("device.feishuRobot")),trigger:["change","blur"]}],"notify[2].time":[{required:!0,validator:W(2,e("device.feishuRobot")),trigger:["change","blur"]}],"notify[3].option.webhook":[{required:!0,validator:M(3,e("device.apiInterface")),trigger:["change","blur"]}],"notify[3].time":[{required:!0,validator:W(3,e("device.apiInterface")),trigger:["change","blur"]}]}),ye=async()=>{let r={};if(D.value==="add")r={alert_level:m.value.alert_level,description:m.value.description,name:m.value.name},(await Ue(r)).code===200&&(k.success(e("device.operationSuccess")),U.value=!1,await q());else if(D.value==="edit"){let l=await he();(await De(l)).code===200&&(k.success(e("device.operationSuccess")),U.value=!1,await q());return}},he=()=>{let r={condition:a.value.condition,sub_rule:[],silence_time:a.value.silence_time,notify:[],name:m.value.name};return a.value.sub_rule[0].trigger==="设备数据触发"?r.sub_rule.push({productId:a.value.sub_rule[0].product_id,deviceId:a.value.sub_rule[0].device_ids,trigger:a.value.sub_rule[0].trigger,option:{code:a.value.sub_rule[0].option.code,value_type:a.value.sub_rule[0].option.value_type,value_cycle:a.value.sub_rule[0].option.value_cycle,decide_condition:a.value.sub_rule[0].option.decide+" "+a.value.sub_rule[0].option.threshold,name:a.value.sub_rule[0].option.name}}):a.value.sub_rule[0].trigger==="设备事件触发"?r.sub_rule.push({productId:a.value.sub_rule[0].product_id,deviceId:a.value.sub_rule[0].device_ids,trigger:a.value.sub_rule[0].trigger,option:{event:a.value.sub_rule[0].option.event}}):a.value.sub_rule[0].trigger==="设备状态触发"&&r.sub_rule.push({productId:a.value.sub_rule[0].product_id,deviceId:a.value.sub_rule[0].device_ids,trigger:a.value.sub_rule[0].trigger,option:{status:a.value.sub_rule[0].option.status}}),a.value.notify.forEach((l,u)=>{g.value.includes(l.name)&&r.notify.push({name:l.name,option:{webhook:l.option.webhook},start_effect_time:l.start_effect_time,end_effect_time:l.end_effect_time})}),r},Ve=async r=>{const l=A.value.find(u=>u.value===r);l&&(a.value.sub_rule[0].product_name=l.label),a.value.sub_rule[0].device_ids=[],await Z(a.value.sub_rule[0].product_id),await F(a.value.sub_rule[0].product_id)},we=async()=>{try{let r=await ze({page:1,size:100});if(r.code===200){if(A.value=r.data.list.map(l=>({label:l.name,value:l.id})),a.value.sub_rule[0]?.product_id){const l=A.value.find(u=>u.value===a.value.sub_rule[0].product_id)}a.value.sub_rule[0]?.product_id&&(await Z(a.value.sub_rule[0].product_id),a.value.sub_rule[0]?.device_id&&await F(a.value.sub_rule[0].device_id))}}catch(r){console.error("获取产品列表失败:",r),k.error(e("device.getProductListFailed"))}},Z=async r=>{let l={};Q.getProject.enable?l={productId:r,projectId:Q.getProjectId}:l={productId:r};const d=await Le(l);d.code===200&&d.data?L.value=d.data.map(c=>{const I={label:c.name,value:c.name,children:[]};return c.children&&c.children.length>0&&(I.children=c.children.map(C=>({label:C.name,value:C.name,type:C.type}))),I}):L.value=[]},F=async r=>{let l=await Be({productId:r});l.data.events,l.code===200&&l.data.properties&&(z.value=l.data.properties.map(u=>({label:u.name,value:u.code}))),l.code===200&&l.data.events&&(j.value=l.data.events.map(u=>({label:u.name,value:u.code}))),j.value,z.value},ke=async r=>{const l=L.value.find(u=>u.value===r);l&&(a.value.sub_rule[0].device_name=l.label),a.value.sub_rule[0].option.code=""};return Fe(()=>[a.value.sub_rule[0].option.trigger,a.value.sub_rule[0].option.product_id],([r,l])=>{r==="设备事件触发"&&l&&F(a.value.sub_rule[0].option.product_id)},{immediate:!0}),(r,l)=>{const u=_("el-input"),d=_("el-form-item"),c=_("el-form"),I=_("BaseButton"),C=_("el-radio"),Re=_("el-radio-group"),s=_("el-option"),h=_("el-select"),E=_("el-divider"),oe=_("el-text"),N=_("el-checkbox"),Te=_("el-checkbox-group"),H=_("el-time-picker"),xe=_("el-drawer"),Ie=Oe("loading");return p(),R(V,null,[o(t(ie),null,{default:n(()=>[o(c,{model:m.value,inline:!0},{default:n(()=>[o(d,{label:t(e)("device.ruleName")},{default:n(()=>[o(u,{modelValue:m.value.searName,"onUpdate:modelValue":l[0]||(l[0]=i=>m.value.searName=i),clearable:"",placeholder:t(e)("common.inputText")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(d,null,{default:n(()=>[o(t(S),{type:"primary",onClick:be},{default:n(()=>[f(b(t(e)("device.query")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),$e((p(),T(t(ie),null,{default:n(()=>[w("div",Ke,[o(t(O),{permission:"Create"},{default:n(()=>[o(I,{type:"primary",icon:t(Ae),onClick:_e},{default:n(()=>[f(b(t(e)("device.addRule")),1)]),_:1},8,["icon"])]),_:1})]),o(t(Ce),{border:!1,pageSize:m.value.size,"onUpdate:pageSize":l[1]||(l[1]=i=>m.value.size=i),size:"small",currentPage:t(B),"onUpdate:currentPage":l[2]||(l[2]=i=>je(B)?B.value=i:null),columns:pe,data:t(ve),height:ne.value,pagination:{total:t(me),pageSizes:[20,40,50,100,1e3]},onRegister:t(se),showAction:""},null,8,["pageSize","currentPage","columns","data","height","pagination","onRegister"])]),_:1})),[[Ie,J.value]]),o(xe,{modelValue:U.value,"onUpdate:modelValue":l[32]||(l[32]=i=>U.value=i),title:K.value,size:"50%",direction:"rtl",class:"demo-drawer"},{footer:n(()=>[w("div",al,[o(t(S),{onClick:l[31]||(l[31]=i=>U.value=!1)},{default:n(()=>[f(b(t(e)("common.cancel")),1)]),_:1}),o(t(S),{type:"primary",onClick:ye},{default:n(()=>[f(b(t(e)("dialogDemo.submit")),1)]),_:1})])]),default:n(()=>[D.value==="add"?(p(),T(c,{key:0,model:m.value,rules:te,ref:"form","label-position":"top"},{default:n(()=>[o(d,{label:t(e)("device.ruleName"),prop:"name"},{default:n(()=>[o(u,{modelValue:m.value.name,"onUpdate:modelValue":l[3]||(l[3]=i=>m.value.name=i),placeholder:t(e)("device.sceneNameRule")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(d,{label:t(e)("device.alarmType")},{default:n(()=>[o(Re,{modelValue:m.value.alarmtype,"onUpdate:modelValue":l[4]||(l[4]=i=>m.value.alarmtype=i)},{default:n(()=>[o(C,{value:"设备告警",size:"large"},{default:n(()=>[f(b(t(e)("device.deviceAlarm")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),o(d,{label:t(e)("device.alarmLevel"),prop:"alert_level"},{default:n(()=>[o(h,{modelValue:m.value.alert_level,"onUpdate:modelValue":l[5]||(l[5]=i=>m.value.alert_level=i),placeholder:t(e)("common.inputText")},{default:n(()=>[o(s,{label:t(e)("device.critical"),value:"紧急"},null,8,["label"]),o(s,{label:t(e)("device.important"),value:"重要"},null,8,["label"]),o(s,{label:t(e)("device.minor"),value:"次要"},null,8,["label"]),o(s,{label:t(e)("device.prompt"),value:"提示"},null,8,["label"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(d,{label:t(e)("device.ruleDescription")},{default:n(()=>[o(u,{modelValue:m.value.description,"onUpdate:modelValue":l[6]||(l[6]=i=>m.value.description=i),type:"textarea",rows:4,placeholder:t(e)("common.inputText"),maxlength:"500","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])):x("",!0),D.value==="edit"?(p(),T(c,{key:1,model:a.value,rules:te,ref:"editForm","label-position":"top"},{default:n(()=>[o(E,{"content-position":"left"},{default:n(()=>[f(b(t(e)("device.startRule")),1)]),_:1}),o(d,{label:t(e)("device.triggerMode"),prop:"sub_rule[0].trigger"},{default:n(()=>[o(h,{modelValue:a.value.sub_rule[0].trigger,"onUpdate:modelValue":l[7]||(l[7]=i=>a.value.sub_rule[0].trigger=i)},{default:n(()=>[o(s,{label:t(e)("device.deviceDataTrigger"),value:"设备数据触发"},null,8,["label"]),o(s,{label:t(e)("device.deviceEventTrigger"),value:"设备事件触发"},null,8,["label"]),o(s,{label:t(e)("device.deviceStatusTrigger"),value:"设备状态触发"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),o(d,{label:t(e)("device.product"),prop:"sub_rule[0].product_id"},{default:n(()=>[o(h,{modelValue:a.value.sub_rule[0].product_id,"onUpdate:modelValue":l[8]||(l[8]=i=>a.value.sub_rule[0].product_id=i),onChange:Ve},{default:n(()=>[(p(!0),R(V,null,$(A.value,i=>(p(),T(s,{key:i.value,label:i.label,value:i.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),o(d,{label:t(e)("device.device"),prop:"sub_rule[0].device_ids"},{default:n(()=>[o(h,{modelValue:a.value.sub_rule[0].device_ids,"onUpdate:modelValue":l[9]||(l[9]=i=>a.value.sub_rule[0].device_ids=i),onChange:ke,multiple:""},{default:n(()=>[(p(!0),R(V,null,$(L.value,i=>(p(),T(s,{key:i.value,label:i.label,value:i.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),a.value.sub_rule[0].trigger==="设备数据触发"?(p(),R(V,{key:0},[o(d,{label:t(e)("device.attribute"),prop:"sub_rule[0].option.code"},{default:n(()=>[o(h,{modelValue:a.value.sub_rule[0].option.code,"onUpdate:modelValue":l[10]||(l[10]=i=>a.value.sub_rule[0].option.code=i),onChange:fe},{default:n(()=>[(p(!0),R(V,null,$(z.value,i=>(p(),T(s,{key:i.value,label:i.label,value:i.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),o(d,{label:t(e)("device.fetchValueType"),prop:"sub_rule[0].option.value_type"},{default:n(()=>[o(h,{modelValue:a.value.sub_rule[0].option.value_type,"onUpdate:modelValue":l[11]||(l[11]=i=>a.value.sub_rule[0].option.value_type=i)},{default:n(()=>[o(s,{label:t(e)("device.originalValue"),value:"original"},null,8,["label"]),o(s,{label:t(e)("device.averageValue"),value:"avg"},null,8,["label"]),o(s,{label:t(e)("device.maxValue"),value:"max"},null,8,["label"]),o(s,{label:t(e)("device.minValue"),value:"min"},null,8,["label"]),o(s,{label:t(e)("device.sumValue"),value:"sum"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),a.value.sub_rule[0].option.value_type!=="original"?(p(),T(d,{key:0,label:t(e)("device.valueCycle"),prop:"sub_rule[0].option.value_cycle"},{default:n(()=>[o(h,{modelValue:a.value.sub_rule[0].option.value_cycle,"onUpdate:modelValue":l[12]||(l[12]=i=>a.value.sub_rule[0].option.value_cycle=i)},{default:n(()=>[o(s,{label:"1"+t(e)("device.minuteCycle"),value:"1分钟周期"},null,8,["label"]),o(s,{label:"5"+t(e)("device.minuteCycle"),value:"5分钟周期"},null,8,["label"]),o(s,{label:"15"+t(e)("device.minuteCycle"),value:"15分钟周期"},null,8,["label"]),o(s,{label:"30"+t(e)("device.minuteCycle"),value:"30分钟周期"},null,8,["label"]),o(s,{label:"60"+t(e)("device.minuteCycle"),value:"60分钟周期"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"])):x("",!0),o(d,{label:t(e)("device.judgmentCondition"),prop:"sub_rule[0].option.decide"},{default:n(()=>[w("div",Ge,[o(h,{modelValue:a.value.sub_rule[0].option.decide,"onUpdate:modelValue":l[13]||(l[13]=i=>a.value.sub_rule[0].option.decide=i),style:{width:"100px"}},{default:n(()=>[o(s,{label:">",value:">"}),o(s,{label:"<",value:"<"}),o(s,{label:"=",value:"="}),o(s,{label:">=",value:">="}),o(s,{label:"<=",value:"<="}),o(s,{label:"!=",value:"!="})]),_:1},8,["modelValue"]),o(u,{modelValue:a.value.sub_rule[0].option.threshold,"onUpdate:modelValue":l[14]||(l[14]=i=>a.value.sub_rule[0].option.threshold=i),placeholder:t(e)("device.threshold"),style:{"margin-left":"10px",width:"150px"}},null,8,["modelValue","placeholder"])])]),_:1},8,["label"])],64)):x("",!0),a.value.sub_rule[0].trigger==="设备事件触发"?(p(),T(d,{key:1,label:t(e)("device.deviceEvent"),prop:"sub_rule[0].option.event"},{default:n(()=>[o(h,{style:{width:"100%"},modelValue:a.value.sub_rule[0].option.event,"onUpdate:modelValue":l[15]||(l[15]=i=>a.value.sub_rule[0].option.event=i),placeholder:t(e)("common.inputText"),filterable:"",clearable:""},{default:n(()=>[(p(!0),R(V,null,$(j.value,i=>(p(),T(s,{key:i.value,label:i.label,value:i.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):x("",!0),a.value.sub_rule[0].trigger==="设备状态触发"?(p(),T(d,{key:2,label:t(e)("device.deviceStatus"),prop:"sub_rule[0].option.status"},{default:n(()=>[o(h,{style:{width:"100%"},modelValue:a.value.sub_rule[0].option.status,"onUpdate:modelValue":l[16]||(l[16]=i=>a.value.sub_rule[0].option.status=i),placeholder:t(e)("common.inputText"),filterable:"",clearable:""},{default:n(()=>[o(s,{label:t(e)("device.online"),value:"online"},null,8,["label"]),o(s,{label:t(e)("device.offline"),value:"offline"},null,8,["label"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):x("",!0),o(E,{"content-position":"left"},{default:n(()=>[f(b(t(e)("device.otherConfigurations")),1)]),_:1}),o(d,{label:t(e)("device.silenceTime")},{default:n(()=>[o(oe,null,{default:n(()=>[f(b(t(e)("device.silenceTimeDesc")),1)]),_:1}),o(h,{modelValue:a.value.silence_time,"onUpdate:modelValue":l[17]||(l[17]=i=>a.value.silence_time=i)},{default:n(()=>[o(s,{label:t(e)("device.none"),value:"无"},null,8,["label"]),o(s,{label:"5"+t(e)("device.minute"),value:"5分钟"},null,8,["label"]),o(s,{label:"10"+t(e)("device.minute"),value:"10分钟"},null,8,["label"]),o(s,{label:"15"+t(e)("device.minute"),value:"15分钟"},null,8,["label"]),o(s,{label:"30"+t(e)("device.minute"),value:"30分钟"},null,8,["label"]),o(s,{label:"1"+t(e)("device.hour"),value:"1小时"},null,8,["label"]),o(s,{label:"3"+t(e)("device.hour"),value:"3小时"},null,8,["label"]),o(s,{label:"6"+t(e)("device.hour"),value:"6小时"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),o(d,{label:t(e)("device.notificationMethod")},{default:n(()=>[o(oe,null,{default:n(()=>[f(b(t(e)("device.notificationMethodDesc")),1)]),_:1}),o(Te,{modelValue:g.value,"onUpdate:modelValue":l[18]||(l[18]=i=>g.value=i)},{default:n(()=>[o(N,{label:t(e)("router.alarmCenter"),value:"告警中心",disabled:"",checked:!0},null,8,["label"]),o(N,{label:t(e)("device.wecomRobot"),value:t(e)("device.wecomRobot")},null,8,["label","value"]),o(N,{label:t(e)("device.dingtalkRobot"),value:t(e)("device.dingtalkRobot")},null,8,["label","value"]),o(N,{label:t(e)("device.feishuRobot"),value:t(e)("device.feishuRobot")},null,8,["label","value"]),o(N,{label:t(e)("device.apiInterface"),value:t(e)("device.apiInterface")},null,8,["label","value"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),g.value.includes(t(e)("device.wecomRobot"))?(p(),R(V,{key:3},[o(E,{"content-position":"left"},{default:n(()=>[f(b(t(e)("device.wecomRobotConfig")),1)]),_:1}),o(d,{label:t(e)("device.notificationAddress"),prop:"notify[0].option.webhook"},{default:n(()=>[o(u,{modelValue:v(0,t(e)("device.wecomRobot")).option.webhook,"onUpdate:modelValue":l[19]||(l[19]=i=>v(0,t(e)("device.wecomRobot")).option.webhook=i),placeholder:t(e)("device.inputWecomRobotWebhook")},{prepend:n(()=>l[33]||(l[33]=[f("webhook")])),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(d,{label:t(e)("device.effectiveTime"),prop:"notify[0].time"},{default:n(()=>[w("div",Xe,[o(H,{modelValue:v(0,t(e)("device.wecomRobot")).start_effect_time,"onUpdate:modelValue":l[20]||(l[20]=i=>v(0,t(e)("device.wecomRobot")).start_effect_time=i),placeholder:t(e)("device.startTime"),format:"HH:mm:ss","value-format":"HH:mm:ss"},null,8,["modelValue","placeholder"]),w("span",Ze,b(t(e)("device.to")),1),o(H,{modelValue:v(0,t(e)("device.wecomRobot")).end_effect_time,"onUpdate:modelValue":l[21]||(l[21]=i=>v(0,t(e)("device.wecomRobot")).end_effect_time=i),placeholder:t(e)("device.endTime"),format:"HH:mm:ss","value-format":"HH:mm:ss"},null,8,["modelValue","placeholder"])])]),_:1},8,["label"])],64)):x("",!0),g.value.includes(t(e)("device.dingtalkRobot"))?(p(),R(V,{key:4},[o(E,{"content-position":"left"},{default:n(()=>[f(b(t(e)("device.dingtalkRobotConfig")),1)]),_:1}),o(d,{label:t(e)("device.notificationAddress"),prop:"notify[1].option.webhook"},{default:n(()=>[o(u,{modelValue:v(1,t(e)("device.dingtalkRobot")).option.webhook,"onUpdate:modelValue":l[22]||(l[22]=i=>v(1,t(e)("device.dingtalkRobot")).option.webhook=i),placeholder:t(e)("device.inputDingtalkRobotWebhook")},{prepend:n(()=>l[34]||(l[34]=[f("webhook")])),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(d,{label:t(e)("device.effectiveTime"),prop:"notify[1].time"},{default:n(()=>[w("div",Qe,[o(H,{modelValue:v(1,t(e)("device.dingtalkRobot")).start_effect_time,"onUpdate:modelValue":l[23]||(l[23]=i=>v(1,t(e)("device.dingtalkRobot")).start_effect_time=i),placeholder:t(e)("device.startTime"),format:"HH:mm:ss","value-format":"HH:mm:ss"},null,8,["modelValue","placeholder"]),w("span",Ye,b(t(e)("device.to")),1),o(H,{modelValue:v(1,t(e)("device.dingtalkRobot")).end_effect_time,"onUpdate:modelValue":l[24]||(l[24]=i=>v(1,t(e)("device.dingtalkRobot")).end_effect_time=i),placeholder:t(e)("device.endTime"),format:"HH:mm:ss","value-format":"HH:mm:ss"},null,8,["modelValue","placeholder"])])]),_:1},8,["label"])],64)):x("",!0),g.value.includes(t(e)("device.feishuRobot"))?(p(),R(V,{key:5},[o(E,{"content-position":"left"},{default:n(()=>[f(b(t(e)("device.feishuRobotConfig")),1)]),_:1}),o(d,{label:t(e)("device.notificationAddress"),prop:"notify[2].option.webhook"},{default:n(()=>[o(u,{modelValue:v(2,t(e)("device.feishuRobot")).option.webhook,"onUpdate:modelValue":l[25]||(l[25]=i=>v(2,t(e)("device.feishuRobot")).option.webhook=i),placeholder:t(e)("device.inputFeishuRobotWebhook")},{prepend:n(()=>l[35]||(l[35]=[f("webhook")])),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(d,{label:t(e)("device.effectiveTime"),prop:"notify[2].time"},{default:n(()=>[w("div",el,[o(H,{modelValue:v(2,t(e)("device.feishuRobot")).start_effect_time,"onUpdate:modelValue":l[26]||(l[26]=i=>v(2,t(e)("device.feishuRobot")).start_effect_time=i),placeholder:t(e)("device.startTime"),format:"HH:mm:ss","value-format":"HH:mm:ss"},null,8,["modelValue","placeholder"]),w("span",ll,b(t(e)("device.to")),1),o(H,{modelValue:v(2,t(e)("device.feishuRobot")).end_effect_time,"onUpdate:modelValue":l[27]||(l[27]=i=>v(2,t(e)("device.feishuRobot")).end_effect_time=i),placeholder:t(e)("device.endTime"),format:"HH:mm:ss","value-format":"HH:mm:ss"},null,8,["modelValue","placeholder"])])]),_:1},8,["label"])],64)):x("",!0),g.value.includes(t(e)("device.apiInterface"))?(p(),R(V,{key:6},[o(E,{"content-position":"left"},{default:n(()=>[f(b(t(e)("device.apiInterfaceConfig")),1)]),_:1}),o(d,{label:t(e)("device.interfaceAddress"),prop:"notify[3].option.webhook"},{default:n(()=>[o(u,{modelValue:v(3,t(e)("device.apiInterface")).option.webhook,"onUpdate:modelValue":l[28]||(l[28]=i=>v(3,t(e)("device.apiInterface")).option.webhook=i),placeholder:t(e)("common.inputText")},{prepend:n(()=>l[36]||(l[36]=[f("post")])),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(d,{label:t(e)("device.effectiveTime"),prop:"notify[3].time"},{default:n(()=>[w("div",tl,[o(H,{modelValue:v(3,t(e)("device.apiInterface")).start_effect_time,"onUpdate:modelValue":l[29]||(l[29]=i=>v(3,t(e)("device.apiInterface")).start_effect_time=i),placeholder:t(e)("device.startTime"),format:"HH:mm:ss","value-format":"HH:mm:ss"},null,8,["modelValue","placeholder"]),w("span",ol,b(t(e)("device.to")),1),o(H,{modelValue:v(3,t(e)("device.apiInterface")).end_effect_time,"onUpdate:modelValue":l[30]||(l[30]=i=>v(3,t(e)("device.apiInterface")).end_effect_time=i),placeholder:t(e)("device.endTime"),format:"HH:mm:ss","value-format":"HH:mm:ss"},null,8,["modelValue","placeholder"])])]),_:1},8,["label"])],64)):x("",!0)]),_:1},8,["model","rules"])):x("",!0)]),_:1},8,["modelValue","title"])],64)}}}),Tl=Pe(il,[["__scopeId","data-v-a7dadddd"]]);export{Tl as default};
