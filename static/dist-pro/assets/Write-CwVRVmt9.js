import{F as R}from"./Form-CzZbC4Aj.js";import{u as S}from"./useForm-CD85wrwf.js";import{u as _}from"./useValidator-Barz9SCp.js";import{c as k}from"./index-CAdyeJt3.js";import{g as x,b as C}from"./index-5XhoBoFQ.js";import{_ as V}from"./AddButtonPermission.vue_vue_type_script_setup_true_lang-ClaqqdUG.js";import{c as N}from"./element-plus--V1NSjC4.js";import{x as O,r as m,X as f,u as s,w as A,y as B,z as E,P as h,O as M}from"./vue-chunks-C1K3ngR7.js";/* empty css               *//* empty css                  *//* empty css               *//* empty css                */import"./el-checkbox-group-Cm0j4lwI.js";/* empty css                       *//* empty css                  */import"./Highlight.vue_vue_type_script_lang-BYSr0XZy.js";/* empty css                */import"./wang-editor-Bckixh16.js";import"./index-DfycOL0q.js";/* empty css                  */const ne=O({__name:"Write",props:{currentRow:{type:Object,default:()=>null}},setup(v,{expose:g}){const{t:c}=k(),{required:r}=_(),u=v;u.currentRow;const d=m(!1);m(null);const y=f([{field:"type",label:"菜单类型",component:"RadioButton",value:0,colProps:{span:24},componentProps:{options:[{label:"目录",value:0},{label:"菜单",value:1}],on:{change:async t=>{const e=await l();t===1?(o([{field:"page",path:"remove",value:!1}]),o([{field:"parentId",path:"remove",value:!1}]),n({component:s(i)})):(o([{field:"page",path:"remove",value:!0}]),o([{field:"parentId",path:"remove",value:!0}]),e.parentId===void 0?n({component:"#"}):n({component:"##"}))}}}},{field:"meta.title",label:c("menu.menuName"),component:"Input"},{field:"parentId",label:"父级菜单",remove:!0,component:"TreeSelect",componentProps:{nodeKey:"id",props:{label:"title",value:"id",children:"children"},highlightCurrent:!0,expandOnClickNode:!1,checkStrictly:!0,checkOnClickNode:!0,clearable:!0,on:{change:async t=>{const e=await l();t&&e.type===0?n({component:"##"}):!t&&e.type===0?n({component:"#"}):e.type===1&&n({component:s(i)??""})}}},optionApi:async()=>{const t=await x(),e=a=>a.map(p=>({...p,title:p.meta.title,children:p.children?e(p.children):[]}));return e(t.data||[])}},{field:"page",label:"图纸",remove:!0,component:"Select",value:"",componentProps:{options:[],on:{change:t=>{}}},optionApi:async()=>{const t=await C();return t.data.data,t.data?.data?.pagesName?.map(e=>({label:e.name,value:e.id}))}},{field:"meta.hidden",label:c("menu.hidden"),component:"Switch"}]),b=f({component:[r()],"meta.title":[r()],status:[r()],name:[r()],page:[r()],parentId:[r()]}),{formRegister:w,formMethods:I}=S(),{setValues:n,getFormData:l,getElFormExpose:P,setSchema:o}=I,D=async()=>{if(await(await P())?.validate().catch(a=>{}))return await l()},i=m("");A(()=>u.currentRow,t=>{if(!t)return;const e=N(t);if(i.value=e.type===1?e.component:"",e.type===1){let a=e.path.split("/")[2]-0;e.page=a}e.type===0?(o([{field:"page",path:"remove",value:!0}]),o([{field:"parentId",path:"remove",value:!0}])):(o([{field:"page",path:"remove",value:!1}]),o([{field:"parentId",path:"remove",value:!1}])),e.parentId===0?o([{field:"component",path:"componentProps.disabled",value:!0}]):o([{field:"component",path:"componentProps.disabled",value:!1}]),e.type===1?o([{field:"component",path:"componentProps.disabled",value:!1}]):o([{field:"component",path:"componentProps.disabled",value:!0}]),n(e)},{deep:!0,immediate:!0}),g({submit:D});const F=async t=>{await l()};return(t,e)=>(B(),E(M,null,[h(s(R),{rules:b,onRegister:s(w),schema:y},null,8,["rules","onRegister","schema"]),h(V,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=a=>d.value=a),onConfirm:F},null,8,["modelValue"])],64))}});export{ne as default};
