import{_ as L}from"./Table.vue_vue_type_script_lang-D3v-kC-o.js";import{_ as j}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CrtdylkU.js";import{u as A}from"./useTable-Cg8mTZpf.js";import{B as O,h as U,C as W}from"./index-BTXJkdku.js";import{F as q}from"./Form-CzZbC4Aj.js";import{_ as G}from"./ResizeDialog.vue_vue_type_script_setup_true_lang-BMzjBTUt.js";import{u as J}from"./useValidator-Barz9SCp.js";import{u as K}from"./useForm-CD85wrwf.js";import{c as Q,e as T,_ as X}from"./index-CAdyeJt3.js";import{d as g,i as Y,b as S}from"./element-plus--V1NSjC4.js";import{x as Z,r as f,c as x,P as s,O as B,ag as ee,y as te,z as ae,H as r,u as o,L as v,M as _,l as C,aa as oe}from"./vue-chunks-C1K3ngR7.js";/* empty css                        *//* empty css                *//* empty css                  *//* empty css               */import"./el-checkbox-group-Cm0j4lwI.js";/* empty css                *//* empty css                         *//* empty css                  *//* empty css                       */import"./index-DfycOL0q.js";/* empty css               *//* empty css                  */import"./Highlight.vue_vue_type_script_lang-BYSr0XZy.js";/* empty css                */import"./wang-editor-Bckixh16.js";import"./Dialog.vue_vue_type_style_index_0_lang-aEWcq84Q.js";/* empty css                  */function V(c){return typeof c=="function"||Object.prototype.toString.call(c)==="[object Object]"&&!oe(c)}const ie=Z({__name:"TagManage",setup(c){const{t:a}=Q(),l=f(!1),m=f("add"),z=x(()=>window.innerHeight-205),{formRegister:E,formMethods:d}=K(),{required:k}=J(),w=f([{field:"name",label:a("device.tagName")},{field:"description",label:a("device.tagDescription")},{field:"action",label:a("device.operation"),formatter:t=>{let e,i;return s(B,null,[s(T,{permission:"Edit"},{default:()=>[s(g,{text:!0,type:"success",onClick:()=>h(t,"edit")},V(e=a("device.edit"))?e:{default:()=>[e]})]}),s(T,{permission:"Delete"},{default:()=>[s(g,{text:!0,type:"danger",onClick:()=>h(t,"delete")},V(i=a("device.delete"))?i:{default:()=>[i]})]})])}}]),F=x(()=>[{field:"name",label:a("device.tagName"),component:"Input",formItemProps:{rules:[k()]}},{field:"description",label:a("device.tagDescription"),component:"Input"}]),{tableRegister:M,tableState:b,tableMethods:R}=A({fetchDataApi:async()=>{const{currentPage:t,pageSize:e}=b,i=await U({page:o(t),size:o(e)});return{list:i.data.list,total:i.data.totalRow}}}),{loading:D,dataList:P,total:$,currentPage:p,pageSize:u}=b,{getList:y}=R,N=()=>{m.value="add",d.setValues({}),l.value=!0},I=async()=>{try{const{getFormData:t,getElFormExpose:e}=d,i=await t();(await e())?.validate(async H=>{H&&(await W(i)).code===200&&(S.success(a("device.operationSuccess")),y())})}catch(t){}finally{l.value=!1}},h=(t,e)=>{e==="edit"?(m.value="edit",l.value=!0,d.setValues({id:t.id,name:t.name,description:t.description})):e==="delete"&&Y.confirm(a("common.delMessage"),a("common.delWarning"),{confirmButtonText:a("device.delete"),cancelButtonText:a("common.cancel"),type:"warning"}).then(async()=>{(await O({id:t.id})).code===200&&(S.success(a("device.operationSuccess")),y())})};return(t,e)=>{const i=ee("BaseButton");return te(),ae(B,null,[s(o(j),null,{default:r(()=>[s(o(g),{type:"primary",class:"mb-2",onClick:N},{default:r(()=>[v("+ "+_(o(a)("device.addTag")),1)]),_:1}),s(o(L),{border:!1,pageSize:o(u),"onUpdate:pageSize":e[0]||(e[0]=n=>C(u)?u.value=n:null),size:"small",currentPage:o(p),"onUpdate:currentPage":e[1]||(e[1]=n=>C(p)?p.value=n:null),columns:w.value,data:o(P),loading:o(D),height:z.value,pagination:{total:o($),pageSizes:[20,40,50,100,1e3]},onRegister:o(M),showAction:""},null,8,["pageSize","currentPage","columns","data","loading","height","pagination","onRegister"])]),_:1}),s(G,{modelValue:l.value,"onUpdate:modelValue":e[3]||(e[3]=n=>l.value=n),title:m.value==="add"?o(a)("device.createNewTag"):o(a)("device.editTag"),initHeight:120,initWidth:500,fullscreen:!1},{footer:r(()=>[s(i,{onClick:e[2]||(e[2]=n=>l.value=!1)},{default:r(()=>[v(_(t.$t("dialogDemo.close")),1)]),_:1}),s(i,{type:"primary",onClick:I},{default:r(()=>[v(_(t.$t("common.ok")),1)]),_:1})]),default:r(()=>[s(o(q),{schema:F.value,onRegister:o(E),isCol:!1},null,8,["schema","onRegister"])]),_:1},8,["modelValue","title"])],64)}}}),De=X(ie,[["__scopeId","data-v-92c7bec1"]]);export{De as default};
