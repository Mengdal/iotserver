import{i as $,F as Q}from"./Form-CzZbC4Aj.js";import{I as U,p as o,c as X,j as A,x as Y,y as Z}from"./index-CAdyeJt3.js";import{u as ee}from"./useForm-CD85wrwf.js";import{af as oe,x as T,ag as te,y as u,z as R,G as g,H as w,L as h,M as b,u as a,K as x,O as W,r as v,c as F,P as y,w as ae,j as se,D as ne}from"./vue-chunks-C1K3ngR7.js";import{F as le,G as ie,M as re,am as ce,c as de,J as ue}from"./element-plus--V1NSjC4.js";const pe=s=>oe(U,s),_=T({__name:"ActionButton",props:{showSearch:o.bool.def(!0),showReset:o.bool.def(!0),showExport:o.bool.def(!1),showExpand:o.bool.def(!1),showSupplement:o.bool.def(!1),visible:o.bool.def(!0),searchLoading:o.bool.def(!1),resetLoading:o.bool.def(!1),exportLoading:o.bool.def(!1),supplementLoading:o.bool.def(!1)},emits:["supplementData","search","reset","expand","exportData"],setup(s,{emit:S}){const p=S,{t:r}=X(),c=()=>{p("search")},m=()=>{p("reset")},f=()=>{p("expand")},L=()=>{p("exportData")},k=()=>{p("supplementData")};return(C,E)=>{const d=te("BaseButton");return u(),R(W,null,[s.showSearch?(u(),g(d,{key:0,type:"primary",loading:s.searchLoading,icon:a(le),onClick:c},{default:w(()=>[h(b(a(r)("common.query")),1)]),_:1},8,["loading","icon"])):x("",!0),s.showReset?(u(),g(d,{key:1,loading:s.resetLoading,plain:"",icon:a(ie),onClick:m},{default:w(()=>[h(b(a(r)("common.reset")),1)]),_:1},8,["loading","icon"])):x("",!0),s.showExport?(u(),g(d,{key:2,loading:s.exportLoading,plain:"",icon:a(re),onClick:L},{default:w(()=>[h(b(a(r)("device.Export")),1)]),_:1},8,["loading","icon"])):x("",!0),s.showSupplement?(u(),g(d,{key:3,loading:s.supplementLoading,plain:"",icon:a(ce),onClick:k},{default:w(()=>[h(b(a(r)("device.Supplement")),1)]),_:1},8,["loading","icon"])):x("",!0),s.showExpand?(u(),g(d,{key:4,icon:a(pe)({icon:s.visible?"vi-ep:arrow-up":"vi-ep:arrow-down"}),text:"",onClick:f},{default:w(()=>[h(b(a(r)(s.visible?"common.shrink":"common.expand")),1)]),_:1},8,["icon"])):x("",!0)],64)}}}),Ee=T({__name:"Search",props:{schema:{type:Array,default:()=>[]},isCol:o.bool.def(!1),labelWidth:o.oneOfType([String,Number]).def("auto"),layout:o.string.validate(s=>["inline","bottom"].includes(s)).def("inline"),buttonPosition:o.string.validate(s=>["left","center","right"].includes(s)).def("center"),showSearch:o.bool.def(!0),showReset:o.bool.def(!0),showExport:o.bool.def(!1),showSupplement:o.bool.def(!1),showExpand:o.bool.def(!1),expandField:o.string.def(""),inline:o.bool.def(!0),removeNoValueItem:o.bool.def(!0),model:{type:Object,default:()=>({})},searchLoading:o.bool.def(!1),resetLoading:o.bool.def(!1),exportLoading:o.bool.def(!1),supplementLoading:o.bool.def(!1)},emits:["search","reset","register","validate","exportData","supplementData"],setup(s,{expose:S,emit:p}){const r=s,c=p,m=v(!0),f=v(r.model),L=F(()=>{const e=a(i);let t=de(e.schema);if(e.showExpand&&e.expandField&&!a(m)){const n=A(t,l=>l.field===e.expandField);t.map((l,K)=>(K>=n?l.hidden=!0:l.hidden=!1,l))}return e.layout==="inline"&&(t=t.concat([{field:"action",formItemProps:{labelWidth:"0px",slots:{default:()=>y("div",null,[y(_,{showSearch:e.showSearch,showReset:e.showReset,showExpand:e.showExpand,showExport:e.showExport,showSupplement:e.showSupplement,searchLoading:e.searchLoading,resetLoading:e.resetLoading,exportLoading:e.exportLoading,supplementLoading:e.supplementLoading,visible:m.value,onExpand:M,onReset:B,onSearch:O,onExportData:I,onSupplementData:P},null)]),label:()=>y("span",null,[h("Â ")])}}}])),t}),{formRegister:k,formMethods:C}=ee(),{getElFormExpose:E,getFormData:d,getFormExpose:q}=C,z=v({}),D=v({}),i=F(()=>{const e={...r};return Object.assign(e,a(D)),e}),G=(e={})=>{D.value=Object.assign(a(D),e),z.value=e},V=v([]);ae(()=>a(L),async(e=[])=>{f.value=$(e,a(f)),V.value=e},{immediate:!0,deep:!0});const j=async()=>{const e=await d();return a(i).removeNoValueItem?Object.keys(e).reduce((t,n)=>{const l=e[n];return Y(l)||(Z(l)?Object.keys(l).length>0&&(t[n]=l):t[n]=l),t},{}):e},O=async()=>{await(await E())?.validate(async t=>{if(t){const n=await j();c("search",n)}})},B=async()=>{(await E())?.resetFields();const t=await j();c("reset",t)},I=async()=>{c("exportData")},P=()=>{c("supplementData")},H=F(()=>({textAlign:a(i).buttonPosition})),M=async()=>{m.value=!a(m)},N={getElFormExpose:E,setProps:G,setSchema:e=>{const{schema:t}=a(i);for(const n of t)for(const l of e)n.field===l.field&&ue(n,l.path,l.value)},setValues:async(e={})=>{f.value=Object.assign(r.model,a(f),e),(await q())?.setValues(e)},delSchema:e=>{const{schema:t}=a(i),n=A(t,l=>l.field===e);n>-1&&t.splice(n,1)},addSchema:(e,t)=>{const{schema:n}=a(i);if(t!==void 0){n.splice(t,0,e);return}n.push(e)},getFormData:d};se(()=>{c("register",N)}),S(N);const J=(e,t,n)=>{c("validate",e,t,n)};return(e,t)=>(u(),R(W,null,[y(a(Q),{model:f.value,"is-custom":!1,"label-width":i.value.labelWidth,"hide-required-asterisk":"",inline:i.value.inline,"is-col":i.value.isCol,schema:V.value,onRegister:a(k),onValidate:J},null,8,["model","label-width","inline","is-col","schema","onRegister"]),s.layout==="bottom"?(u(),R("div",{key:0,style:ne(H.value)},[y(_,{"show-reset":i.value.showReset,"show-search":i.value.showSearch,"show-expand":i.value.showExpand,"show-export":i.value.showExport,"search-loading":i.value.searchLoading,"export-loading":i.value.exportLoading,"reset-loading":i.value.resetLoading,visible:m.value,onExpand:M,onReset:B,onSearch:O,onExportData:I,onSupplementData:P},null,8,["show-reset","show-search","show-expand","show-export","search-loading","export-loading","reset-loading","visible"])],4)):x("",!0)],64))}});export{Ee as _};
