import{d as ut,r as J,O as _t,b_ as Es,ay as ft,b$ as Fr,c0 as Wr,c1 as $r,c2 as jr,c3 as Yr,aJ as $e,a0 as je,aK as Ye,c4 as Bi,I as qr,g as zr,S as Vr,B as Tt,b as Ee,an as Ne,at as Ot,o as Mt,al as Gt,f as de,h as Se,i as Fe,l as F,w as z,p as le,t as se,n as O,k as ce,j as Ae,bQ as di,_ as At,u as Ni,W as ui,X as ks,aD as vt,aF as Jt,V as Ds,aA as Ms,c5 as Hi,ax as Xt,c6 as _i,bO as Kr,ak as Ui,a2 as As,aI as It,c7 as Gr,D as qe,aN as xs,af as Rs,aC as Ls,au as Fi,bH as Jr,aG as Xr,F as Ts,a9 as Os,aH as Qr,c8 as Zr,am as Is}from"./index-35337fd3.js";import{A as en}from"./energy-f0146bb7.js";import{i as Qt}from"./icon-ebc544b2.js";import{N as Wi}from"./RadioButton-47b7c95b.js";import{F as tn}from"./FileSaver.min-6eb19673.js";const sn=Object.assign(Object.assign({},Wr),$r),He=ut({__GRID_ITEM__:!0,name:"FormItemGridItem",alias:["FormItemGi"],props:sn,setup(){const e=J(null);return{formItemInstRef:e,validate:(...t)=>{const{value:c}=e;if(c)return c.validate(...t)},restoreValidation:()=>{const{value:t}=e;t&&t.restoreValidation()}}},render(){return _t(Fr,Es(this.$.vnode.props||{},Yr),{default:()=>{const e=Es(this.$props,jr);return _t(ft,Object.assign({ref:"formItemInstRef"},e),this.$slots)}})}}),rn=e=>$e("/edge-mgmt/gateway/list",e,Ye.FORM_URLENCODED,je.baseUrl),nn=e=>$e("/edge-mgmt/gateway/create",e,Ye.FORM_URLENCODED,je.baseUrl),on=e=>$e("/edge-mgmt/gateway/delete",e,Ye.FORM_URLENCODED,je.baseUrl),an=e=>$e("/edge-mgmt/gateway/import",e,Ye.FORM_URLENCODED,je.baseUrl),ln=e=>$e("/edge-mgmt/gateway/export",e,Ye.FORM_DATA,je.baseUrl),$i=e=>$e("/edge-mgmt/gateway/detail",e,Ye.FORM_URLENCODED,je.baseUrl),cn=e=>$e("/edge-mgmt/gateway/pub",e,Ye.FORM_URLENCODED,je.baseUrl),Ps=e=>$e("/edge-mgmt/gateway/restart",e,Ye.FORM_URLENCODED,je.baseUrl),hn=e=>$e("/edge-mgmt/ota/",e,Ye.FORM_URLENCODED,je.baseUrl),dn=e=>$e("/edge-mgmt/ota/upgrade",e,Ye.FORM_URLENCODED,je.baseUrl),fi=e=>$e("/go-http/complexCommand/createCommand",e,Ye.FORM_URLENCODED,je.baseUrl),un=e=>$e("/go-http/complexCommand/createCommand",e,Ye.FORM_URLENCODED,je.baseUrl),_n=e=>$e("/go-http/left/tree",e,Ye.FORM_URLENCODED,je.baseUrl),gt=e=>$e("/edge-mgmt/mqttws/mqtt",e,Ye.FORM_URLENCODED,je.baseUrl),ji=e=>$e("/edge-mgmt/mqttws/ws",e,Ye.FORM_URLENCODED,je.baseUrl),fn=e=>$e("/edge-mgmt/ota/versionHistory",e,Ye.FORM_URLENCODED,je.baseUrl),vn=e=>$e("/edge-mgmt/ota/upgradeHistory",e,Ye.FORM_URLENCODED,je.baseUrl),gn=e=>$e("/edge-mgmt/gateway/writeLog",e,Ye.FORM_URLENCODED,je.baseUrl);var Bs={exports:{}};(function(e,t){(function(c,f){e.exports=f()})(Bi,function(){var c=function(f){var E="@VERSION@-@BUILDLEVEL@",R=f.localStorage||function(){var d={};return{setItem:function(g,x){d[g]=x},getItem:function(g){return d[g]},removeItem:function(g){delete d[g]}}}(),L={CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,PUBREC:5,PUBREL:6,PUBCOMP:7,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14},o=function(d,g){for(var x in d)if(d.hasOwnProperty(x))if(g.hasOwnProperty(x)){if(typeof d[x]!==g[x])throw new Error(a(h.INVALID_TYPE,[typeof d[x],x]))}else{var B="Unknown property, "+x+". Valid properties are:";for(var W in g)g.hasOwnProperty(W)&&(B=B+" "+W);throw new Error(B)}},l=function(d,g){return function(){return d.apply(g,arguments)}},h={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."},BUFFER_FULL:{code:18,text:"AMQJS0018E Message buffer is full, maximum buffer size: {0}."}},S={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},a=function(d,g){var x=d.text;if(g){for(var B,W,H=0;H<g.length;H++)if(B="{"+H+"}",W=x.indexOf(B),W>0){var k=x.substring(0,W),T=x.substring(W+B.length);x=k+g[H]+T}}return x},p=[0,6,77,81,73,115,100,112,3],w=[0,4,77,81,84,84,4],b=function(d,g){this.type=d;for(var x in g)g.hasOwnProperty(x)&&(this[x]=g[x])};b.prototype.encode=function(){var d=(this.type&15)<<4,g=0,x=[],B=0,W;switch(this.messageIdentifier!==void 0&&(g+=2),this.type){case L.CONNECT:switch(this.mqttVersion){case 3:g+=p.length+3;break;case 4:g+=w.length+3;break}g+=u(this.clientId)+2,this.willMessage!==void 0&&(g+=u(this.willMessage.destinationName)+2,W=this.willMessage.payloadBytes,W instanceof Uint8Array||(W=new Uint8Array(k)),g+=W.byteLength+2),this.userName!==void 0&&(g+=u(this.userName)+2),this.password!==void 0&&(g+=u(this.password)+2);break;case L.SUBSCRIBE:d|=2;for(var H=0;H<this.topics.length;H++)x[H]=u(this.topics[H]),g+=x[H]+2;g+=this.requestedQos.length;break;case L.UNSUBSCRIBE:d|=2;for(var H=0;H<this.topics.length;H++)x[H]=u(this.topics[H]),g+=x[H]+2;break;case L.PUBREL:d|=2;break;case L.PUBLISH:this.payloadMessage.duplicate&&(d|=8),d=d|=this.payloadMessage.qos<<1,this.payloadMessage.retained&&(d|=1),B=u(this.payloadMessage.destinationName),g+=B+2;var k=this.payloadMessage.payloadBytes;g+=k.byteLength,k instanceof ArrayBuffer?k=new Uint8Array(k):k instanceof Uint8Array||(k=new Uint8Array(k.buffer));break}var T=n(g),A=T.length+1,P=new ArrayBuffer(g+A),q=new Uint8Array(P);if(q[0]=d,q.set(T,1),this.type==L.PUBLISH)A=s(this.payloadMessage.destinationName,B,q,A);else if(this.type==L.CONNECT){switch(this.mqttVersion){case 3:q.set(p,A),A+=p.length;break;case 4:q.set(w,A),A+=w.length;break}var U=0;this.cleanSession&&(U=2),this.willMessage!==void 0&&(U|=4,U|=this.willMessage.qos<<3,this.willMessage.retained&&(U|=32)),this.userName!==void 0&&(U|=128),this.password!==void 0&&(U|=64),q[A++]=U,A=i(this.keepAliveInterval,q,A)}switch(this.messageIdentifier!==void 0&&(A=i(this.messageIdentifier,q,A)),this.type){case L.CONNECT:A=s(this.clientId,u(this.clientId),q,A),this.willMessage!==void 0&&(A=s(this.willMessage.destinationName,u(this.willMessage.destinationName),q,A),A=i(W.byteLength,q,A),q.set(W,A),A+=W.byteLength),this.userName!==void 0&&(A=s(this.userName,u(this.userName),q,A)),this.password!==void 0&&(A=s(this.password,u(this.password),q,A));break;case L.PUBLISH:q.set(k,A);break;case L.SUBSCRIBE:for(var H=0;H<this.topics.length;H++)A=s(this.topics[H],x[H],q,A),q[A++]=this.requestedQos[H];break;case L.UNSUBSCRIBE:for(var H=0;H<this.topics.length;H++)A=s(this.topics[H],x[H],q,A);break}return P};function m(d,g){var x=g,B=d[g],W=B>>4,H=B&=15;g+=1;var k,T=0,A=1;do{if(g==d.length)return[null,x];k=d[g++],T+=(k&127)*A,A*=128}while(k&128);var P=g+T;if(P>d.length)return[null,x];var q=new b(W);switch(W){case L.CONNACK:var U=d[g++];U&1&&(q.sessionPresent=!0),q.returnCode=d[g++];break;case L.PUBLISH:var j=H>>1&3,G=r(d,g);g+=2;var Q=C(d,g,G);g+=G,j>0&&(q.messageIdentifier=r(d,g),g+=2);var D=new N(d.subarray(g,P));(H&1)==1&&(D.retained=!0),(H&8)==8&&(D.duplicate=!0),D.qos=j,D.destinationName=Q,q.payloadMessage=D;break;case L.PUBACK:case L.PUBREC:case L.PUBREL:case L.PUBCOMP:case L.UNSUBACK:q.messageIdentifier=r(d,g);break;case L.SUBACK:q.messageIdentifier=r(d,g),g+=2,q.returnCode=d.subarray(g,P);break}return[q,P]}function i(d,g,x){return g[x++]=d>>8,g[x++]=d%256,x}function s(d,g,x,B){return B=i(g,x,B),v(d,x,B),B+g}function r(d,g){return 256*d[g]+d[g+1]}function n(d){var g=new Array(1),x=0;do{var B=d%128;d=d>>7,d>0&&(B|=128),g[x++]=B}while(d>0&&x<4);return g}function u(d){for(var g=0,x=0;x<d.length;x++){var B=d.charCodeAt(x);B>2047?(55296<=B&&B<=56319&&(x++,g++),g+=3):B>127?g+=2:g++}return g}function v(d,g,x){for(var B=x,W=0;W<d.length;W++){var H=d.charCodeAt(W);if(55296<=H&&H<=56319){var k=d.charCodeAt(++W);if(isNaN(k))throw new Error(a(h.MALFORMED_UNICODE,[H,k]));H=(H-55296<<10)+(k-56320)+65536}H<=127?g[B++]=H:H<=2047?(g[B++]=H>>6&31|192,g[B++]=H&63|128):H<=65535?(g[B++]=H>>12&15|224,g[B++]=H>>6&63|128,g[B++]=H&63|128):(g[B++]=H>>18&7|240,g[B++]=H>>12&63|128,g[B++]=H>>6&63|128,g[B++]=H&63|128)}return g}function C(d,g,x){for(var B="",W,H=g;H<g+x;){var k=d[H++];if(k<128)W=k;else{var T=d[H++]-128;if(T<0)throw new Error(a(h.MALFORMED_UTF,[k.toString(16),T.toString(16),""]));if(k<224)W=64*(k-192)+T;else{var A=d[H++]-128;if(A<0)throw new Error(a(h.MALFORMED_UTF,[k.toString(16),T.toString(16),A.toString(16)]));if(k<240)W=4096*(k-224)+64*T+A;else{var P=d[H++]-128;if(P<0)throw new Error(a(h.MALFORMED_UTF,[k.toString(16),T.toString(16),A.toString(16),P.toString(16)]));if(k<248)W=262144*(k-240)+4096*T+64*A+P;else throw new Error(a(h.MALFORMED_UTF,[k.toString(16),T.toString(16),A.toString(16),P.toString(16)]))}}}W>65535&&(W-=65536,B+=String.fromCharCode(55296+(W>>10)),W=56320+(W&1023)),B+=String.fromCharCode(W)}return B}var M=function(d,g){this._client=d,this._keepAliveInterval=g*1e3,this.isReset=!1;var x=new b(L.PINGREQ).encode(),B=function(H){return function(){return W.apply(H)}},W=function(){this.isReset?(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(x),this.timeout=setTimeout(B(this),this._keepAliveInterval)):(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(h.PING_TIMEOUT.code,a(h.PING_TIMEOUT)))};this.reset=function(){this.isReset=!0,clearTimeout(this.timeout),this._keepAliveInterval>0&&(this.timeout=setTimeout(B(this),this._keepAliveInterval))},this.cancel=function(){clearTimeout(this.timeout)}},_=function(d,g,x,B){g||(g=30);var W=function(H,k,T){return function(){return H.apply(k,T)}};this.timeout=setTimeout(W(x,d,B),g*1e3),this.cancel=function(){clearTimeout(this.timeout)}},y=function(d,g,x,B,W){if(!("WebSocket"in f&&f.WebSocket!==null))throw new Error(a(h.UNSUPPORTED,["WebSocket"]));if(!("ArrayBuffer"in f&&f.ArrayBuffer!==null))throw new Error(a(h.UNSUPPORTED,["ArrayBuffer"]));this._trace("Paho.Client",d,g,x,B,W),this.host=g,this.port=x,this.path=B,this.uri=d,this.clientId=W,this._wsuri=null,this._localKey=g+":"+x+(B!="/mqtt"?":"+B:"")+":"+W+":",this._msg_queue=[],this._buffered_msg_queue=[],this._sentMessages={},this._receivedMessages={},this._notify_msg_sent={},this._message_identifier=1,this._sequence=0;for(var H in R)(H.indexOf("Sent:"+this._localKey)===0||H.indexOf("Received:"+this._localKey)===0)&&this.restore(H)};y.prototype.host=null,y.prototype.port=null,y.prototype.path=null,y.prototype.uri=null,y.prototype.clientId=null,y.prototype.socket=null,y.prototype.connected=!1,y.prototype.maxMessageIdentifier=65536,y.prototype.connectOptions=null,y.prototype.hostIndex=null,y.prototype.onConnected=null,y.prototype.onConnectionLost=null,y.prototype.onMessageDelivered=null,y.prototype.onMessageArrived=null,y.prototype.traceFunction=null,y.prototype._msg_queue=null,y.prototype._buffered_msg_queue=null,y.prototype._connectTimeout=null,y.prototype.sendPinger=null,y.prototype.receivePinger=null,y.prototype._reconnectInterval=1,y.prototype._reconnecting=!1,y.prototype._reconnectTimeout=null,y.prototype.disconnectedPublishing=!1,y.prototype.disconnectedBufferSize=5e3,y.prototype.receiveBuffer=null,y.prototype._traceBuffer=null,y.prototype._MAX_TRACE_ENTRIES=100,y.prototype.connect=function(d){var g=this._traceMask(d,"password");if(this._trace("Client.connect",g,this.socket,this.connected),this.connected)throw new Error(a(h.INVALID_STATE,["already connected"]));if(this.socket)throw new Error(a(h.INVALID_STATE,["already connected"]));this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1),this.connectOptions=d,this._reconnectInterval=1,this._reconnecting=!1,d.uris?(this.hostIndex=0,this._doConnect(d.uris[0])):this._doConnect(this.uri)},y.prototype.subscribe=function(d,g){if(this._trace("Client.subscribe",d,g),!this.connected)throw new Error(a(h.INVALID_STATE,["not connected"]));var x=new b(L.SUBSCRIBE);x.topics=d.constructor===Array?d:[d],g.qos===void 0&&(g.qos=0),x.requestedQos=[];for(var B=0;B<x.topics.length;B++)x.requestedQos[B]=g.qos;g.onSuccess&&(x.onSuccess=function(W){g.onSuccess({invocationContext:g.invocationContext,grantedQos:W})}),g.onFailure&&(x.onFailure=function(W){g.onFailure({invocationContext:g.invocationContext,errorCode:W,errorMessage:a(W)})}),g.timeout&&(x.timeOut=new _(this,g.timeout,g.onFailure,[{invocationContext:g.invocationContext,errorCode:h.SUBSCRIBE_TIMEOUT.code,errorMessage:a(h.SUBSCRIBE_TIMEOUT)}])),this._requires_ack(x),this._schedule_message(x)},y.prototype.unsubscribe=function(d,g){if(this._trace("Client.unsubscribe",d,g),!this.connected)throw new Error(a(h.INVALID_STATE,["not connected"]));var x=new b(L.UNSUBSCRIBE);x.topics=d.constructor===Array?d:[d],g.onSuccess&&(x.callback=function(){g.onSuccess({invocationContext:g.invocationContext})}),g.timeout&&(x.timeOut=new _(this,g.timeout,g.onFailure,[{invocationContext:g.invocationContext,errorCode:h.UNSUBSCRIBE_TIMEOUT.code,errorMessage:a(h.UNSUBSCRIBE_TIMEOUT)}])),this._requires_ack(x),this._schedule_message(x)},y.prototype.send=function(d){this._trace("Client.send",d);var g=new b(L.PUBLISH);if(g.payloadMessage=d,this.connected)d.qos>0?this._requires_ack(g):this.onMessageDelivered&&(this._notify_msg_sent[g]=this.onMessageDelivered(g.payloadMessage)),this._schedule_message(g);else if(this._reconnecting&&this.disconnectedPublishing){var x=Object.keys(this._sentMessages).length+this._buffered_msg_queue.length;if(x>this.disconnectedBufferSize)throw new Error(a(h.BUFFER_FULL,[this.disconnectedBufferSize]));d.qos>0?this._requires_ack(g):(g.sequence=++this._sequence,this._buffered_msg_queue.unshift(g))}else throw new Error(a(h.INVALID_STATE,["not connected"]))},y.prototype.disconnect=function(){if(this._trace("Client.disconnect"),this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1),!this.socket)throw new Error(a(h.INVALID_STATE,["not connecting or connected"]));var d=new b(L.DISCONNECT);this._notify_msg_sent[d]=l(this._disconnected,this),this._schedule_message(d)},y.prototype.getTraceLog=function(){if(this._traceBuffer!==null){this._trace("Client.getTraceLog",new Date),this._trace("Client.getTraceLog in flight messages",this._sentMessages.length);for(var d in this._sentMessages)this._trace("_sentMessages ",d,this._sentMessages[d]);for(var d in this._receivedMessages)this._trace("_receivedMessages ",d,this._receivedMessages[d]);return this._traceBuffer}},y.prototype.startTrace=function(){this._traceBuffer===null&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date,E)},y.prototype.stopTrace=function(){delete this._traceBuffer},y.prototype._doConnect=function(d){if(this.connectOptions.useSSL){var g=d.split(":");g[0]="wss",d=g.join(":")}this._wsuri=d,this.connected=!1,this.connectOptions.mqttVersion<4?this.socket=new WebSocket(d,["mqttv3.1"]):this.socket=new WebSocket(d,["mqtt"]),this.socket.binaryType="arraybuffer",this.socket.onopen=l(this._on_socket_open,this),this.socket.onmessage=l(this._on_socket_message,this),this.socket.onerror=l(this._on_socket_error,this),this.socket.onclose=l(this._on_socket_close,this),this.sendPinger=new M(this,this.connectOptions.keepAliveInterval),this.receivePinger=new M(this,this.connectOptions.keepAliveInterval),this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null),this._connectTimeout=new _(this,this.connectOptions.timeout,this._disconnected,[h.CONNECT_TIMEOUT.code,a(h.CONNECT_TIMEOUT)])},y.prototype._schedule_message=function(d){this._msg_queue.unshift(d),this.connected&&this._process_queue()},y.prototype.store=function(d,g){var x={type:g.type,messageIdentifier:g.messageIdentifier,version:1};switch(g.type){case L.PUBLISH:g.pubRecReceived&&(x.pubRecReceived=!0),x.payloadMessage={};for(var B="",W=g.payloadMessage.payloadBytes,H=0;H<W.length;H++)W[H]<=15?B=B+"0"+W[H].toString(16):B=B+W[H].toString(16);x.payloadMessage.payloadHex=B,x.payloadMessage.qos=g.payloadMessage.qos,x.payloadMessage.destinationName=g.payloadMessage.destinationName,g.payloadMessage.duplicate&&(x.payloadMessage.duplicate=!0),g.payloadMessage.retained&&(x.payloadMessage.retained=!0),d.indexOf("Sent:")===0&&(g.sequence===void 0&&(g.sequence=++this._sequence),x.sequence=g.sequence);break;default:throw Error(a(h.INVALID_STORED_DATA,[d+this._localKey+g.messageIdentifier,x]))}R.setItem(d+this._localKey+g.messageIdentifier,JSON.stringify(x))},y.prototype.restore=function(d){var g=R.getItem(d),x=JSON.parse(g),B=new b(x.type,x);switch(x.type){case L.PUBLISH:for(var W=x.payloadMessage.payloadHex,H=new ArrayBuffer(W.length/2),k=new Uint8Array(H),T=0;W.length>=2;){var A=parseInt(W.substring(0,2),16);W=W.substring(2,W.length),k[T++]=A}var P=new N(k);P.qos=x.payloadMessage.qos,P.destinationName=x.payloadMessage.destinationName,x.payloadMessage.duplicate&&(P.duplicate=!0),x.payloadMessage.retained&&(P.retained=!0),B.payloadMessage=P;break;default:throw Error(a(h.INVALID_STORED_DATA,[d,g]))}d.indexOf("Sent:"+this._localKey)===0?(B.payloadMessage.duplicate=!0,this._sentMessages[B.messageIdentifier]=B):d.indexOf("Received:"+this._localKey)===0&&(this._receivedMessages[B.messageIdentifier]=B)},y.prototype._process_queue=function(){for(var d=null;d=this._msg_queue.pop();)this._socket_send(d),this._notify_msg_sent[d]&&(this._notify_msg_sent[d](),delete this._notify_msg_sent[d])},y.prototype._requires_ack=function(d){var g=Object.keys(this._sentMessages).length;if(g>this.maxMessageIdentifier)throw Error("Too many messages:"+g);for(;this._sentMessages[this._message_identifier]!==void 0;)this._message_identifier++;d.messageIdentifier=this._message_identifier,this._sentMessages[d.messageIdentifier]=d,d.type===L.PUBLISH&&this.store("Sent:",d),this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)},y.prototype._on_socket_open=function(){var d=new b(L.CONNECT,this.connectOptions);d.clientId=this.clientId,this._socket_send(d)},y.prototype._on_socket_message=function(d){this._trace("Client._on_socket_message",d.data);for(var g=this._deframeMessages(d.data),x=0;x<g.length;x+=1)this._handleMessage(g[x])},y.prototype._deframeMessages=function(d){var g=new Uint8Array(d),x=[];if(this.receiveBuffer){var B=new Uint8Array(this.receiveBuffer.length+g.length);B.set(this.receiveBuffer),B.set(g,this.receiveBuffer.length),g=B,delete this.receiveBuffer}try{for(var W=0;W<g.length;){var H=m(g,W),k=H[0];if(W=H[1],k!==null)x.push(k);else break}W<g.length&&(this.receiveBuffer=g.subarray(W))}catch(A){var T=A.hasOwnProperty("stack")=="undefined"?A.stack.toString():"No Error Stack Available";this._disconnected(h.INTERNAL_ERROR.code,a(h.INTERNAL_ERROR,[A.message,T]));return}return x},y.prototype._handleMessage=function(d){this._trace("Client._handleMessage",d);try{switch(d.type){case L.CONNACK:if(this._connectTimeout.cancel(),this._reconnectTimeout&&this._reconnectTimeout.cancel(),this.connectOptions.cleanSession){for(var g in this._sentMessages){var U=this._sentMessages[g];R.removeItem("Sent:"+this._localKey+U.messageIdentifier)}this._sentMessages={};for(var g in this._receivedMessages){var P=this._receivedMessages[g];R.removeItem("Received:"+this._localKey+P.messageIdentifier)}this._receivedMessages={}}if(d.returnCode===0)this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length);else{this._disconnected(h.CONNACK_RETURNCODE.code,a(h.CONNACK_RETURNCODE,[d.returnCode,S[d.returnCode]]));break}var x=[];for(var B in this._sentMessages)this._sentMessages.hasOwnProperty(B)&&x.push(this._sentMessages[B]);if(this._buffered_msg_queue.length>0)for(var W=null;W=this._buffered_msg_queue.pop();)x.push(W),this.onMessageDelivered&&(this._notify_msg_sent[W]=this.onMessageDelivered(W.payloadMessage));for(var x=x.sort(function(Q,D){return Q.sequence-D.sequence}),H=0,k=x.length;H<k;H++){var U=x[H];if(U.type==L.PUBLISH&&U.pubRecReceived){var T=new b(L.PUBREL,{messageIdentifier:U.messageIdentifier});this._schedule_message(T)}else this._schedule_message(U)}this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});var A=!1;this._reconnecting&&(A=!0,this._reconnectInterval=1,this._reconnecting=!1),this._connected(A,this._wsuri),this._process_queue();break;case L.PUBLISH:this._receivePublish(d);break;case L.PUBACK:var U=this._sentMessages[d.messageIdentifier];U&&(delete this._sentMessages[d.messageIdentifier],R.removeItem("Sent:"+this._localKey+d.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(U.payloadMessage));break;case L.PUBREC:var U=this._sentMessages[d.messageIdentifier];if(U){U.pubRecReceived=!0;var T=new b(L.PUBREL,{messageIdentifier:d.messageIdentifier});this.store("Sent:",U),this._schedule_message(T)}break;case L.PUBREL:var P=this._receivedMessages[d.messageIdentifier];R.removeItem("Received:"+this._localKey+d.messageIdentifier),P&&(this._receiveMessage(P),delete this._receivedMessages[d.messageIdentifier]);var q=new b(L.PUBCOMP,{messageIdentifier:d.messageIdentifier});this._schedule_message(q);break;case L.PUBCOMP:var U=this._sentMessages[d.messageIdentifier];delete this._sentMessages[d.messageIdentifier],R.removeItem("Sent:"+this._localKey+d.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(U.payloadMessage);break;case L.SUBACK:var U=this._sentMessages[d.messageIdentifier];U&&(U.timeOut&&U.timeOut.cancel(),d.returnCode[0]===128?U.onFailure&&U.onFailure(d.returnCode):U.onSuccess&&U.onSuccess(d.returnCode),delete this._sentMessages[d.messageIdentifier]);break;case L.UNSUBACK:var U=this._sentMessages[d.messageIdentifier];U&&(U.timeOut&&U.timeOut.cancel(),U.callback&&U.callback(),delete this._sentMessages[d.messageIdentifier]);break;case L.PINGRESP:this.sendPinger.reset();break;case L.DISCONNECT:this._disconnected(h.INVALID_MQTT_MESSAGE_TYPE.code,a(h.INVALID_MQTT_MESSAGE_TYPE,[d.type]));break;default:this._disconnected(h.INVALID_MQTT_MESSAGE_TYPE.code,a(h.INVALID_MQTT_MESSAGE_TYPE,[d.type]))}}catch(G){var j=G.hasOwnProperty("stack")=="undefined"?G.stack.toString():"No Error Stack Available";this._disconnected(h.INTERNAL_ERROR.code,a(h.INTERNAL_ERROR,[G.message,j]));return}},y.prototype._on_socket_error=function(d){this._reconnecting||this._disconnected(h.SOCKET_ERROR.code,a(h.SOCKET_ERROR,[d.data]))},y.prototype._on_socket_close=function(){this._reconnecting||this._disconnected(h.SOCKET_CLOSE.code,a(h.SOCKET_CLOSE))},y.prototype._socket_send=function(d){if(d.type==1){var g=this._traceMask(d,"password");this._trace("Client._socket_send",g)}else this._trace("Client._socket_send",d);this.socket.send(d.encode()),this.sendPinger.reset()},y.prototype._receivePublish=function(d){switch(d.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(d);break;case 1:var g=new b(L.PUBACK,{messageIdentifier:d.messageIdentifier});this._schedule_message(g),this._receiveMessage(d);break;case 2:this._receivedMessages[d.messageIdentifier]=d,this.store("Received:",d);var x=new b(L.PUBREC,{messageIdentifier:d.messageIdentifier});this._schedule_message(x);break;default:throw Error("Invaild qos="+d.payloadMessage.qos)}},y.prototype._receiveMessage=function(d){this.onMessageArrived&&this.onMessageArrived(d.payloadMessage)},y.prototype._connected=function(d,g){this.onConnected&&this.onConnected(d,g)},y.prototype._reconnect=function(){this._trace("Client._reconnect"),this.connected||(this._reconnecting=!0,this.sendPinger.cancel(),this.receivePinger.cancel(),this._reconnectInterval<128&&(this._reconnectInterval=this._reconnectInterval*2),this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri))},y.prototype._disconnected=function(d,g){if(this._trace("Client._disconnected",d,g),d!==void 0&&this._reconnecting){this._reconnectTimeout=new _(this,this._reconnectInterval,this._reconnect);return}if(this.sendPinger.cancel(),this.receivePinger.cancel(),this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null),this._msg_queue=[],this._buffered_msg_queue=[],this._notify_msg_sent={},this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.readyState===1&&this.socket.close(),delete this.socket),this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1)this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex]);else if(d===void 0&&(d=h.OK.code,g=a(h.OK)),this.connected){if(this.connected=!1,this.onConnectionLost&&this.onConnectionLost({errorCode:d,errorMessage:g,reconnect:this.connectOptions.reconnect,uri:this._wsuri}),d!==h.OK.code&&this.connectOptions.reconnect){this._reconnectInterval=1,this._reconnect();return}}else this.connectOptions.mqttVersion===4&&this.connectOptions.mqttVersionExplicit===!1?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:d,errorMessage:g})},y.prototype._trace=function(){if(this.traceFunction){var d=Array.prototype.slice.call(arguments);for(var g in d)typeof d[g]<"u"&&d.splice(g,1,JSON.stringify(d[g]));var x=d.join("");this.traceFunction({severity:"Debug",message:x})}if(this._traceBuffer!==null)for(var g=0,B=arguments.length;g<B;g++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),g===0?this._traceBuffer.push(arguments[g]):typeof arguments[g]>"u"?this._traceBuffer.push(arguments[g]):this._traceBuffer.push("  "+JSON.stringify(arguments[g]))},y.prototype._traceMask=function(d,g){var x={};for(var B in d)d.hasOwnProperty(B)&&(B==g?x[B]="******":x[B]=d[B]);return x};var I=function(d,g,x,B){var W;if(typeof d!="string")throw new Error(a(h.INVALID_TYPE,[typeof d,"host"]));if(arguments.length==2){B=g,W=d;var H=W.match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(H)d=H[4]||H[2],g=parseInt(H[7]),x=H[8];else throw new Error(a(h.INVALID_ARGUMENT,[d,"host"]))}else{if(arguments.length==3&&(B=x,x="/mqtt"),typeof g!="number"||g<0)throw new Error(a(h.INVALID_TYPE,[typeof g,"port"]));if(typeof x!="string")throw new Error(a(h.INVALID_TYPE,[typeof x,"path"]));var k=d.indexOf(":")!==-1&&d.slice(0,1)!=="["&&d.slice(-1)!=="]";W="ws://"+(k?"["+d+"]":d)+":"+g+x}for(var T=0,A=0;A<B.length;A++){var P=B.charCodeAt(A);55296<=P&&P<=56319&&A++,T++}if(typeof B!="string"||T>65535)throw new Error(a(h.INVALID_ARGUMENT,[B,"clientId"]));var q=new y(W,d,g,x,B);Object.defineProperties(this,{host:{get:function(){return d},set:function(){throw new Error(a(h.UNSUPPORTED_OPERATION))}},port:{get:function(){return g},set:function(){throw new Error(a(h.UNSUPPORTED_OPERATION))}},path:{get:function(){return x},set:function(){throw new Error(a(h.UNSUPPORTED_OPERATION))}},uri:{get:function(){return W},set:function(){throw new Error(a(h.UNSUPPORTED_OPERATION))}},clientId:{get:function(){return q.clientId},set:function(){throw new Error(a(h.UNSUPPORTED_OPERATION))}},onConnected:{get:function(){return q.onConnected},set:function(U){if(typeof U=="function")q.onConnected=U;else throw new Error(a(h.INVALID_TYPE,[typeof U,"onConnected"]))}},disconnectedPublishing:{get:function(){return q.disconnectedPublishing},set:function(U){q.disconnectedPublishing=U}},disconnectedBufferSize:{get:function(){return q.disconnectedBufferSize},set:function(U){q.disconnectedBufferSize=U}},onConnectionLost:{get:function(){return q.onConnectionLost},set:function(U){if(typeof U=="function")q.onConnectionLost=U;else throw new Error(a(h.INVALID_TYPE,[typeof U,"onConnectionLost"]))}},onMessageDelivered:{get:function(){return q.onMessageDelivered},set:function(U){if(typeof U=="function")q.onMessageDelivered=U;else throw new Error(a(h.INVALID_TYPE,[typeof U,"onMessageDelivered"]))}},onMessageArrived:{get:function(){return q.onMessageArrived},set:function(U){if(typeof U=="function")q.onMessageArrived=U;else throw new Error(a(h.INVALID_TYPE,[typeof U,"onMessageArrived"]))}},trace:{get:function(){return q.traceFunction},set:function(U){if(typeof U=="function")q.traceFunction=U;else throw new Error(a(h.INVALID_TYPE,[typeof U,"onTrace"]))}}}),this.connect=function(U){if(U=U||{},o(U,{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",reconnect:"boolean",mqttVersion:"number",mqttVersionExplicit:"boolean",uris:"object"}),U.keepAliveInterval===void 0&&(U.keepAliveInterval=60),U.mqttVersion>4||U.mqttVersion<3)throw new Error(a(h.INVALID_ARGUMENT,[U.mqttVersion,"connectOptions.mqttVersion"]));if(U.mqttVersion===void 0?(U.mqttVersionExplicit=!1,U.mqttVersion=4):U.mqttVersionExplicit=!0,U.password!==void 0&&U.userName===void 0)throw new Error(a(h.INVALID_ARGUMENT,[U.password,"connectOptions.password"]));if(U.willMessage){if(!(U.willMessage instanceof N))throw new Error(a(h.INVALID_TYPE,[U.willMessage,"connectOptions.willMessage"]));if(U.willMessage.stringPayload=null,typeof U.willMessage.destinationName>"u")throw new Error(a(h.INVALID_TYPE,[typeof U.willMessage.destinationName,"connectOptions.willMessage.destinationName"]))}if(typeof U.cleanSession>"u"&&(U.cleanSession=!0),U.hosts){if(!(U.hosts instanceof Array))throw new Error(a(h.INVALID_ARGUMENT,[U.hosts,"connectOptions.hosts"]));if(U.hosts.length<1)throw new Error(a(h.INVALID_ARGUMENT,[U.hosts,"connectOptions.hosts"]));for(var j=!1,G=0;G<U.hosts.length;G++){if(typeof U.hosts[G]!="string")throw new Error(a(h.INVALID_TYPE,[typeof U.hosts[G],"connectOptions.hosts["+G+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(U.hosts[G])){if(G===0)j=!0;else if(!j)throw new Error(a(h.INVALID_ARGUMENT,[U.hosts[G],"connectOptions.hosts["+G+"]"]))}else if(j)throw new Error(a(h.INVALID_ARGUMENT,[U.hosts[G],"connectOptions.hosts["+G+"]"]))}if(j)U.uris=U.hosts;else{if(!U.ports)throw new Error(a(h.INVALID_ARGUMENT,[U.ports,"connectOptions.ports"]));if(!(U.ports instanceof Array))throw new Error(a(h.INVALID_ARGUMENT,[U.ports,"connectOptions.ports"]));if(U.hosts.length!==U.ports.length)throw new Error(a(h.INVALID_ARGUMENT,[U.ports,"connectOptions.ports"]));U.uris=[];for(var G=0;G<U.hosts.length;G++){if(typeof U.ports[G]!="number"||U.ports[G]<0)throw new Error(a(h.INVALID_TYPE,[typeof U.ports[G],"connectOptions.ports["+G+"]"]));var Q=U.hosts[G],D=U.ports[G],Y=Q.indexOf(":")!==-1;W="ws://"+(Y?"["+Q+"]":Q)+":"+D+x,U.uris.push(W)}}}q.connect(U)},this.subscribe=function(U,j){if(typeof U!="string"&&U.constructor!==Array)throw new Error("Invalid argument:"+U);if(j=j||{},o(j,{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),j.timeout&&!j.onFailure)throw new Error("subscribeOptions.timeout specified with no onFailure callback.");if(typeof j.qos<"u"&&!(j.qos===0||j.qos===1||j.qos===2))throw new Error(a(h.INVALID_ARGUMENT,[j.qos,"subscribeOptions.qos"]));q.subscribe(U,j)},this.unsubscribe=function(U,j){if(typeof U!="string"&&U.constructor!==Array)throw new Error("Invalid argument:"+U);if(j=j||{},o(j,{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),j.timeout&&!j.onFailure)throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");q.unsubscribe(U,j)},this.send=function(U,j,G,Q){var D;if(arguments.length===0)throw new Error("Invalid argument.length");if(arguments.length==1){if(!(U instanceof N)&&typeof U!="string")throw new Error("Invalid argument:"+typeof U);if(D=U,typeof D.destinationName>"u")throw new Error(a(h.INVALID_ARGUMENT,[D.destinationName,"Message.destinationName"]));q.send(D)}else D=new N(j),D.destinationName=U,arguments.length>=3&&(D.qos=G),arguments.length>=4&&(D.retained=Q),q.send(D)},this.publish=function(U,j,G,Q){var D;if(arguments.length===0)throw new Error("Invalid argument.length");if(arguments.length==1){if(!(U instanceof N)&&typeof U!="string")throw new Error("Invalid argument:"+typeof U);if(D=U,typeof D.destinationName>"u")throw new Error(a(h.INVALID_ARGUMENT,[D.destinationName,"Message.destinationName"]));q.send(D)}else D=new N(j),D.destinationName=U,arguments.length>=3&&(D.qos=G),arguments.length>=4&&(D.retained=Q),q.send(D)},this.disconnect=function(){q.disconnect()},this.getTraceLog=function(){return q.getTraceLog()},this.startTrace=function(){q.startTrace()},this.stopTrace=function(){q.stopTrace()},this.isConnected=function(){return q.connected}},N=function(d){var g;if(typeof d=="string"||d instanceof ArrayBuffer||ArrayBuffer.isView(d)&&!(d instanceof DataView))g=d;else throw a(h.INVALID_ARGUMENT,[d,"newPayload"]);var x,B=0,W=!1,H=!1;Object.defineProperties(this,{payloadString:{enumerable:!0,get:function(){return typeof g=="string"?g:C(g,0,g.length)}},payloadBytes:{enumerable:!0,get:function(){if(typeof g=="string"){var k=new ArrayBuffer(u(g)),T=new Uint8Array(k);return v(g,T,0),T}else return g}},destinationName:{enumerable:!0,get:function(){return x},set:function(k){if(typeof k=="string")x=k;else throw new Error(a(h.INVALID_ARGUMENT,[k,"newDestinationName"]))}},qos:{enumerable:!0,get:function(){return B},set:function(k){if(k===0||k===1||k===2)B=k;else throw new Error("Invalid argument:"+k)}},retained:{enumerable:!0,get:function(){return W},set:function(k){if(typeof k=="boolean")W=k;else throw new Error(a(h.INVALID_ARGUMENT,[k,"newRetained"]))}},topic:{enumerable:!0,get:function(){return x},set:function(k){x=k}},duplicate:{enumerable:!0,get:function(){return H},set:function(k){H=k}}})};return{Client:I,Message:N}}(typeof Bi<"u"?Bi:typeof self<"u"?self:typeof window<"u"?window:{});return c})})(Bs);var pn=Bs.exports;const Ue=qr(pn),mn={style:{display:"flex","margin-bottom":"10px"}},yn={style:{display:"flex","margin-bottom":"10px"}},Sn={style:{display:"flex","margin-bottom":"10px"}},wn=ut({__name:"firmware",props:{projectParams:Object},emits:["closeFirmware"],setup(e,{emit:t}){const c=zr(Vr.GO_LANG_STORE)?.lang||"ZH",{CloseIcon:f}=Qt.ionicons5,E=Tt(),R=e,L=J(null),o=J(),l=J(),h=J(!1),S=J(!1),a=J(!1);let p=Ee({}),w=Ee({}),b=J([]),m=J([]),i=J([]),s=J([]),r=J(),n=J();const u=[{title:$t("energy.Driver_Name"),key:c.value=="ZH"?"display":"displayEn"},{title:$t("energy.Current_Version"),key:"version"},{title:$t("energy.LatestV_ersion"),key:"lastVersion"},{title:$t("energy.Previous_Updates"),key:"history",render(Q,D){return[_t(Ne,{size:"small",strong:!0,type:"success",quaternary:!0,style:{marginRight:"10px"},onClick:()=>j(Q)},{default:()=>$t("energy.detail")}),_t(Ne,{size:"small",strong:!0,quaternary:!0,type:"error",style:{marginRight:"10px"},onClick:()=>G(Q,D)},{default:()=>$t("energy.del")})]}}],v=[{title:$t("energy.Version"),key:"version"},{title:$t("energy.Update_Information"),key:"msg"}],C=[{type:"expand",renderExpand:(Q,D)=>_t(Ot,{columns:M,data:JSON.parse(Q.versions)},{default:()=>""})},{title:$t("energy.Update_Time"),key:"createTime"},{title:$t("energy.Update_Status"),key:"status"},{title:$t("energy.Update_Information"),key:"message"}],M=[{title:$t("energy.Firmware_Name"),key:"name"},{title:$t("energy.Old_Version"),key:"old"},{title:$t("energy.Current_Version"),key:"new"}],_=t,y=Q=>{console.log(Q),Q=="gw"?d(L.value,"gw"):Q=="north"?d(L.value,"north"):Q=="south"&&d(L.value,"south")},I=async()=>{if(m.value.length==0){E.warning($t("energy.Please_Select_a_Drive"));return}let Q=[];for(let V in m.value)Q.push(m.value[V].id);const D=await ji({gatewayId:L.value,type:"upgrade"});var Y=new WebSocket(D.data);Y.onmessage=V=>{let K=JSON.parse(V.data).upgradeStatus,ae=JSON.parse(V.data).message,ie=JSON.parse(V.data).type;a.value=K,ie=="tips"?(E.success(ae),K==!1&&_("closeFirmware","")):ie=="error"&&E.error(ae),K||Y.close()},Y.onerror=()=>{E.error($t("project.err"))},Y.onopen=()=>{dn({ids:Q.join(","),gatewayId:L.value}).then(V=>{V.code===200||Y&&Y.close()})}},N=()=>{_("closeFirmware","")},d=(Q,D)=>{b.value=[],hn({gatewayId:Q,category:D}).then(Y=>{if(Y.code==200)if(c=="ZH")for(let[V,K]of Object.entries(Y.data.zh))K.map(ae=>{ae.label=ae.display,ae.key=ae.display}),b.value.push({label:V,key:V,children:K});else for(let[V,K]of Object.entries(Y.data.en))K.map(ae=>{ae.label=ae.displayEn,ae.key=ae.displayEn}),b.value.push({label:V,key:V,children:K})})},g=Q=>{vn({gatewayId:Q}).then(D=>{D.code==200&&(i.value=D.data,i.value.forEach(Y=>{Y.key=Y.id}))})},x=Q=>{switch(Q){case"templateDownload":return h.value=!0,!1;default:return!0}},B=()=>{const Q={id:p.id,userId:p.userId,operate:"mqttTemplateDownload",gwType:p.model};fi(Q).then(D=>{if(D.code==200){const Y={param:D.data,operate:"complexCommand"};Object.assign(w,Y),H()}})},W=()=>{},H=async()=>{const Q=await gt({gatewayId:p.id});console.log(Q.data,"mqtt\u4E0B\u8F7D");let D=Q.data.mqttClientId,Y=Q.data.mqttPassword;r.value=new Ue.Client(Q.data.mqttUrl,Number(Q.data.mqttPort),D),console.log(r.value,"client\u662F\u4EC0\u4E48"),r.value.onConnectionLost=q,r.value.onMessageArrived=P,n.value={timeout:30,userName:Q.data.mqttUserName,password:Y,keepAliveInterval:60,cleanSession:!0,reconnect:!1,onSuccess:k,onFailure:T},r.value.connect(n.value)},k=()=>{console.log("\u8FDE\u63A5mqtt websocket\u7AEF\u53E3\u6210\u529F",l.value[0]),r.value.subscribe(l.value[0],{qos:0,onSuccess:()=>{console.log("\u8BA2\u9605\u4E2D..."),A()},onFailure:function(Q){console.log("\u8BA2\u9605\u6570\u636E\u5931\u8D25",Q),r.value.connect(n.value)}})},T=Q=>{E.error($t("energy.connection_fail"))},A=()=>{console.log("\u5B9E\u65F6\u6570\u636E....");let Q=new Ue.Message(JSON.stringify(w));Q.destinationName=o.value[0],r.value.send(Q)},P=Q=>{const D=JSON.parse(Q.payloadString);D.message?E.warning(D.message):E.success($t("project.operationSuccess")),r.value.end()},q=()=>{console.log("\u94FE\u63A5\u505C\u6B62/\u4E22\u5931")},U=Q=>{if(Q.option.display){let D;D=m.value.findIndex(Y=>Y.id==Q.option.id),D===-1&&m.value.push(Q.option)}},j=(Q,D)=>{fn({id:Q.id,version:Q.version}).then(Y=>{Y.code==200&&(s.value=Y.data)}),S.value=!0},G=(Q,D)=>{m.value.splice(D,1)};return Mt(()=>{R.projectParams&&(Object.assign(p,R.projectParams),L.value=p.id,d(p.id,"gw"),g(p.id),o.value=["/edge/complexCommand/"+p.sn+"/"+p.sn],l.value=["/edge/complexCommand/"+p.sn+"/"+p.sn+"/reply"])}),Gt(()=>{}),(Q,D)=>{const Y=de("n-text"),V=de("n-icon"),K=de("n-space"),ae=de("n-tree"),ie=de("n-tab-pane"),me=de("n-tabs"),De=de("n-card");return Se(),Fe("div",null,[F(De,null,{header:z(()=>[F(K,{style:{display:"flex","justify-content":"space-between"}},{default:z(()=>[F(Y,null,{default:z(()=>[le(se(Q.$t("energy.Driver_Information")),1)]),_:1}),F(V,{size:"30",class:"search-icon"},{default:z(()=>[F(O(f),{onClick:N})]),_:1})]),_:1})]),default:z(()=>[F(me,{onBeforeLeave:x,"onUpdate:value":y,style:{height:"76vh"}},{default:z(()=>[F(ie,{name:"gw",tab:Q.$t("energy.Gateway_firmware")},{default:z(()=>[ce("div",mn,[F(ae,{"block-line":"",data:O(b),"override-default-node-click-behavior":U,style:{width:"30%",height:"70vh",overflow:"auto"}},null,8,["data"]),F(O(Ot),{columns:u,data:O(m),"max-height":"63vh"},null,8,["data"])])]),_:1},8,["tab"]),F(ie,{name:"south",tab:Q.$t("energy.Southbound_driver")},{default:z(()=>[ce("div",yn,[F(ae,{"block-line":"",data:O(b),"override-default-node-click-behavior":U,style:{width:"30%",height:"70vh",overflow:"auto"}},null,8,["data"]),F(O(Ot),{columns:u,data:O(m),"max-height":"63vh"},null,8,["data"])])]),_:1},8,["tab"]),F(ie,{name:"north",tab:Q.$t("energy.Northbound_service")},{default:z(()=>[ce("div",Sn,[F(ae,{"block-line":"",data:O(b),"override-default-node-click-behavior":U,style:{width:"30%",height:"70vh",overflow:"auto"}},null,8,["data"]),F(O(Ot),{columns:u,data:O(m),"max-height":"63vh"},null,8,["data"])])]),_:1},8,["tab"]),Ae(` <n-tab-pane name="upgradeDriver" :tab="$t('energy.Update_Driver')">
          
        </n-tab-pane> `),F(ie,{name:"historicalUpgrade",tab:Q.$t("energy.Previous_Updates")},{default:z(()=>[F(O(Ot),{columns:C,data:O(i),"max-height":"63vh"},null,8,["data"])]),_:1},8,["tab"]),F(ie,{name:"templateDownload",tab:Q.$t("energy.Template_Download")},null,8,["tab"])]),_:1}),F(K,{justify:"flex-end"},{default:z(()=>[F(K,null,{default:z(()=>[Ae(' <n-button @click="close">gaun</n-button> '),F(O(Ne),{size:"medium",type:"primary",loading:a.value,onClick:I,secondary:""},{default:z(()=>[le(se(a.value?Q.$t("energy.Updating"):Q.$t("energy.Update")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),F(O(di),{show:h.value,"onUpdate:show":D[0]||(D[0]=Te=>h.value=Te),"show-icon":!1,preset:"dialog","mask-closable":!1,style:{width:"30%"},title:Q.$t("project.confirm"),positiveButtonProps:{secondary:!0},content:Q.$t("energy.Whether_to_download_the_template_or_not"),"positive-text":Q.$t("project.confirm1"),"negative-text":Q.$t("project.cancel"),onPositiveClick:B,onNegativeClick:W},null,8,["show","title","content","positive-text","negative-text"]),F(O(di),{show:S.value,"onUpdate:show":D[1]||(D[1]=Te=>S.value=Te),preset:"dialog",style:{width:"50%",height:"86vh"},title:Q.$t("energy.Version_History"),"show-icon":!1},{default:z(()=>[F(O(Ot),{"max-height":"70vh",columns:v,data:O(s)},null,8,["data"])]),_:1},8,["show","title"])])}}}),Ns=At(wn,[["__scopeId","data-v-fad02092"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/energy/gateway/firmware.vue"]]),bn=ut({__name:"realData",props:{gatewayDetail:Object},emits:["closeFirmware"],setup(e,{emit:t}){const c=Ni(),{CloseIcon:f,EllipseIcon:E}=Qt.ionicons5,R=Tt(),L=e,o=J(null),l=J(),h=J();Ee({}),Ee({});const S=J();let a=J(),p=Ee({page:1,size:10,requestId:c.getToken}),w=J(""),b=J(0),m=J([]),i=J(!1),s=J(),r=Ee({});const n=[{title:"ID",key:"id"},{title:"\u63CF\u8FF0",key:"description"},{title:"\u5B9E\u65F6\u6570\u636E",key:"val"},{title:"\u66F4\u65B0\u65F6\u95F4",key:"timestamp",render:x=>Jt(x.timestamp*1e3,"yyyy-MM-dd HH:mm:ss")},{title:"\u72B6\u6001",key:"status",render:x=>_t("div",{class:"icon-span-container"},[_t(E,{style:{color:x.status=="Good"?"#0ABF5F":"red",width:"10px",height:"10px"}}),_t("span",{},x.status)])}];ui(()=>{try{S.value.isConnected&&S.value.disconnect()}catch{}s.value!==null&&clearTimeout(s.value)}),ks(()=>i.value,x=>{console.log("\u5173\u95ED\u81EA\u52A8\u5237\u65B0"),x?s.value=setInterval(()=>{y()},5e3):clearTimeout(s.value)});const u=()=>{p.page=1,p.size=10,p.tagID=w.value,y()},v=()=>{w.value="",p.page=1,p.size=15,y()},C=async()=>{const x=await gt({gatewayId:o.value});let B=x.data.mqttClientId,W=x.data.mqttPassword;S.value=new Ue.Client(x.data.mqttUrl,Number(x.data.mqttPort),B),S.value.onConnectionLost=N,S.value.onMessageArrived=I,a.value={timeout:30,userName:x.data.mqttUserName,password:W,keepAliveInterval:60,cleanSession:!0,reconnect:!1,onSuccess:M,onFailure:_};try{S.value.connect(a.value)}catch(H){console.error("\u8FDE\u63A5\u9519\u8BEF",H),_()}},M=()=>{console.log("\u8FDE\u63A5mqtt websocket\u7AEF\u53E3\u6210\u529F",h.value[0]),S.value.subscribe(h.value[0],{qos:0,onSuccess:()=>{console.log("\u8BA2\u9605\u4E2D..."),y()},onFailure:function(x){console.log("\u8BA2\u9605\u6570\u636E\u5931\u8D25",x),S.value.connect(a.value)}})},_=x=>{R.error($t("energy.connection_fail"))},y=()=>{let x=new Ue.Message(JSON.stringify(p));x.destinationName=l.value[0],S.value.send(x)},I=x=>{const B=JSON.parse(x.payloadString);console.log("\u5B9E\u65F6\u6570\u636E",B),b.value=B.totalRows,p.requestId==B.requestId&&(m.value=B.Data||[])},N=()=>{console.log("\u94FE\u63A5\u505C\u6B62/\u4E22\u5931")},d=x=>{p.size=x,y()},g=x=>{p.page=x,y()};return Mt(()=>{L.gatewayDetail&&(r=L.gatewayDetail,o.value=r.id,l.value=["/edge/property/"+r.sn+"/"+r.sn+"/get"],h.value=["/edge/property/"+r.sn+"/"+r.sn+"/get/reply"],i.value=!0,C())}),Gt(()=>{}),(x,B)=>{const W=de("n-input"),H=de("n-form-item"),k=de("n-checkbox"),T=de("n-form"),A=de("n-pagination");return Se(),Fe("div",null,[F(T,{ref:"formRef",inline:"","label-width":50,model:O(p),"label-placement":"left"},{default:z(()=>[F(H,{label:"ID"},{default:z(()=>[F(W,{value:O(w),"onUpdate:value":B[0]||(B[0]=P=>vt(w)?w.value=P:w=P),clearable:"",placeholder:"\u8BF7\u8F93\u5165",onClear:v},null,8,["value"])]),_:1}),F(H,null,{default:z(()=>[F(O(Ne),{onClick:u,type:"primary",secondary:""},{default:z(()=>[le(se(x.$t("energy.search")),1)]),_:1})]),_:1}),F(H,null,{default:z(()=>[F(k,{checked:O(i),"onUpdate:checked":B[1]||(B[1]=P=>vt(i)?i.value=P:i=P)},{default:z(()=>[le(se(x.$t("energy.automatic_refresh")),1)]),_:1},8,["checked"])]),_:1})]),_:1},8,["model"]),F(O(Ot),{columns:n,data:O(m)},null,8,["data"]),F(A,{class:"pagination-top",page:O(p).page,"onUpdate:page":B[2]||(B[2]=P=>O(p).page=P),"page-size":O(p).size,"onUpdate:pageSize":B[3]||(B[3]=P=>O(p).size=P),"item-count":O(b),"page-sizes":[10,30,50,100],"show-size-picker":"","on-update:page":g,"on-update:page-size":d},{prefix:z(({itemCount:P})=>[le(se(x.$t("project.total"))+" "+se(P)+" "+se(x.$t("project.items")),1)]),_:1},8,["page","page-size","item-count"])])}}}),Cn=At(bn,[["__scopeId","data-v-1a56945f"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/energy/gateway/realData.vue"]]),En=ut({__name:"sysData",props:{gatewayDetail:Object},emits:["realSystemData"],setup(e,{emit:t}){const c=Ni(),f=t,E=Tt(),R=e;J("");let L=Ee({page:1,size:20,deviceCode:"system",requestId:c.getToken+"system"});J(0),J([]);let o=J(!1);J();let l=J(),h=J(),S=J(),a=J(),p=J(),w=Ee({});ui(()=>{try{l.value.isConnected&&l.value.disconnect()}catch{}});const b=async()=>{const u=await gt({gatewayId:w.id});console.log(u.data,"mqtt\u4E0B\u8F7D");let v=u.data.mqttClientId,C=u.data.mqttPassword;l.value=new Ue.Client(u.data.mqttUrl,Number(u.data.mqttPort),v),l.value.onConnectionLost=n,l.value.onMessageArrived=r,a.value={timeout:30,userName:u.data.mqttUserName,password:C,keepAliveInterval:60,cleanSession:!0,reconnect:!1,onSuccess:m,onFailure:i};try{l.value.connect(a.value)}catch{i()}},m=()=>{console.log("\u8FDE\u63A5mqtt websocket\u7AEF\u53E3\u6210\u529F",S.value[0]),l.value.subscribe(S.value[0],{qos:0,onSuccess:()=>{console.log("\u8BA2\u9605\u4E2D..."),s()},onFailure:function(u){console.log("\u8BA2\u9605\u6570\u636E\u5931\u8D25",u),l.value.connect(a.value)}})},i=u=>{E.error($t("energy.connection_fail"))},s=()=>{console.log("\u53D1\u5E03\u6D88\u606F",h.value[0]);let u=new Ue.Message(JSON.stringify(L));u.destinationName=h.value[0],l.value.send(u)},r=u=>{let v=JSON.parse(u.payloadString);L.requestId==v.requestId&&(console.log("\u7CFB\u7EDF\u70B9\u6570\u636E....",v),f("realSystemData",v))},n=()=>{l.value!=null&&(l.value.disconnect(),l.value=null),console.log("\u94FE\u63A5\u505C\u6B62/\u4E22\u5931")};return Mt(()=>{R.gatewayDetail&&(Object.assign(w,R.gatewayDetail),p.value=w.id,h.value=["/edge/property/"+w.sn+"/"+w.sn+"/get"],S.value=["/edge/property/"+w.sn+"/"+w.sn+"/get/reply"],o.value=!0,b())}),(u,v)=>(Se(),Fe("div",null,[Ae(` <n-form ref="formRef" inline :label-width="50" :model="formData" label-placement="left">
      <n-form-item label="ID">
        <n-input v-model:value="searchId" clearable placeholder="\u8BF7\u8F93\u5165" @clear="onClear" />
      </n-form-item>
      <n-form-item>
        <n-button @click="onSearch" type="primary">\u641C\u7D22</n-button>
      </n-form-item>
      <n-form-item>
        <n-checkbox v-model:checked="checked"> \u81EA\u52A8\u5237\u65B0 </n-checkbox>
      </n-form-item>
    </n-form> `),Ae(' <n-data-table :columns="columns" :data="dataList"></n-data-table> '),Ae(` <n-pagination
      class="pagination-top"
      v-model:page="formData.page"
      v-model:page-size="formData.size"
      :item-count="total"
      :page-sizes="[10, 30, 50, 100]"
      show-size-picker
      :on-update:page="currentChange"
      :on-update:page-size="sizeChange"
    >
      <template #prefix="{ itemCount }"> \u5171 {{ itemCount }} \u9879 </template>
</n-pagination> `)]))}}),kn=At(En,[["__scopeId","data-v-e971da31"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/energy/gateway/sysData.vue"]]),Dn={class:"content"},Mn={style:{height:"calc(100vh - 200px)","overflow-y":"auto"}},An={class:"net-method"},xn={class:"net-title flex"},Rn={class:"net-title",style:{}},Ln={class:"net-form-content"},Tn={class:"net-form-content"},On={style:{"font-size":"16px","font-weight":"600"}},In={class:"net-form-content"},Pn={style:{"font-size":"16px","font-weight":"600","margin-top":"5px"}},Bn={class:"net-form-content"},Nn={class:"flex-right margin-t-15"},Hn=ut({__name:"ipconfig",props:{gatewayDetail:Object},emits:["changeLoading"],setup(e,{emit:t}){const c=J("wired");let f=J("");const E=J(!1);let R=J(!1),L=J(!1),o=Ee([{label:"ETH0",value:"ETH0",disabled:Ds(()=>R.value)},{label:"ETH1",value:"ETH1",disabled:Ds(()=>L.value)}]);console.log(o);const l=Tt(),h=e,S=J(null),a=J(),p=J();let w=Ee({}),b=Ee({}),m=J(),i=J(),s=Ee({nets:"ETH0",dns1:"",dns2:"",ssid:"",psk:"",IPADDR:"",NETMASK:"",GATEWAY:"",ETH0:{DHCP:"",GATEWAY:"",IPADDR:"",MAC:"",NETMASK:""},ETH1:{DHCP:"",GATEWAY:"",IPADDR:"",MAC:"",NETMASK:""},apn_name:"",apn_user:"",apn_passwd:"",apn_auth:"",auto_check:"",ping_address1:"",ping_address2:"",ping_address3:"",check_timeS:""});J(""),J(0),J([]);let r=Ee({});const n=t;ui(()=>{try{m.value.isConnected&&m.value.disconnect()}catch{}});const u=d=>{f.value=d.name},v=async()=>{n("changeLoading",!0);const d=await gt({gatewayId:w.id});let g=d.data.mqttClientId,x=d.data.mqttPassword;m.value=new Ue.Client(d.data.mqttUrl,Number(d.data.mqttPort),g),m.value.onConnectionLost=I,m.value.onMessageArrived=y,i.value={timeout:30,userName:d.data.mqttUserName,password:x,keepAliveInterval:60,cleanSession:!0,reconnect:!1,onSuccess:C,onFailure:M},m.value.connect(i.value)},C=()=>{console.log("\u8FDE\u63A5mqtt websocket\u7AEF\u53E3\u6210\u529F",p.value[0]),m.value.subscribe(p.value[0],{qos:0,onSuccess:()=>{console.log("\u8BA2\u9605\u4E2D..."),_()},onFailure:function(d){console.log("\u8BA2\u9605\u6570\u636E\u5931\u8D25",d),m.value.connect(i.value)}})},M=d=>{l.error($t("energy.connection_fail"))},_=()=>{let d=new Ue.Message(JSON.stringify(b));d.destinationName=a.value[0],m.value.send(d)},y=d=>{n("changeLoading",!1);const g=JSON.parse(d.payloadString);if(console.log("\u83B7\u53D6\u7684\u6570\u636E",g),g.message)l.warning(g.message);else if(b.operate=="getIP"){let H=g.result,k=[],T=[],A=[],P=[],q=[],U=[];H.length==7?(k=H[0].split(`
`),T=H[1].split(`
`),A=H[2].split(`
`),c.value=H[3].split("=")[1],P=H[4].split(`
`),q=H[5].split(`
`),U=H[6].split(`
`)):H.length==6&&(k=H[0].split(`
`),A=H[1].split(`
`),c.value=H[2].split("=")[1],P=H[3].split(`
`),q=H[4].split(`
`),U=H[5].split(`
`));for(let j of k)j.indexOf("DHCP")!=-1?s.ETH0.DHCP=JSON.parse(j.split("=")[1]):j.indexOf("GATEWAY")!=-1?s.ETH0.GATEWAY=j.split("=")[1]:j.indexOf("IPADDR")!=-1?s.ETH0.IPADDR=j.split("=")[1]:j.indexOf("NETMASK")!=-1&&(s.ETH0.NETMASK=j.split("=")[1]);if(T.length>0)for(let j of T)j.indexOf("DHCP")!=-1?s.ETH1.DHCP=JSON.parse(j.split("=")[1]):j.indexOf("GATEWAY")!=-1?s.ETH1.GATEWAY=j.split("=")[1]:j.indexOf("IPADDR")!=-1?s.ETH1.IPADDR=j.split("=")[1]:j.indexOf("NETMASK")!=-1&&(s.ETH1.NETMASK=j.split("=")[1]);if(U.length>0)for(let j of U)j.indexOf("auto_check")!=-1?s.auto_check=JSON.parse(j.split("=")[1]):j.indexOf("apn_auth")!=-1?s.apn_auth=j.split("=")[1]:j.indexOf("apn_name")!=-1||j.indexOf("#apn_name")!=-1?s.apn_name=j.split("=")[1]:j.indexOf("apn_user")!=-1||j.indexOf("#apn_user")!=-1?s.apn_user=j.split("=")[1]:j.indexOf("apn_passwd")!=-1||j.indexOf("#apn_passwd")!=-1?s.apn_passwd=j.split("=")[1]:j.indexOf("ping_address1")!=-1?s.ping_address1=j.split("=")[1]:j.indexOf("ping_address2")!=-1?s.ping_address2=j.split("=")[1]:j.indexOf("ping_address3")!=-1?s.ping_address3=j.split("=")[1]:j.indexOf("check_timeS")!=-1&&(s.check_timeS=j.split("=")[1]);s.dns1=A[0].split("nameserver ")[1],A.length>1&&(s.dns2=A[1].split("nameserver ")[1]),s.IPADDR=P[0].split("=")[1],s.NETMASK=P[1].split("=")[1],s.GATEWAY=P[2].split("=")[1],E.value=JSON.parse(P[3].split("=")[1]);for(var x=0;x<q.length;x++){var B=q[x].indexOf("ssid");if(B!=-1){let j=q[x].replace(/^\s*|\s*$/g,"").slice(6,-1);s.ssid=j}var W=q[x].indexOf("psk");if(W!=-1){let j=q[x].replace(/^\s*|\s*$/g,"").slice(5,-1);s.psk=j}}H.length==6&&(L.value=!0),f.value=c.value}else l.success($t("project.operationSuccess"));m.value.end()},I=()=>{console.log("\u94FE\u63A5\u505C\u6B62/\u4E22\u5931")},N=()=>{let d={};d.netMethod=c.value,d.wrieddhcp=s[s.nets].DHCP,d.wriedeth=s.nets,d.wriedIp=s[s.nets].IPADDR,d.wriedNetmask=s[s.nets].NETMASK,d.wriedGateway=s[s.nets].GATEWAY,d.dns1=s.dns1,d.dns2=s.dns2,d.wifidhcp=E.value,d.wifiIp=s.IPADDR,d.wifiNetmask=s.NETMASK,d.wifiGateway=s.GATEWAY,d.ssid=s.ssid,d.psk=s.psk,d.apn_name=s.apn_name,d.apn_user=s.apn_user,d.apn_passwd=s.apn_passwd,d.apn_auth=s.apn_auth,d.auto_check=s.auto_check,d.ping_address1=s.ping_address1,d.ping_address2=s.ping_address2,d.ping_address3=s.ping_address3,d.check_timeS=s.check_timeS;let g={operate:"setIP",id:w.projectId,userid:w.userId,...d,gwType:w.model};fi({...g}).then(x=>{x.code==200&&(b={param:x.data},v())})};return Mt(async()=>{if(h.gatewayDetail){r=h.gatewayDetail,w=h.gatewayDetail,S.value=r.id,a.value=["/edge/complexCommand/"+r.sn+"/"+r.sn],p.value=["/edge/complexCommand/"+r.sn+"/"+r.sn+"/reply"];const d=await fi({id:w.id,userId:w.userId,operate:"getIP",gwType:w.model});d.code==200&&(b={param:d.data,gwType:w.model,operate:"getIP"},v())}}),Gt(()=>{}),(d,g)=>{const x=de("n-space"),B=de("n-switch"),W=de("n-select"),H=de("n-input"),k=de("n-divider"),T=de("n-radio");return Se(),Fe("div",Dn,[ce("div",Mn,[ce("div",An,[ce("div",xn,se(d.$t("energy.Networking_mode")),1),F(x,null,{default:z(()=>[F(O(Ms),{value:c.value,"onUpdate:value":g[0]||(g[0]=A=>c.value=A),name:"radiobuttongroup1",size:"large"},{default:z(()=>[F(O(Wi),{key:"wired",value:"wired",label:d.$t("energy.wired")},null,8,["label"]),F(O(Wi),{key:"wifi",value:"wifi",label:"WIFI"}),F(O(Wi),{key:"cellular",value:"cellular",label:"4G"})]),_:1},8,["value"])]),_:1}),Ae(" </template> ")]),F(O(Kr),{"arrow-placement":"right",accordion:!0,"expanded-names":O(f),onItemHeaderClick:u},{arrow:z(()=>g[23]||(g[23]=[])),default:z(()=>[F(O(Hi),{name:"wired"},{header:z(()=>[ce("div",Rn,se(d.$t("energy.wired")),1)]),default:z(()=>[ce("div",null,[ce("div",null,[ce("span",null,se(d.$t("energy.Auto_obtain_IP"))+" (DHCP): ",1),F(B,{value:O(s)[O(s).nets].DHCP,"onUpdate:value":g[1]||(g[1]=A=>O(s)[O(s).nets].DHCP=A)},null,8,["value"])]),ce("div",Ln,[F(O(Xt),{ref:"formRef",inline:"","label-width":100,model:O(s),"label-placement":"left"},{default:z(()=>[F(O(_i),{cols:24,"x-gap":24},{default:z(()=>[F(O(He),{label:d.$t("energy.Network")+":",span:12},{default:z(()=>[Ae(" \u7F51\u53E3 "),F(W,{value:O(s).nets,"onUpdate:value":g[2]||(g[2]=A=>O(s).nets=A),options:O(o),style:{width:"270px"}},null,8,["value","options"])]),_:1},8,["label"]),F(O(He),{label:d.$t("energy.IP_Address")+":",span:12},{default:z(()=>[F(H,{disabled:O(s)[O(s).nets].DHCP,value:O(s)[O(s).nets].IPADDR,"onUpdate:value":g[3]||(g[3]=A=>O(s)[O(s).nets].IPADDR=A),style:{width:"270px"}},null,8,["disabled","value"])]),_:1},8,["label"]),F(O(He),{label:d.$t("energy.Subnet_Mask")+":",span:12},{default:z(()=>[F(H,{disabled:O(s)[O(s).nets].DHCP,value:O(s)[O(s).nets].NETMASK,"onUpdate:value":g[4]||(g[4]=A=>O(s)[O(s).nets].NETMASK=A),style:{width:"270px"}},null,8,["disabled","value"])]),_:1},8,["label"]),F(O(He),{label:d.$t("energy.Default_Gateway")+":",span:12},{default:z(()=>[F(H,{disabled:O(s)[O(s).nets].DHCP,value:O(s)[O(s).nets].GATEWAY,"onUpdate:value":g[5]||(g[5]=A=>O(s)[O(s).nets].GATEWAY=A),style:{width:"270px"}},null,8,["disabled","value"])]),_:1},8,["label"]),F(O(He),{label:d.$t("energy.Primary")+"DNS:",span:12},{default:z(()=>[F(H,{value:O(s).dns1,"onUpdate:value":g[6]||(g[6]=A=>O(s).dns1=A),style:{width:"270px"}},null,8,["value"])]),_:1},8,["label"]),F(O(He),{label:d.$t("energy.Secondary")+"DNS:",span:12},{default:z(()=>[F(H,{value:O(s).dns2,"onUpdate:value":g[7]||(g[7]=A=>O(s).dns2=A),style:{width:"270px"}},null,8,["value"])]),_:1},8,["label"])]),_:1})]),_:1},8,["model"])])])]),_:1}),F(O(Hi),{name:"wifi"},{header:z(()=>g[24]||(g[24]=[ce("div",{class:"net-title",style:{}},"WIFI",-1)])),default:z(()=>[ce("div",null,[ce("div",null,[ce("span",null,se(d.$t("energy.Auto_obtain_IP"))+" (DHCP): ",1),F(B,{value:E.value,"onUpdate:value":g[8]||(g[8]=A=>E.value=A)},null,8,["value"])]),ce("div",Tn,[F(O(Xt),{ref:"formRef",inline:"","label-width":100,model:O(s),"label-placement":"left"},{default:z(()=>[F(O(_i),{cols:24,"x-gap":24},{default:z(()=>[F(O(He),{label:"SSID:",span:12},{default:z(()=>[F(H,{value:O(s).ssid,"onUpdate:value":g[9]||(g[9]=A=>O(s).ssid=A),style:{width:"270px"}},null,8,["value"])]),_:1}),F(O(He),{label:d.$t("energy.Password")+":",span:12},{default:z(()=>[F(H,{value:O(s).psk,"onUpdate:value":g[10]||(g[10]=A=>O(s).psk=A),style:{width:"270px"}},null,8,["value"])]),_:1},8,["label"]),F(O(He),{label:d.$t("energy.IP_Address")+":",span:12},{default:z(()=>[F(H,{value:O(s).IPADDR,"onUpdate:value":g[11]||(g[11]=A=>O(s).IPADDR=A),style:{width:"270px"}},null,8,["value"])]),_:1},8,["label"]),F(O(He),{label:d.$t("energy.Subnet_Mask")+":",span:12},{default:z(()=>[F(H,{value:O(s).NETMASK,"onUpdate:value":g[12]||(g[12]=A=>O(s).NETMASK=A),style:{width:"270px"}},null,8,["value"])]),_:1},8,["label"]),F(O(He),{label:d.$t("energy.Default_Gateway")+":",span:12},{default:z(()=>[F(H,{value:O(s).GATEWAY,"onUpdate:value":g[13]||(g[13]=A=>O(s).GATEWAY=A),style:{width:"270px"}},null,8,["value"])]),_:1},8,["label"])]),_:1})]),_:1},8,["model"])])])]),_:1}),F(O(Hi),{name:"cellular"},{header:z(()=>g[25]||(g[25]=[ce("div",{class:"net-title",style:{}},"4G",-1)])),default:z(()=>[ce("div",null,[ce("div",On,"4G&5G"+se(d.$t("energy.Network_Automatic_Monitoring")),1),ce("div",null,[ce("span",null,se(d.$t("energy.Enable_Automatic_Monitoring"))+": ",1),F(B,{value:O(s).auto_check,"onUpdate:value":g[14]||(g[14]=A=>O(s).auto_check=A),"checked-value":1,"unchecked-value":0},null,8,["value"])]),ce("div",In,[F(O(Xt),{ref:"formRef",inline:"","label-width":100,model:O(s),"label-placement":"left"},{default:z(()=>[F(O(_i),{cols:24,"x-gap":24},{default:z(()=>[F(O(He),{label:d.$t("energy.Server_Address")+"1:",span:12},{default:z(()=>[F(H,{value:O(s).ping_address1,"onUpdate:value":g[15]||(g[15]=A=>O(s).ping_address1=A),disabled:O(s).auto_check==0,style:{width:"270px"}},null,8,["value","disabled"])]),_:1},8,["label"]),F(O(He),{label:d.$t("energy.Server_Address")+"2:",span:12},{default:z(()=>[F(H,{value:O(s).ping_address2,"onUpdate:value":g[16]||(g[16]=A=>O(s).ping_address2=A),disabled:O(s).auto_check==0,style:{width:"270px"}},null,8,["value","disabled"])]),_:1},8,["label"]),F(O(He),{label:d.$t("energy.Server_Address")+"3:",span:12},{default:z(()=>[F(H,{value:O(s).ping_address3,"onUpdate:value":g[17]||(g[17]=A=>O(s).ping_address3=A),disabled:O(s).auto_check==0,style:{width:"270px"}},null,8,["value","disabled"])]),_:1},8,["label"]),F(O(He),{label:d.$t("energy.Detection_Interval")+"1:",span:12},{default:z(()=>[F(H,{value:O(s).check_timeS,"onUpdate:value":g[18]||(g[18]=A=>O(s).check_timeS=A),disabled:O(s).auto_check==0,style:{width:"270px"}},null,8,["value","disabled"])]),_:1},8,["label"])]),_:1})]),_:1},8,["model"])]),F(k),ce("div",Pn,"4G&5G"+se(d.$t("energy.Network_APN_Settings")),1),ce("div",Bn,[F(O(Xt),{ref:"formRef",inline:"","label-width":100,model:O(s),"label-placement":"left"},{default:z(()=>[F(O(_i),{cols:24,"x-gap":24},{default:z(()=>[F(O(He),{label:"APN:",span:12},{default:z(()=>[F(H,{value:O(s).apn_name,"onUpdate:value":g[19]||(g[19]=A=>O(s).apn_name=A),style:{width:"270px"}},null,8,["value"])]),_:1}),F(O(He),{span:12},{default:z(()=>g[26]||(g[26]=[ce("div",{style:{width:"270px"}},null,-1)])),_:1}),F(O(He),{label:"APN"+d.$t("energy.Username")+":",span:12},{default:z(()=>[F(H,{value:O(s).apn_user,"onUpdate:value":g[20]||(g[20]=A=>O(s).apn_user=A),style:{width:"270px"}},null,8,["value"])]),_:1},8,["label"]),F(O(He),{label:"APN"+d.$t("energy.Password")+":",span:12},{default:z(()=>[F(H,{value:O(s).apn_passwd,"onUpdate:value":g[21]||(g[21]=A=>O(s).apn_passwd=A),style:{width:"270px"}},null,8,["value"])]),_:1},8,["label"]),F(O(He),{label:"APN"+d.$t("energy.Authentication_Type")+":",span:12},{default:z(()=>[F(O(Ms),{value:O(s).apn_auth,"onUpdate:value":g[22]||(g[22]=A=>O(s).apn_auth=A),name:"radiogroup"},{default:z(()=>[F(T,{lable:"0",value:"0"},{default:z(()=>g[27]||(g[27]=[le("NONE")])),_:1}),F(T,{lable:"1",value:"1"},{default:z(()=>g[28]||(g[28]=[le("PAP")])),_:1}),F(T,{lable:"2",value:"2"},{default:z(()=>g[29]||(g[29]=[le("CHAP")])),_:1}),F(T,{lable:"3",value:"3"},{default:z(()=>g[30]||(g[30]=[le("PAP+CHAP")])),_:1})]),_:1},8,["value"])]),_:1},8,["label"])]),_:1})]),_:1},8,["model"])])])]),_:1})]),_:1},8,["expanded-names"])]),ce("div",Nn,[F(O(Ne),{type:"primary",onClick:N,secondary:""},{default:z(()=>[le(se(d.$t("energy.save")),1)]),_:1})])])}}}),Un=At(Hn,[["__scopeId","data-v-afb126aa"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/energy/gateway/ipconfig.vue"]]);//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Hs;function ne(){return Hs.apply(null,arguments)}function Fn(e){Hs=e}function et(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Pt(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function be(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Yi(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(be(e,t))return!1;return!0}function Ke(e){return e===void 0}function pt(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function Zt(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function Us(e,t){var c=[],f,E=e.length;for(f=0;f<E;++f)c.push(t(e[f],f));return c}function xt(e,t){for(var c in t)be(t,c)&&(e[c]=t[c]);return be(t,"toString")&&(e.toString=t.toString),be(t,"valueOf")&&(e.valueOf=t.valueOf),e}function at(e,t,c,f){return ur(e,t,c,f,!0).utc()}function Wn(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function fe(e){return e._pf==null&&(e._pf=Wn()),e._pf}var qi;Array.prototype.some?qi=Array.prototype.some:qi=function(e){var t=Object(this),c=t.length>>>0,f;for(f=0;f<c;f++)if(f in t&&e.call(this,t[f],f,t))return!0;return!1};function zi(e){var t=null,c=!1,f=e._d&&!isNaN(e._d.getTime());if(f&&(t=fe(e),c=qi.call(t.parsedDateParts,function(E){return E!=null}),f=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&c),e._strict&&(f=f&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=f;else return f;return e._isValid}function vi(e){var t=at(NaN);return e!=null?xt(fe(t),e):fe(t).userInvalidated=!0,t}var Fs=ne.momentProperties=[],Vi=!1;function Ki(e,t){var c,f,E,R=Fs.length;if(Ke(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Ke(t._i)||(e._i=t._i),Ke(t._f)||(e._f=t._f),Ke(t._l)||(e._l=t._l),Ke(t._strict)||(e._strict=t._strict),Ke(t._tzm)||(e._tzm=t._tzm),Ke(t._isUTC)||(e._isUTC=t._isUTC),Ke(t._offset)||(e._offset=t._offset),Ke(t._pf)||(e._pf=fe(t)),Ke(t._locale)||(e._locale=t._locale),R>0)for(c=0;c<R;c++)f=Fs[c],E=t[f],Ke(E)||(e[f]=E);return e}function ei(e){Ki(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Vi===!1&&(Vi=!0,ne.updateOffset(this),Vi=!1)}function tt(e){return e instanceof ei||e!=null&&e._isAMomentObject!=null}function Ws(e){ne.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Xe(e,t){var c=!0;return xt(function(){if(ne.deprecationHandler!=null&&ne.deprecationHandler(null,e),c){var f=[],E,R,L,o=arguments.length;for(R=0;R<o;R++){if(E="",typeof arguments[R]=="object"){E+=`
[`+R+"] ";for(L in arguments[0])be(arguments[0],L)&&(E+=L+": "+arguments[0][L]+", ");E=E.slice(0,-2)}else E=arguments[R];f.push(E)}Ws(e+`
Arguments: `+Array.prototype.slice.call(f).join("")+`
`+new Error().stack),c=!1}return t.apply(this,arguments)},t)}var $s={};function js(e,t){ne.deprecationHandler!=null&&ne.deprecationHandler(e,t),$s[e]||(Ws(t),$s[e]=!0)}ne.suppressDeprecationWarnings=!1,ne.deprecationHandler=null;function lt(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function $n(e){var t,c;for(c in e)be(e,c)&&(t=e[c],lt(t)?this[c]=t:this["_"+c]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Gi(e,t){var c=xt({},e),f;for(f in t)be(t,f)&&(Pt(e[f])&&Pt(t[f])?(c[f]={},xt(c[f],e[f]),xt(c[f],t[f])):t[f]!=null?c[f]=t[f]:delete c[f]);for(f in e)be(e,f)&&!be(t,f)&&Pt(e[f])&&(c[f]=xt({},c[f]));return c}function Ji(e){e!=null&&this.set(e)}var Xi;Object.keys?Xi=Object.keys:Xi=function(e){var t,c=[];for(t in e)be(e,t)&&c.push(t);return c};var jn={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Yn(e,t,c){var f=this._calendar[e]||this._calendar.sameElse;return lt(f)?f.call(t,c):f}function ct(e,t,c){var f=""+Math.abs(e),E=t-f.length,R=e>=0;return(R?c?"+":"":"-")+Math.pow(10,Math.max(0,E)).toString().substr(1)+f}var Qi=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,gi=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Zi={},Ut={};function he(e,t,c,f){var E=f;typeof f=="string"&&(E=function(){return this[f]()}),e&&(Ut[e]=E),t&&(Ut[t[0]]=function(){return ct(E.apply(this,arguments),t[1],t[2])}),c&&(Ut[c]=function(){return this.localeData().ordinal(E.apply(this,arguments),e)})}function qn(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function zn(e){var t=e.match(Qi),c,f;for(c=0,f=t.length;c<f;c++)Ut[t[c]]?t[c]=Ut[t[c]]:t[c]=qn(t[c]);return function(E){var R="",L;for(L=0;L<f;L++)R+=lt(t[L])?t[L].call(E,e):t[L];return R}}function pi(e,t){return e.isValid()?(t=Ys(t,e.localeData()),Zi[t]=Zi[t]||zn(t),Zi[t](e)):e.localeData().invalidDate()}function Ys(e,t){var c=5;function f(E){return t.longDateFormat(E)||E}for(gi.lastIndex=0;c>=0&&gi.test(e);)e=e.replace(gi,f),gi.lastIndex=0,c-=1;return e}var Vn={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Kn(e){var t=this._longDateFormat[e],c=this._longDateFormat[e.toUpperCase()];return t||!c?t:(this._longDateFormat[e]=c.match(Qi).map(function(f){return f==="MMMM"||f==="MM"||f==="DD"||f==="dddd"?f.slice(1):f}).join(""),this._longDateFormat[e])}var Gn="Invalid date";function Jn(){return this._invalidDate}var Xn="%d",Qn=/\d{1,2}/;function Zn(e){return this._ordinal.replace("%d",e)}var eo={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function to(e,t,c,f){var E=this._relativeTime[c];return lt(E)?E(e,t,c,f):E.replace(/%d/i,e)}function io(e,t){var c=this._relativeTime[e>0?"future":"past"];return lt(c)?c(t):c.replace(/%s/i,t)}var qs={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Qe(e){return typeof e=="string"?qs[e]||qs[e.toLowerCase()]:void 0}function es(e){var t={},c,f;for(f in e)be(e,f)&&(c=Qe(f),c&&(t[c]=e[f]));return t}var so={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function ro(e){var t=[],c;for(c in e)be(e,c)&&t.push({unit:c,priority:so[c]});return t.sort(function(f,E){return f.priority-E.priority}),t}var zs=/\d/,Je=/\d\d/,Vs=/\d{3}/,ts=/\d{4}/,mi=/[+-]?\d{6}/,xe=/\d\d?/,Ks=/\d\d\d\d?/,Gs=/\d\d\d\d\d\d?/,yi=/\d{1,3}/,is=/\d{1,4}/,Si=/[+-]?\d{1,6}/,Ft=/\d+/,wi=/[+-]?\d+/,no=/Z|[+-]\d\d:?\d\d/gi,bi=/Z|[+-]\d\d(?::?\d\d)?/gi,oo=/[+-]?\d+(\.\d{1,3})?/,ti=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Wt=/^[1-9]\d?/,ss=/^([1-9]\d|\d)/,Ci;Ci={};function oe(e,t,c){Ci[e]=lt(t)?t:function(f,E){return f&&c?c:t}}function ao(e,t){return be(Ci,e)?Ci[e](t._strict,t._locale):new RegExp(lo(e))}function lo(e){return mt(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,c,f,E,R){return c||f||E||R}))}function mt(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ze(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function ye(e){var t=+e,c=0;return t!==0&&isFinite(t)&&(c=Ze(t)),c}var rs={};function ke(e,t){var c,f=t,E;for(typeof e=="string"&&(e=[e]),pt(t)&&(f=function(R,L){L[t]=ye(R)}),E=e.length,c=0;c<E;c++)rs[e[c]]=f}function ii(e,t){ke(e,function(c,f,E,R){E._w=E._w||{},t(c,E._w,E,R)})}function co(e,t,c){t!=null&&be(rs,e)&&rs[e](t,c._a,c,e)}function Ei(e){return e%4===0&&e%100!==0||e%400===0}var ze=0,yt=1,ht=2,We=3,it=4,St=5,Bt=6,ho=7,uo=8;he("Y",0,0,function(){var e=this.year();return e<=9999?ct(e,4):"+"+e}),he(0,["YY",2],0,function(){return this.year()%100}),he(0,["YYYY",4],0,"year"),he(0,["YYYYY",5],0,"year"),he(0,["YYYYYY",6,!0],0,"year"),oe("Y",wi),oe("YY",xe,Je),oe("YYYY",is,ts),oe("YYYYY",Si,mi),oe("YYYYYY",Si,mi),ke(["YYYYY","YYYYYY"],ze),ke("YYYY",function(e,t){t[ze]=e.length===2?ne.parseTwoDigitYear(e):ye(e)}),ke("YY",function(e,t){t[ze]=ne.parseTwoDigitYear(e)}),ke("Y",function(e,t){t[ze]=parseInt(e,10)});function si(e){return Ei(e)?366:365}ne.parseTwoDigitYear=function(e){return ye(e)+(ye(e)>68?1900:2e3)};var Js=jt("FullYear",!0);function _o(){return Ei(this.year())}function jt(e,t){return function(c){return c!=null?(Xs(this,e,c),ne.updateOffset(this,t),this):ri(this,e)}}function ri(e,t){if(!e.isValid())return NaN;var c=e._d,f=e._isUTC;switch(t){case"Milliseconds":return f?c.getUTCMilliseconds():c.getMilliseconds();case"Seconds":return f?c.getUTCSeconds():c.getSeconds();case"Minutes":return f?c.getUTCMinutes():c.getMinutes();case"Hours":return f?c.getUTCHours():c.getHours();case"Date":return f?c.getUTCDate():c.getDate();case"Day":return f?c.getUTCDay():c.getDay();case"Month":return f?c.getUTCMonth():c.getMonth();case"FullYear":return f?c.getUTCFullYear():c.getFullYear();default:return NaN}}function Xs(e,t,c){var f,E,R,L,o;if(!(!e.isValid()||isNaN(c))){switch(f=e._d,E=e._isUTC,t){case"Milliseconds":return void(E?f.setUTCMilliseconds(c):f.setMilliseconds(c));case"Seconds":return void(E?f.setUTCSeconds(c):f.setSeconds(c));case"Minutes":return void(E?f.setUTCMinutes(c):f.setMinutes(c));case"Hours":return void(E?f.setUTCHours(c):f.setHours(c));case"Date":return void(E?f.setUTCDate(c):f.setDate(c));case"FullYear":break;default:return}R=c,L=e.month(),o=e.date(),o=o===29&&L===1&&!Ei(R)?28:o,E?f.setUTCFullYear(R,L,o):f.setFullYear(R,L,o)}}function fo(e){return e=Qe(e),lt(this[e])?this[e]():this}function vo(e,t){if(typeof e=="object"){e=es(e);var c=ro(e),f,E=c.length;for(f=0;f<E;f++)this[c[f].unit](e[c[f].unit])}else if(e=Qe(e),lt(this[e]))return this[e](t);return this}function go(e,t){return(e%t+t)%t}var Ie;Array.prototype.indexOf?Ie=Array.prototype.indexOf:Ie=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function ns(e,t){if(isNaN(e)||isNaN(t))return NaN;var c=go(t,12);return e+=(t-c)/12,c===1?Ei(e)?29:28:31-c%7%2}he("M",["MM",2],"Mo",function(){return this.month()+1}),he("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),he("MMMM",0,0,function(e){return this.localeData().months(this,e)}),oe("M",xe,Wt),oe("MM",xe,Je),oe("MMM",function(e,t){return t.monthsShortRegex(e)}),oe("MMMM",function(e,t){return t.monthsRegex(e)}),ke(["M","MM"],function(e,t){t[yt]=ye(e)-1}),ke(["MMM","MMMM"],function(e,t,c,f){var E=c._locale.monthsParse(e,f,c._strict);E!=null?t[yt]=E:fe(c).invalidMonth=e});var po="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Qs="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Zs=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,mo=ti,yo=ti;function So(e,t){return e?et(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Zs).test(t)?"format":"standalone"][e.month()]:et(this._months)?this._months:this._months.standalone}function wo(e,t){return e?et(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Zs.test(t)?"format":"standalone"][e.month()]:et(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function bo(e,t,c){var f,E,R,L=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],f=0;f<12;++f)R=at([2e3,f]),this._shortMonthsParse[f]=this.monthsShort(R,"").toLocaleLowerCase(),this._longMonthsParse[f]=this.months(R,"").toLocaleLowerCase();return c?t==="MMM"?(E=Ie.call(this._shortMonthsParse,L),E!==-1?E:null):(E=Ie.call(this._longMonthsParse,L),E!==-1?E:null):t==="MMM"?(E=Ie.call(this._shortMonthsParse,L),E!==-1?E:(E=Ie.call(this._longMonthsParse,L),E!==-1?E:null)):(E=Ie.call(this._longMonthsParse,L),E!==-1?E:(E=Ie.call(this._shortMonthsParse,L),E!==-1?E:null))}function Co(e,t,c){var f,E,R;if(this._monthsParseExact)return bo.call(this,e,t,c);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),f=0;f<12;f++)if(E=at([2e3,f]),c&&!this._longMonthsParse[f]&&(this._longMonthsParse[f]=new RegExp("^"+this.months(E,"").replace(".","")+"$","i"),this._shortMonthsParse[f]=new RegExp("^"+this.monthsShort(E,"").replace(".","")+"$","i")),!c&&!this._monthsParse[f]&&(R="^"+this.months(E,"")+"|^"+this.monthsShort(E,""),this._monthsParse[f]=new RegExp(R.replace(".",""),"i")),c&&t==="MMMM"&&this._longMonthsParse[f].test(e)||c&&t==="MMM"&&this._shortMonthsParse[f].test(e)||!c&&this._monthsParse[f].test(e))return f}function er(e,t){if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=ye(t);else if(t=e.localeData().monthsParse(t),!pt(t))return e}var c=t,f=e.date();return f=f<29?f:Math.min(f,ns(e.year(),c)),e._isUTC?e._d.setUTCMonth(c,f):e._d.setMonth(c,f),e}function tr(e){return e!=null?(er(this,e),ne.updateOffset(this,!0),this):ri(this,"Month")}function Eo(){return ns(this.year(),this.month())}function ko(e){return this._monthsParseExact?(be(this,"_monthsRegex")||ir.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(be(this,"_monthsShortRegex")||(this._monthsShortRegex=mo),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function Do(e){return this._monthsParseExact?(be(this,"_monthsRegex")||ir.call(this),e?this._monthsStrictRegex:this._monthsRegex):(be(this,"_monthsRegex")||(this._monthsRegex=yo),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function ir(){function e(l,h){return h.length-l.length}var t=[],c=[],f=[],E,R,L,o;for(E=0;E<12;E++)R=at([2e3,E]),L=mt(this.monthsShort(R,"")),o=mt(this.months(R,"")),t.push(L),c.push(o),f.push(o),f.push(L);t.sort(e),c.sort(e),f.sort(e),this._monthsRegex=new RegExp("^("+f.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+c.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Mo(e,t,c,f,E,R,L){var o;return e<100&&e>=0?(o=new Date(e+400,t,c,f,E,R,L),isFinite(o.getFullYear())&&o.setFullYear(e)):o=new Date(e,t,c,f,E,R,L),o}function ni(e){var t,c;return e<100&&e>=0?(c=Array.prototype.slice.call(arguments),c[0]=e+400,t=new Date(Date.UTC.apply(null,c)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function ki(e,t,c){var f=7+t-c,E=(7+ni(e,0,f).getUTCDay()-t)%7;return-E+f-1}function sr(e,t,c,f,E){var R=(7+c-f)%7,L=ki(e,f,E),o=1+7*(t-1)+R+L,l,h;return o<=0?(l=e-1,h=si(l)+o):o>si(e)?(l=e+1,h=o-si(e)):(l=e,h=o),{year:l,dayOfYear:h}}function oi(e,t,c){var f=ki(e.year(),t,c),E=Math.floor((e.dayOfYear()-f-1)/7)+1,R,L;return E<1?(L=e.year()-1,R=E+wt(L,t,c)):E>wt(e.year(),t,c)?(R=E-wt(e.year(),t,c),L=e.year()+1):(L=e.year(),R=E),{week:R,year:L}}function wt(e,t,c){var f=ki(e,t,c),E=ki(e+1,t,c);return(si(e)-f+E)/7}he("w",["ww",2],"wo","week"),he("W",["WW",2],"Wo","isoWeek"),oe("w",xe,Wt),oe("ww",xe,Je),oe("W",xe,Wt),oe("WW",xe,Je),ii(["w","ww","W","WW"],function(e,t,c,f){t[f.substr(0,1)]=ye(e)});function Ao(e){return oi(e,this._week.dow,this._week.doy).week}var xo={dow:0,doy:6};function Ro(){return this._week.dow}function Lo(){return this._week.doy}function To(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Oo(e){var t=oi(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}he("d",0,"do","day"),he("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),he("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),he("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),he("e",0,0,"weekday"),he("E",0,0,"isoWeekday"),oe("d",xe),oe("e",xe),oe("E",xe),oe("dd",function(e,t){return t.weekdaysMinRegex(e)}),oe("ddd",function(e,t){return t.weekdaysShortRegex(e)}),oe("dddd",function(e,t){return t.weekdaysRegex(e)}),ii(["dd","ddd","dddd"],function(e,t,c,f){var E=c._locale.weekdaysParse(e,f,c._strict);E!=null?t.d=E:fe(c).invalidWeekday=e}),ii(["d","e","E"],function(e,t,c,f){t[f]=ye(e)});function Io(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function Po(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function os(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Bo="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),rr="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),No="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ho=ti,Uo=ti,Fo=ti;function Wo(e,t){var c=et(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?os(c,this._week.dow):e?c[e.day()]:c}function $o(e){return e===!0?os(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function jo(e){return e===!0?os(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Yo(e,t,c){var f,E,R,L=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],f=0;f<7;++f)R=at([2e3,1]).day(f),this._minWeekdaysParse[f]=this.weekdaysMin(R,"").toLocaleLowerCase(),this._shortWeekdaysParse[f]=this.weekdaysShort(R,"").toLocaleLowerCase(),this._weekdaysParse[f]=this.weekdays(R,"").toLocaleLowerCase();return c?t==="dddd"?(E=Ie.call(this._weekdaysParse,L),E!==-1?E:null):t==="ddd"?(E=Ie.call(this._shortWeekdaysParse,L),E!==-1?E:null):(E=Ie.call(this._minWeekdaysParse,L),E!==-1?E:null):t==="dddd"?(E=Ie.call(this._weekdaysParse,L),E!==-1||(E=Ie.call(this._shortWeekdaysParse,L),E!==-1)?E:(E=Ie.call(this._minWeekdaysParse,L),E!==-1?E:null)):t==="ddd"?(E=Ie.call(this._shortWeekdaysParse,L),E!==-1||(E=Ie.call(this._weekdaysParse,L),E!==-1)?E:(E=Ie.call(this._minWeekdaysParse,L),E!==-1?E:null)):(E=Ie.call(this._minWeekdaysParse,L),E!==-1||(E=Ie.call(this._weekdaysParse,L),E!==-1)?E:(E=Ie.call(this._shortWeekdaysParse,L),E!==-1?E:null))}function qo(e,t,c){var f,E,R;if(this._weekdaysParseExact)return Yo.call(this,e,t,c);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),f=0;f<7;f++)if(E=at([2e3,1]).day(f),c&&!this._fullWeekdaysParse[f]&&(this._fullWeekdaysParse[f]=new RegExp("^"+this.weekdays(E,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[f]=new RegExp("^"+this.weekdaysShort(E,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[f]=new RegExp("^"+this.weekdaysMin(E,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[f]||(R="^"+this.weekdays(E,"")+"|^"+this.weekdaysShort(E,"")+"|^"+this.weekdaysMin(E,""),this._weekdaysParse[f]=new RegExp(R.replace(".",""),"i")),c&&t==="dddd"&&this._fullWeekdaysParse[f].test(e)||c&&t==="ddd"&&this._shortWeekdaysParse[f].test(e)||c&&t==="dd"&&this._minWeekdaysParse[f].test(e)||!c&&this._weekdaysParse[f].test(e))return f}function zo(e){if(!this.isValid())return e!=null?this:NaN;var t=ri(this,"Day");return e!=null?(e=Io(e,this.localeData()),this.add(e-t,"d")):t}function Vo(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Ko(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=Po(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function Go(e){return this._weekdaysParseExact?(be(this,"_weekdaysRegex")||as.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(be(this,"_weekdaysRegex")||(this._weekdaysRegex=Ho),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Jo(e){return this._weekdaysParseExact?(be(this,"_weekdaysRegex")||as.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(be(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Uo),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Xo(e){return this._weekdaysParseExact?(be(this,"_weekdaysRegex")||as.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(be(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Fo),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function as(){function e(S,a){return a.length-S.length}var t=[],c=[],f=[],E=[],R,L,o,l,h;for(R=0;R<7;R++)L=at([2e3,1]).day(R),o=mt(this.weekdaysMin(L,"")),l=mt(this.weekdaysShort(L,"")),h=mt(this.weekdays(L,"")),t.push(o),c.push(l),f.push(h),E.push(o),E.push(l),E.push(h);t.sort(e),c.sort(e),f.sort(e),E.sort(e),this._weekdaysRegex=new RegExp("^("+E.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+f.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function ls(){return this.hours()%12||12}function Qo(){return this.hours()||24}he("H",["HH",2],0,"hour"),he("h",["hh",2],0,ls),he("k",["kk",2],0,Qo),he("hmm",0,0,function(){return""+ls.apply(this)+ct(this.minutes(),2)}),he("hmmss",0,0,function(){return""+ls.apply(this)+ct(this.minutes(),2)+ct(this.seconds(),2)}),he("Hmm",0,0,function(){return""+this.hours()+ct(this.minutes(),2)}),he("Hmmss",0,0,function(){return""+this.hours()+ct(this.minutes(),2)+ct(this.seconds(),2)});function nr(e,t){he(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}nr("a",!0),nr("A",!1);function or(e,t){return t._meridiemParse}oe("a",or),oe("A",or),oe("H",xe,ss),oe("h",xe,Wt),oe("k",xe,Wt),oe("HH",xe,Je),oe("hh",xe,Je),oe("kk",xe,Je),oe("hmm",Ks),oe("hmmss",Gs),oe("Hmm",Ks),oe("Hmmss",Gs),ke(["H","HH"],We),ke(["k","kk"],function(e,t,c){var f=ye(e);t[We]=f===24?0:f}),ke(["a","A"],function(e,t,c){c._isPm=c._locale.isPM(e),c._meridiem=e}),ke(["h","hh"],function(e,t,c){t[We]=ye(e),fe(c).bigHour=!0}),ke("hmm",function(e,t,c){var f=e.length-2;t[We]=ye(e.substr(0,f)),t[it]=ye(e.substr(f)),fe(c).bigHour=!0}),ke("hmmss",function(e,t,c){var f=e.length-4,E=e.length-2;t[We]=ye(e.substr(0,f)),t[it]=ye(e.substr(f,2)),t[St]=ye(e.substr(E)),fe(c).bigHour=!0}),ke("Hmm",function(e,t,c){var f=e.length-2;t[We]=ye(e.substr(0,f)),t[it]=ye(e.substr(f))}),ke("Hmmss",function(e,t,c){var f=e.length-4,E=e.length-2;t[We]=ye(e.substr(0,f)),t[it]=ye(e.substr(f,2)),t[St]=ye(e.substr(E))});function Zo(e){return(e+"").toLowerCase().charAt(0)==="p"}var ea=/[ap]\.?m?\.?/i,ta=jt("Hours",!0);function ia(e,t,c){return e>11?c?"pm":"PM":c?"am":"AM"}var ar={calendar:jn,longDateFormat:Vn,invalidDate:Gn,ordinal:Xn,dayOfMonthOrdinalParse:Qn,relativeTime:eo,months:po,monthsShort:Qs,week:xo,weekdays:Bo,weekdaysMin:No,weekdaysShort:rr,meridiemParse:ea},Le={},ai={},li;function sa(e,t){var c,f=Math.min(e.length,t.length);for(c=0;c<f;c+=1)if(e[c]!==t[c])return c;return f}function lr(e){return e&&e.toLowerCase().replace("_","-")}function ra(e){for(var t=0,c,f,E,R;t<e.length;){for(R=lr(e[t]).split("-"),c=R.length,f=lr(e[t+1]),f=f?f.split("-"):null;c>0;){if(E=Di(R.slice(0,c).join("-")),E)return E;if(f&&f.length>=c&&sa(R,f)>=c-1)break;c--}t++}return li}function na(e){return!!(e&&e.match("^[^/\\\\]*$"))}function Di(e){var t=null,c;if(Le[e]===void 0&&typeof module<"u"&&module&&module.exports&&na(e))try{t=li._abbr,c=require,c("./locale/"+e),Rt(t)}catch{Le[e]=null}return Le[e]}function Rt(e,t){var c;return e&&(Ke(t)?c=bt(e):c=cs(e,t),c?li=c:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),li._abbr}function cs(e,t){if(t!==null){var c,f=ar;if(t.abbr=e,Le[e]!=null)js("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),f=Le[e]._config;else if(t.parentLocale!=null)if(Le[t.parentLocale]!=null)f=Le[t.parentLocale]._config;else if(c=Di(t.parentLocale),c!=null)f=c._config;else return ai[t.parentLocale]||(ai[t.parentLocale]=[]),ai[t.parentLocale].push({name:e,config:t}),null;return Le[e]=new Ji(Gi(f,t)),ai[e]&&ai[e].forEach(function(E){cs(E.name,E.config)}),Rt(e),Le[e]}else return delete Le[e],null}function oa(e,t){if(t!=null){var c,f,E=ar;Le[e]!=null&&Le[e].parentLocale!=null?Le[e].set(Gi(Le[e]._config,t)):(f=Di(e),f!=null&&(E=f._config),t=Gi(E,t),f==null&&(t.abbr=e),c=new Ji(t),c.parentLocale=Le[e],Le[e]=c),Rt(e)}else Le[e]!=null&&(Le[e].parentLocale!=null?(Le[e]=Le[e].parentLocale,e===Rt()&&Rt(e)):Le[e]!=null&&delete Le[e]);return Le[e]}function bt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return li;if(!et(e)){if(t=Di(e),t)return t;e=[e]}return ra(e)}function aa(){return Xi(Le)}function hs(e){var t,c=e._a;return c&&fe(e).overflow===-2&&(t=c[yt]<0||c[yt]>11?yt:c[ht]<1||c[ht]>ns(c[ze],c[yt])?ht:c[We]<0||c[We]>24||c[We]===24&&(c[it]!==0||c[St]!==0||c[Bt]!==0)?We:c[it]<0||c[it]>59?it:c[St]<0||c[St]>59?St:c[Bt]<0||c[Bt]>999?Bt:-1,fe(e)._overflowDayOfYear&&(t<ze||t>ht)&&(t=ht),fe(e)._overflowWeeks&&t===-1&&(t=ho),fe(e)._overflowWeekday&&t===-1&&(t=uo),fe(e).overflow=t),e}var la=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ca=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ha=/Z|[+-]\d\d(?::?\d\d)?/,Mi=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],ds=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],da=/^\/?Date\((-?\d+)/i,ua=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,_a={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function cr(e){var t,c,f=e._i,E=la.exec(f)||ca.exec(f),R,L,o,l,h=Mi.length,S=ds.length;if(E){for(fe(e).iso=!0,t=0,c=h;t<c;t++)if(Mi[t][1].exec(E[1])){L=Mi[t][0],R=Mi[t][2]!==!1;break}if(L==null){e._isValid=!1;return}if(E[3]){for(t=0,c=S;t<c;t++)if(ds[t][1].exec(E[3])){o=(E[2]||" ")+ds[t][0];break}if(o==null){e._isValid=!1;return}}if(!R&&o!=null){e._isValid=!1;return}if(E[4])if(ha.exec(E[4]))l="Z";else{e._isValid=!1;return}e._f=L+(o||"")+(l||""),_s(e)}else e._isValid=!1}function fa(e,t,c,f,E,R){var L=[va(e),Qs.indexOf(t),parseInt(c,10),parseInt(f,10),parseInt(E,10)];return R&&L.push(parseInt(R,10)),L}function va(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function ga(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function pa(e,t,c){if(e){var f=rr.indexOf(e),E=new Date(t[0],t[1],t[2]).getDay();if(f!==E)return fe(c).weekdayMismatch=!0,c._isValid=!1,!1}return!0}function ma(e,t,c){if(e)return _a[e];if(t)return 0;var f=parseInt(c,10),E=f%100,R=(f-E)/100;return R*60+E}function hr(e){var t=ua.exec(ga(e._i)),c;if(t){if(c=fa(t[4],t[3],t[2],t[5],t[6],t[7]),!pa(t[1],c,e))return;e._a=c,e._tzm=ma(t[8],t[9],t[10]),e._d=ni.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),fe(e).rfc2822=!0}else e._isValid=!1}function ya(e){var t=da.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(cr(e),e._isValid===!1)delete e._isValid;else return;if(hr(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:ne.createFromInputFallback(e)}ne.createFromInputFallback=Xe("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Yt(e,t,c){return e??t??c}function Sa(e){var t=new Date(ne.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function us(e){var t,c,f=[],E,R,L;if(!e._d){for(E=Sa(e),e._w&&e._a[ht]==null&&e._a[yt]==null&&wa(e),e._dayOfYear!=null&&(L=Yt(e._a[ze],E[ze]),(e._dayOfYear>si(L)||e._dayOfYear===0)&&(fe(e)._overflowDayOfYear=!0),c=ni(L,0,e._dayOfYear),e._a[yt]=c.getUTCMonth(),e._a[ht]=c.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=f[t]=E[t];for(;t<7;t++)e._a[t]=f[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[We]===24&&e._a[it]===0&&e._a[St]===0&&e._a[Bt]===0&&(e._nextDay=!0,e._a[We]=0),e._d=(e._useUTC?ni:Mo).apply(null,f),R=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[We]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==R&&(fe(e).weekdayMismatch=!0)}}function wa(e){var t,c,f,E,R,L,o,l,h;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(R=1,L=4,c=Yt(t.GG,e._a[ze],oi(Re(),1,4).year),f=Yt(t.W,1),E=Yt(t.E,1),(E<1||E>7)&&(l=!0)):(R=e._locale._week.dow,L=e._locale._week.doy,h=oi(Re(),R,L),c=Yt(t.gg,e._a[ze],h.year),f=Yt(t.w,h.week),t.d!=null?(E=t.d,(E<0||E>6)&&(l=!0)):t.e!=null?(E=t.e+R,(t.e<0||t.e>6)&&(l=!0)):E=R),f<1||f>wt(c,R,L)?fe(e)._overflowWeeks=!0:l!=null?fe(e)._overflowWeekday=!0:(o=sr(c,f,E,R,L),e._a[ze]=o.year,e._dayOfYear=o.dayOfYear)}ne.ISO_8601=function(){},ne.RFC_2822=function(){};function _s(e){if(e._f===ne.ISO_8601){cr(e);return}if(e._f===ne.RFC_2822){hr(e);return}e._a=[],fe(e).empty=!0;var t=""+e._i,c,f,E,R,L,o=t.length,l=0,h,S;for(E=Ys(e._f,e._locale).match(Qi)||[],S=E.length,c=0;c<S;c++)R=E[c],f=(t.match(ao(R,e))||[])[0],f&&(L=t.substr(0,t.indexOf(f)),L.length>0&&fe(e).unusedInput.push(L),t=t.slice(t.indexOf(f)+f.length),l+=f.length),Ut[R]?(f?fe(e).empty=!1:fe(e).unusedTokens.push(R),co(R,f,e)):e._strict&&!f&&fe(e).unusedTokens.push(R);fe(e).charsLeftOver=o-l,t.length>0&&fe(e).unusedInput.push(t),e._a[We]<=12&&fe(e).bigHour===!0&&e._a[We]>0&&(fe(e).bigHour=void 0),fe(e).parsedDateParts=e._a.slice(0),fe(e).meridiem=e._meridiem,e._a[We]=ba(e._locale,e._a[We],e._meridiem),h=fe(e).era,h!==null&&(e._a[ze]=e._locale.erasConvertYear(h,e._a[ze])),us(e),hs(e)}function ba(e,t,c){var f;return c==null?t:e.meridiemHour!=null?e.meridiemHour(t,c):(e.isPM!=null&&(f=e.isPM(c),f&&t<12&&(t+=12),!f&&t===12&&(t=0)),t)}function Ca(e){var t,c,f,E,R,L,o=!1,l=e._f.length;if(l===0){fe(e).invalidFormat=!0,e._d=new Date(NaN);return}for(E=0;E<l;E++)R=0,L=!1,t=Ki({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[E],_s(t),zi(t)&&(L=!0),R+=fe(t).charsLeftOver,R+=fe(t).unusedTokens.length*10,fe(t).score=R,o?R<f&&(f=R,c=t):(f==null||R<f||L)&&(f=R,c=t,L&&(o=!0));xt(e,c||t)}function Ea(e){if(!e._d){var t=es(e._i),c=t.day===void 0?t.date:t.day;e._a=Us([t.year,t.month,c,t.hour,t.minute,t.second,t.millisecond],function(f){return f&&parseInt(f,10)}),us(e)}}function ka(e){var t=new ei(hs(dr(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function dr(e){var t=e._i,c=e._f;return e._locale=e._locale||bt(e._l),t===null||c===void 0&&t===""?vi({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),tt(t)?new ei(hs(t)):(Zt(t)?e._d=t:et(c)?Ca(e):c?_s(e):Da(e),zi(e)||(e._d=null),e))}function Da(e){var t=e._i;Ke(t)?e._d=new Date(ne.now()):Zt(t)?e._d=new Date(t.valueOf()):typeof t=="string"?ya(e):et(t)?(e._a=Us(t.slice(0),function(c){return parseInt(c,10)}),us(e)):Pt(t)?Ea(e):pt(t)?e._d=new Date(t):ne.createFromInputFallback(e)}function ur(e,t,c,f,E){var R={};return(t===!0||t===!1)&&(f=t,t=void 0),(c===!0||c===!1)&&(f=c,c=void 0),(Pt(e)&&Yi(e)||et(e)&&e.length===0)&&(e=void 0),R._isAMomentObject=!0,R._useUTC=R._isUTC=E,R._l=c,R._i=e,R._f=t,R._strict=f,ka(R)}function Re(e,t,c,f){return ur(e,t,c,f,!1)}var Ma=Xe("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Re.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:vi()}),Aa=Xe("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Re.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:vi()});function _r(e,t){var c,f;if(t.length===1&&et(t[0])&&(t=t[0]),!t.length)return Re();for(c=t[0],f=1;f<t.length;++f)(!t[f].isValid()||t[f][e](c))&&(c=t[f]);return c}function xa(){var e=[].slice.call(arguments,0);return _r("isBefore",e)}function Ra(){var e=[].slice.call(arguments,0);return _r("isAfter",e)}var La=function(){return Date.now?Date.now():+new Date},ci=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Ta(e){var t,c=!1,f,E=ci.length;for(t in e)if(be(e,t)&&!(Ie.call(ci,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(f=0;f<E;++f)if(e[ci[f]]){if(c)return!1;parseFloat(e[ci[f]])!==ye(e[ci[f]])&&(c=!0)}return!0}function Oa(){return this._isValid}function Ia(){return st(NaN)}function Ai(e){var t=es(e),c=t.year||0,f=t.quarter||0,E=t.month||0,R=t.week||t.isoWeek||0,L=t.day||0,o=t.hour||0,l=t.minute||0,h=t.second||0,S=t.millisecond||0;this._isValid=Ta(t),this._milliseconds=+S+h*1e3+l*6e4+o*1e3*60*60,this._days=+L+R*7,this._months=+E+f*3+c*12,this._data={},this._locale=bt(),this._bubble()}function xi(e){return e instanceof Ai}function fs(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function Pa(e,t,c){var f=Math.min(e.length,t.length),E=Math.abs(e.length-t.length),R=0,L;for(L=0;L<f;L++)(c&&e[L]!==t[L]||!c&&ye(e[L])!==ye(t[L]))&&R++;return R+E}function fr(e,t){he(e,0,0,function(){var c=this.utcOffset(),f="+";return c<0&&(c=-c,f="-"),f+ct(~~(c/60),2)+t+ct(~~c%60,2)})}fr("Z",":"),fr("ZZ",""),oe("Z",bi),oe("ZZ",bi),ke(["Z","ZZ"],function(e,t,c){c._useUTC=!0,c._tzm=vs(bi,e)});var Ba=/([\+\-]|\d\d)/gi;function vs(e,t){var c=(t||"").match(e),f,E,R;return c===null?null:(f=c[c.length-1]||[],E=(f+"").match(Ba)||["-",0,0],R=+(E[1]*60)+ye(E[2]),R===0?0:E[0]==="+"?R:-R)}function gs(e,t){var c,f;return t._isUTC?(c=t.clone(),f=(tt(e)||Zt(e)?e.valueOf():Re(e).valueOf())-c.valueOf(),c._d.setTime(c._d.valueOf()+f),ne.updateOffset(c,!1),c):Re(e).local()}function ps(e){return-Math.round(e._d.getTimezoneOffset())}ne.updateOffset=function(){};function Na(e,t,c){var f=this._offset||0,E;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=vs(bi,e),e===null)return this}else Math.abs(e)<16&&!c&&(e=e*60);return!this._isUTC&&t&&(E=ps(this)),this._offset=e,this._isUTC=!0,E!=null&&this.add(E,"m"),f!==e&&(!t||this._changeInProgress?mr(this,st(e-f,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ne.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?f:ps(this)}function Ha(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Ua(e){return this.utcOffset(0,e)}function Fa(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(ps(this),"m")),this}function Wa(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=vs(no,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function $a(e){return this.isValid()?(e=e?Re(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function ja(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Ya(){if(!Ke(this._isDSTShifted))return this._isDSTShifted;var e={},t;return Ki(e,this),e=dr(e),e._a?(t=e._isUTC?at(e._a):Re(e._a),this._isDSTShifted=this.isValid()&&Pa(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function qa(){return this.isValid()?!this._isUTC:!1}function za(){return this.isValid()?this._isUTC:!1}function vr(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Va=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Ka=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function st(e,t){var c=e,f=null,E,R,L;return xi(e)?c={ms:e._milliseconds,d:e._days,M:e._months}:pt(e)||!isNaN(+e)?(c={},t?c[t]=+e:c.milliseconds=+e):(f=Va.exec(e))?(E=f[1]==="-"?-1:1,c={y:0,d:ye(f[ht])*E,h:ye(f[We])*E,m:ye(f[it])*E,s:ye(f[St])*E,ms:ye(fs(f[Bt]*1e3))*E}):(f=Ka.exec(e))?(E=f[1]==="-"?-1:1,c={y:Nt(f[2],E),M:Nt(f[3],E),w:Nt(f[4],E),d:Nt(f[5],E),h:Nt(f[6],E),m:Nt(f[7],E),s:Nt(f[8],E)}):c==null?c={}:typeof c=="object"&&("from"in c||"to"in c)&&(L=Ga(Re(c.from),Re(c.to)),c={},c.ms=L.milliseconds,c.M=L.months),R=new Ai(c),xi(e)&&be(e,"_locale")&&(R._locale=e._locale),xi(e)&&be(e,"_isValid")&&(R._isValid=e._isValid),R}st.fn=Ai.prototype,st.invalid=Ia;function Nt(e,t){var c=e&&parseFloat(e.replace(",","."));return(isNaN(c)?0:c)*t}function gr(e,t){var c={};return c.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(c.months,"M").isAfter(t)&&--c.months,c.milliseconds=+t-+e.clone().add(c.months,"M"),c}function Ga(e,t){var c;return e.isValid()&&t.isValid()?(t=gs(t,e),e.isBefore(t)?c=gr(e,t):(c=gr(t,e),c.milliseconds=-c.milliseconds,c.months=-c.months),c):{milliseconds:0,months:0}}function pr(e,t){return function(c,f){var E,R;return f!==null&&!isNaN(+f)&&(js(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),R=c,c=f,f=R),E=st(c,f),mr(this,E,e),this}}function mr(e,t,c,f){var E=t._milliseconds,R=fs(t._days),L=fs(t._months);e.isValid()&&(f=f??!0,L&&er(e,ri(e,"Month")+L*c),R&&Xs(e,"Date",ri(e,"Date")+R*c),E&&e._d.setTime(e._d.valueOf()+E*c),f&&ne.updateOffset(e,R||L))}var Ja=pr(1,"add"),Xa=pr(-1,"subtract");function yr(e){return typeof e=="string"||e instanceof String}function Qa(e){return tt(e)||Zt(e)||yr(e)||pt(e)||el(e)||Za(e)||e===null||e===void 0}function Za(e){var t=Pt(e)&&!Yi(e),c=!1,f=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],E,R,L=f.length;for(E=0;E<L;E+=1)R=f[E],c=c||be(e,R);return t&&c}function el(e){var t=et(e),c=!1;return t&&(c=e.filter(function(f){return!pt(f)&&yr(e)}).length===0),t&&c}function tl(e){var t=Pt(e)&&!Yi(e),c=!1,f=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],E,R;for(E=0;E<f.length;E+=1)R=f[E],c=c||be(e,R);return t&&c}function il(e,t){var c=e.diff(t,"days",!0);return c<-6?"sameElse":c<-1?"lastWeek":c<0?"lastDay":c<1?"sameDay":c<2?"nextDay":c<7?"nextWeek":"sameElse"}function sl(e,t){arguments.length===1&&(arguments[0]?Qa(arguments[0])?(e=arguments[0],t=void 0):tl(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var c=e||Re(),f=gs(c,this).startOf("day"),E=ne.calendarFormat(this,f)||"sameElse",R=t&&(lt(t[E])?t[E].call(this,c):t[E]);return this.format(R||this.localeData().calendar(E,this,Re(c)))}function rl(){return new ei(this)}function nl(e,t){var c=tt(e)?e:Re(e);return this.isValid()&&c.isValid()?(t=Qe(t)||"millisecond",t==="millisecond"?this.valueOf()>c.valueOf():c.valueOf()<this.clone().startOf(t).valueOf()):!1}function ol(e,t){var c=tt(e)?e:Re(e);return this.isValid()&&c.isValid()?(t=Qe(t)||"millisecond",t==="millisecond"?this.valueOf()<c.valueOf():this.clone().endOf(t).valueOf()<c.valueOf()):!1}function al(e,t,c,f){var E=tt(e)?e:Re(e),R=tt(t)?t:Re(t);return this.isValid()&&E.isValid()&&R.isValid()?(f=f||"()",(f[0]==="("?this.isAfter(E,c):!this.isBefore(E,c))&&(f[1]===")"?this.isBefore(R,c):!this.isAfter(R,c))):!1}function ll(e,t){var c=tt(e)?e:Re(e),f;return this.isValid()&&c.isValid()?(t=Qe(t)||"millisecond",t==="millisecond"?this.valueOf()===c.valueOf():(f=c.valueOf(),this.clone().startOf(t).valueOf()<=f&&f<=this.clone().endOf(t).valueOf())):!1}function cl(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function hl(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function dl(e,t,c){var f,E,R;if(!this.isValid())return NaN;if(f=gs(e,this),!f.isValid())return NaN;switch(E=(f.utcOffset()-this.utcOffset())*6e4,t=Qe(t),t){case"year":R=Ri(this,f)/12;break;case"month":R=Ri(this,f);break;case"quarter":R=Ri(this,f)/3;break;case"second":R=(this-f)/1e3;break;case"minute":R=(this-f)/6e4;break;case"hour":R=(this-f)/36e5;break;case"day":R=(this-f-E)/864e5;break;case"week":R=(this-f-E)/6048e5;break;default:R=this-f}return c?R:Ze(R)}function Ri(e,t){if(e.date()<t.date())return-Ri(t,e);var c=(t.year()-e.year())*12+(t.month()-e.month()),f=e.clone().add(c,"months"),E,R;return t-f<0?(E=e.clone().add(c-1,"months"),R=(t-f)/(f-E)):(E=e.clone().add(c+1,"months"),R=(t-f)/(E-f)),-(c+R)||0}ne.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",ne.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function ul(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function _l(e){if(!this.isValid())return null;var t=e!==!0,c=t?this.clone().utc():this;return c.year()<0||c.year()>9999?pi(c,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):lt(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",pi(c,"Z")):pi(c,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function fl(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",c,f,E,R;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),c="["+e+'("]',f=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",E="-MM-DD[T]HH:mm:ss.SSS",R=t+'[")]',this.format(c+f+E+R)}function vl(e){e||(e=this.isUtc()?ne.defaultFormatUtc:ne.defaultFormat);var t=pi(this,e);return this.localeData().postformat(t)}function gl(e,t){return this.isValid()&&(tt(e)&&e.isValid()||Re(e).isValid())?st({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function pl(e){return this.from(Re(),e)}function ml(e,t){return this.isValid()&&(tt(e)&&e.isValid()||Re(e).isValid())?st({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function yl(e){return this.to(Re(),e)}function Sr(e){var t;return e===void 0?this._locale._abbr:(t=bt(e),t!=null&&(this._locale=t),this)}var wr=Xe("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function br(){return this._locale}var Li=1e3,qt=60*Li,Ti=60*qt,Cr=(365*400+97)*24*Ti;function zt(e,t){return(e%t+t)%t}function Er(e,t,c){return e<100&&e>=0?new Date(e+400,t,c)-Cr:new Date(e,t,c).valueOf()}function kr(e,t,c){return e<100&&e>=0?Date.UTC(e+400,t,c)-Cr:Date.UTC(e,t,c)}function Sl(e){var t,c;if(e=Qe(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(c=this._isUTC?kr:Er,e){case"year":t=c(this.year(),0,1);break;case"quarter":t=c(this.year(),this.month()-this.month()%3,1);break;case"month":t=c(this.year(),this.month(),1);break;case"week":t=c(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=c(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=c(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=zt(t+(this._isUTC?0:this.utcOffset()*qt),Ti);break;case"minute":t=this._d.valueOf(),t-=zt(t,qt);break;case"second":t=this._d.valueOf(),t-=zt(t,Li);break}return this._d.setTime(t),ne.updateOffset(this,!0),this}function wl(e){var t,c;if(e=Qe(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(c=this._isUTC?kr:Er,e){case"year":t=c(this.year()+1,0,1)-1;break;case"quarter":t=c(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=c(this.year(),this.month()+1,1)-1;break;case"week":t=c(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=c(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=c(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=Ti-zt(t+(this._isUTC?0:this.utcOffset()*qt),Ti)-1;break;case"minute":t=this._d.valueOf(),t+=qt-zt(t,qt)-1;break;case"second":t=this._d.valueOf(),t+=Li-zt(t,Li)-1;break}return this._d.setTime(t),ne.updateOffset(this,!0),this}function bl(){return this._d.valueOf()-(this._offset||0)*6e4}function Cl(){return Math.floor(this.valueOf()/1e3)}function El(){return new Date(this.valueOf())}function kl(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Dl(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Ml(){return this.isValid()?this.toISOString():null}function Al(){return zi(this)}function xl(){return xt({},fe(this))}function Rl(){return fe(this).overflow}function Ll(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}he("N",0,0,"eraAbbr"),he("NN",0,0,"eraAbbr"),he("NNN",0,0,"eraAbbr"),he("NNNN",0,0,"eraName"),he("NNNNN",0,0,"eraNarrow"),he("y",["y",1],"yo","eraYear"),he("y",["yy",2],0,"eraYear"),he("y",["yyy",3],0,"eraYear"),he("y",["yyyy",4],0,"eraYear"),oe("N",ms),oe("NN",ms),oe("NNN",ms),oe("NNNN",$l),oe("NNNNN",jl),ke(["N","NN","NNN","NNNN","NNNNN"],function(e,t,c,f){var E=c._locale.erasParse(e,f,c._strict);E?fe(c).era=E:fe(c).invalidEra=e}),oe("y",Ft),oe("yy",Ft),oe("yyy",Ft),oe("yyyy",Ft),oe("yo",Yl),ke(["y","yy","yyy","yyyy"],ze),ke(["yo"],function(e,t,c,f){var E;c._locale._eraYearOrdinalRegex&&(E=e.match(c._locale._eraYearOrdinalRegex)),c._locale.eraYearOrdinalParse?t[ze]=c._locale.eraYearOrdinalParse(e,E):t[ze]=parseInt(e,10)});function Tl(e,t){var c,f,E,R=this._eras||bt("en")._eras;for(c=0,f=R.length;c<f;++c){switch(typeof R[c].since){case"string":E=ne(R[c].since).startOf("day"),R[c].since=E.valueOf();break}switch(typeof R[c].until){case"undefined":R[c].until=1/0;break;case"string":E=ne(R[c].until).startOf("day").valueOf(),R[c].until=E.valueOf();break}}return R}function Ol(e,t,c){var f,E,R=this.eras(),L,o,l;for(e=e.toUpperCase(),f=0,E=R.length;f<E;++f)if(L=R[f].name.toUpperCase(),o=R[f].abbr.toUpperCase(),l=R[f].narrow.toUpperCase(),c)switch(t){case"N":case"NN":case"NNN":if(o===e)return R[f];break;case"NNNN":if(L===e)return R[f];break;case"NNNNN":if(l===e)return R[f];break}else if([L,o,l].indexOf(e)>=0)return R[f]}function Il(e,t){var c=e.since<=e.until?1:-1;return t===void 0?ne(e.since).year():ne(e.since).year()+(t-e.offset)*c}function Pl(){var e,t,c,f=this.localeData().eras();for(e=0,t=f.length;e<t;++e)if(c=this.clone().startOf("day").valueOf(),f[e].since<=c&&c<=f[e].until||f[e].until<=c&&c<=f[e].since)return f[e].name;return""}function Bl(){var e,t,c,f=this.localeData().eras();for(e=0,t=f.length;e<t;++e)if(c=this.clone().startOf("day").valueOf(),f[e].since<=c&&c<=f[e].until||f[e].until<=c&&c<=f[e].since)return f[e].narrow;return""}function Nl(){var e,t,c,f=this.localeData().eras();for(e=0,t=f.length;e<t;++e)if(c=this.clone().startOf("day").valueOf(),f[e].since<=c&&c<=f[e].until||f[e].until<=c&&c<=f[e].since)return f[e].abbr;return""}function Hl(){var e,t,c,f,E=this.localeData().eras();for(e=0,t=E.length;e<t;++e)if(c=E[e].since<=E[e].until?1:-1,f=this.clone().startOf("day").valueOf(),E[e].since<=f&&f<=E[e].until||E[e].until<=f&&f<=E[e].since)return(this.year()-ne(E[e].since).year())*c+E[e].offset;return this.year()}function Ul(e){return be(this,"_erasNameRegex")||ys.call(this),e?this._erasNameRegex:this._erasRegex}function Fl(e){return be(this,"_erasAbbrRegex")||ys.call(this),e?this._erasAbbrRegex:this._erasRegex}function Wl(e){return be(this,"_erasNarrowRegex")||ys.call(this),e?this._erasNarrowRegex:this._erasRegex}function ms(e,t){return t.erasAbbrRegex(e)}function $l(e,t){return t.erasNameRegex(e)}function jl(e,t){return t.erasNarrowRegex(e)}function Yl(e,t){return t._eraYearOrdinalRegex||Ft}function ys(){var e=[],t=[],c=[],f=[],E,R,L,o,l,h=this.eras();for(E=0,R=h.length;E<R;++E)L=mt(h[E].name),o=mt(h[E].abbr),l=mt(h[E].narrow),t.push(L),e.push(o),c.push(l),f.push(L),f.push(o),f.push(l);this._erasRegex=new RegExp("^("+f.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+c.join("|")+")","i")}he(0,["gg",2],0,function(){return this.weekYear()%100}),he(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Oi(e,t){he(0,[e,e.length],0,t)}Oi("gggg","weekYear"),Oi("ggggg","weekYear"),Oi("GGGG","isoWeekYear"),Oi("GGGGG","isoWeekYear"),oe("G",wi),oe("g",wi),oe("GG",xe,Je),oe("gg",xe,Je),oe("GGGG",is,ts),oe("gggg",is,ts),oe("GGGGG",Si,mi),oe("ggggg",Si,mi),ii(["gggg","ggggg","GGGG","GGGGG"],function(e,t,c,f){t[f.substr(0,2)]=ye(e)}),ii(["gg","GG"],function(e,t,c,f){t[f]=ne.parseTwoDigitYear(e)});function ql(e){return Dr.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function zl(e){return Dr.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Vl(){return wt(this.year(),1,4)}function Kl(){return wt(this.isoWeekYear(),1,4)}function Gl(){var e=this.localeData()._week;return wt(this.year(),e.dow,e.doy)}function Jl(){var e=this.localeData()._week;return wt(this.weekYear(),e.dow,e.doy)}function Dr(e,t,c,f,E){var R;return e==null?oi(this,f,E).year:(R=wt(e,f,E),t>R&&(t=R),Xl.call(this,e,t,c,f,E))}function Xl(e,t,c,f,E){var R=sr(e,t,c,f,E),L=ni(R.year,0,R.dayOfYear);return this.year(L.getUTCFullYear()),this.month(L.getUTCMonth()),this.date(L.getUTCDate()),this}he("Q",0,"Qo","quarter"),oe("Q",zs),ke("Q",function(e,t){t[yt]=(ye(e)-1)*3});function Ql(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}he("D",["DD",2],"Do","date"),oe("D",xe,Wt),oe("DD",xe,Je),oe("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),ke(["D","DD"],ht),ke("Do",function(e,t){t[ht]=ye(e.match(xe)[0])});var Mr=jt("Date",!0);he("DDD",["DDDD",3],"DDDo","dayOfYear"),oe("DDD",yi),oe("DDDD",Vs),ke(["DDD","DDDD"],function(e,t,c){c._dayOfYear=ye(e)});function Zl(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}he("m",["mm",2],0,"minute"),oe("m",xe,ss),oe("mm",xe,Je),ke(["m","mm"],it);var ec=jt("Minutes",!1);he("s",["ss",2],0,"second"),oe("s",xe,ss),oe("ss",xe,Je),ke(["s","ss"],St);var tc=jt("Seconds",!1);he("S",0,0,function(){return~~(this.millisecond()/100)}),he(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),he(0,["SSS",3],0,"millisecond"),he(0,["SSSS",4],0,function(){return this.millisecond()*10}),he(0,["SSSSS",5],0,function(){return this.millisecond()*100}),he(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),he(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),he(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),he(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),oe("S",yi,zs),oe("SS",yi,Je),oe("SSS",yi,Vs);var Lt,Ar;for(Lt="SSSS";Lt.length<=9;Lt+="S")oe(Lt,Ft);function ic(e,t){t[Bt]=ye(("0."+e)*1e3)}for(Lt="S";Lt.length<=9;Lt+="S")ke(Lt,ic);Ar=jt("Milliseconds",!1),he("z",0,0,"zoneAbbr"),he("zz",0,0,"zoneName");function sc(){return this._isUTC?"UTC":""}function rc(){return this._isUTC?"Coordinated Universal Time":""}var te=ei.prototype;te.add=Ja,te.calendar=sl,te.clone=rl,te.diff=dl,te.endOf=wl,te.format=vl,te.from=gl,te.fromNow=pl,te.to=ml,te.toNow=yl,te.get=fo,te.invalidAt=Rl,te.isAfter=nl,te.isBefore=ol,te.isBetween=al,te.isSame=ll,te.isSameOrAfter=cl,te.isSameOrBefore=hl,te.isValid=Al,te.lang=wr,te.locale=Sr,te.localeData=br,te.max=Aa,te.min=Ma,te.parsingFlags=xl,te.set=vo,te.startOf=Sl,te.subtract=Xa,te.toArray=kl,te.toObject=Dl,te.toDate=El,te.toISOString=_l,te.inspect=fl,typeof Symbol<"u"&&Symbol.for!=null&&(te[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),te.toJSON=Ml,te.toString=ul,te.unix=Cl,te.valueOf=bl,te.creationData=Ll,te.eraName=Pl,te.eraNarrow=Bl,te.eraAbbr=Nl,te.eraYear=Hl,te.year=Js,te.isLeapYear=_o,te.weekYear=ql,te.isoWeekYear=zl,te.quarter=te.quarters=Ql,te.month=tr,te.daysInMonth=Eo,te.week=te.weeks=To,te.isoWeek=te.isoWeeks=Oo,te.weeksInYear=Gl,te.weeksInWeekYear=Jl,te.isoWeeksInYear=Vl,te.isoWeeksInISOWeekYear=Kl,te.date=Mr,te.day=te.days=zo,te.weekday=Vo,te.isoWeekday=Ko,te.dayOfYear=Zl,te.hour=te.hours=ta,te.minute=te.minutes=ec,te.second=te.seconds=tc,te.millisecond=te.milliseconds=Ar,te.utcOffset=Na,te.utc=Ua,te.local=Fa,te.parseZone=Wa,te.hasAlignedHourOffset=$a,te.isDST=ja,te.isLocal=qa,te.isUtcOffset=za,te.isUtc=vr,te.isUTC=vr,te.zoneAbbr=sc,te.zoneName=rc,te.dates=Xe("dates accessor is deprecated. Use date instead.",Mr),te.months=Xe("months accessor is deprecated. Use month instead",tr),te.years=Xe("years accessor is deprecated. Use year instead",Js),te.zone=Xe("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Ha),te.isDSTShifted=Xe("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Ya);function nc(e){return Re(e*1e3)}function oc(){return Re.apply(null,arguments).parseZone()}function xr(e){return e}var Ce=Ji.prototype;Ce.calendar=Yn,Ce.longDateFormat=Kn,Ce.invalidDate=Jn,Ce.ordinal=Zn,Ce.preparse=xr,Ce.postformat=xr,Ce.relativeTime=to,Ce.pastFuture=io,Ce.set=$n,Ce.eras=Tl,Ce.erasParse=Ol,Ce.erasConvertYear=Il,Ce.erasAbbrRegex=Fl,Ce.erasNameRegex=Ul,Ce.erasNarrowRegex=Wl,Ce.months=So,Ce.monthsShort=wo,Ce.monthsParse=Co,Ce.monthsRegex=Do,Ce.monthsShortRegex=ko,Ce.week=Ao,Ce.firstDayOfYear=Lo,Ce.firstDayOfWeek=Ro,Ce.weekdays=Wo,Ce.weekdaysMin=jo,Ce.weekdaysShort=$o,Ce.weekdaysParse=qo,Ce.weekdaysRegex=Go,Ce.weekdaysShortRegex=Jo,Ce.weekdaysMinRegex=Xo,Ce.isPM=Zo,Ce.meridiem=ia;function Ii(e,t,c,f){var E=bt(),R=at().set(f,t);return E[c](R,e)}function Rr(e,t,c){if(pt(e)&&(t=e,e=void 0),e=e||"",t!=null)return Ii(e,t,c,"month");var f,E=[];for(f=0;f<12;f++)E[f]=Ii(e,f,c,"month");return E}function Ss(e,t,c,f){typeof e=="boolean"?(pt(t)&&(c=t,t=void 0),t=t||""):(t=e,c=t,e=!1,pt(t)&&(c=t,t=void 0),t=t||"");var E=bt(),R=e?E._week.dow:0,L,o=[];if(c!=null)return Ii(t,(c+R)%7,f,"day");for(L=0;L<7;L++)o[L]=Ii(t,(L+R)%7,f,"day");return o}function ac(e,t){return Rr(e,t,"months")}function lc(e,t){return Rr(e,t,"monthsShort")}function cc(e,t,c){return Ss(e,t,c,"weekdays")}function hc(e,t,c){return Ss(e,t,c,"weekdaysShort")}function dc(e,t,c){return Ss(e,t,c,"weekdaysMin")}Rt("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,c=ye(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+c}}),ne.lang=Xe("moment.lang is deprecated. Use moment.locale instead.",Rt),ne.langData=Xe("moment.langData is deprecated. Use moment.localeData instead.",bt);var Ct=Math.abs;function uc(){var e=this._data;return this._milliseconds=Ct(this._milliseconds),this._days=Ct(this._days),this._months=Ct(this._months),e.milliseconds=Ct(e.milliseconds),e.seconds=Ct(e.seconds),e.minutes=Ct(e.minutes),e.hours=Ct(e.hours),e.months=Ct(e.months),e.years=Ct(e.years),this}function Lr(e,t,c,f){var E=st(t,c);return e._milliseconds+=f*E._milliseconds,e._days+=f*E._days,e._months+=f*E._months,e._bubble()}function _c(e,t){return Lr(this,e,t,1)}function fc(e,t){return Lr(this,e,t,-1)}function Tr(e){return e<0?Math.floor(e):Math.ceil(e)}function vc(){var e=this._milliseconds,t=this._days,c=this._months,f=this._data,E,R,L,o,l;return e>=0&&t>=0&&c>=0||e<=0&&t<=0&&c<=0||(e+=Tr(ws(c)+t)*864e5,t=0,c=0),f.milliseconds=e%1e3,E=Ze(e/1e3),f.seconds=E%60,R=Ze(E/60),f.minutes=R%60,L=Ze(R/60),f.hours=L%24,t+=Ze(L/24),l=Ze(Or(t)),c+=l,t-=Tr(ws(l)),o=Ze(c/12),c%=12,f.days=t,f.months=c,f.years=o,this}function Or(e){return e*4800/146097}function ws(e){return e*146097/4800}function gc(e){if(!this.isValid())return NaN;var t,c,f=this._milliseconds;if(e=Qe(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+f/864e5,c=this._months+Or(t),e){case"month":return c;case"quarter":return c/3;case"year":return c/12}else switch(t=this._days+Math.round(ws(this._months)),e){case"week":return t/7+f/6048e5;case"day":return t+f/864e5;case"hour":return t*24+f/36e5;case"minute":return t*1440+f/6e4;case"second":return t*86400+f/1e3;case"millisecond":return Math.floor(t*864e5)+f;default:throw new Error("Unknown unit "+e)}}function Et(e){return function(){return this.as(e)}}var Ir=Et("ms"),pc=Et("s"),mc=Et("m"),yc=Et("h"),Sc=Et("d"),wc=Et("w"),bc=Et("M"),Cc=Et("Q"),Ec=Et("y"),kc=Ir;function Dc(){return st(this)}function Mc(e){return e=Qe(e),this.isValid()?this[e+"s"]():NaN}function Ht(e){return function(){return this.isValid()?this._data[e]:NaN}}var Ac=Ht("milliseconds"),xc=Ht("seconds"),Rc=Ht("minutes"),Lc=Ht("hours"),Tc=Ht("days"),Oc=Ht("months"),Ic=Ht("years");function Pc(){return Ze(this.days()/7)}var kt=Math.round,Vt={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Bc(e,t,c,f,E){return E.relativeTime(t||1,!!c,e,f)}function Nc(e,t,c,f){var E=st(e).abs(),R=kt(E.as("s")),L=kt(E.as("m")),o=kt(E.as("h")),l=kt(E.as("d")),h=kt(E.as("M")),S=kt(E.as("w")),a=kt(E.as("y")),p=R<=c.ss&&["s",R]||R<c.s&&["ss",R]||L<=1&&["m"]||L<c.m&&["mm",L]||o<=1&&["h"]||o<c.h&&["hh",o]||l<=1&&["d"]||l<c.d&&["dd",l];return c.w!=null&&(p=p||S<=1&&["w"]||S<c.w&&["ww",S]),p=p||h<=1&&["M"]||h<c.M&&["MM",h]||a<=1&&["y"]||["yy",a],p[2]=t,p[3]=+e>0,p[4]=f,Bc.apply(null,p)}function Hc(e){return e===void 0?kt:typeof e=="function"?(kt=e,!0):!1}function Uc(e,t){return Vt[e]===void 0?!1:t===void 0?Vt[e]:(Vt[e]=t,e==="s"&&(Vt.ss=t-1),!0)}function Fc(e,t){if(!this.isValid())return this.localeData().invalidDate();var c=!1,f=Vt,E,R;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(c=e),typeof t=="object"&&(f=Object.assign({},Vt,t),t.s!=null&&t.ss==null&&(f.ss=t.s-1)),E=this.localeData(),R=Nc(this,!c,f,E),c&&(R=E.pastFuture(+this,R)),E.postformat(R)}var bs=Math.abs;function Kt(e){return(e>0)-(e<0)||+e}function Pi(){if(!this.isValid())return this.localeData().invalidDate();var e=bs(this._milliseconds)/1e3,t=bs(this._days),c=bs(this._months),f,E,R,L,o=this.asSeconds(),l,h,S,a;return o?(f=Ze(e/60),E=Ze(f/60),e%=60,f%=60,R=Ze(c/12),c%=12,L=e?e.toFixed(3).replace(/\.?0+$/,""):"",l=o<0?"-":"",h=Kt(this._months)!==Kt(o)?"-":"",S=Kt(this._days)!==Kt(o)?"-":"",a=Kt(this._milliseconds)!==Kt(o)?"-":"",l+"P"+(R?h+R+"Y":"")+(c?h+c+"M":"")+(t?S+t+"D":"")+(E||f||e?"T":"")+(E?a+E+"H":"")+(f?a+f+"M":"")+(e?a+L+"S":"")):"P0D"}var we=Ai.prototype;we.isValid=Oa,we.abs=uc,we.add=_c,we.subtract=fc,we.as=gc,we.asMilliseconds=Ir,we.asSeconds=pc,we.asMinutes=mc,we.asHours=yc,we.asDays=Sc,we.asWeeks=wc,we.asMonths=bc,we.asQuarters=Cc,we.asYears=Ec,we.valueOf=kc,we._bubble=vc,we.clone=Dc,we.get=Mc,we.milliseconds=Ac,we.seconds=xc,we.minutes=Rc,we.hours=Lc,we.days=Tc,we.weeks=Pc,we.months=Oc,we.years=Ic,we.humanize=Fc,we.toISOString=Pi,we.toString=Pi,we.toJSON=Pi,we.locale=Sr,we.localeData=br,we.toIsoString=Xe("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Pi),we.lang=wr,he("X",0,0,"unix"),he("x",0,0,"valueOf"),oe("x",wi),oe("X",oo),ke("X",function(e,t,c){c._d=new Date(parseFloat(e)*1e3)}),ke("x",function(e,t,c){c._d=new Date(ye(e))});//! moment.js
ne.version="2.30.1",Fn(Re),ne.fn=te,ne.min=xa,ne.max=Ra,ne.now=La,ne.utc=at,ne.unix=nc,ne.months=ac,ne.isDate=Zt,ne.locale=Rt,ne.invalid=vi,ne.duration=st,ne.isMoment=tt,ne.weekdays=cc,ne.parseZone=oc,ne.localeData=bt,ne.isDuration=xi,ne.monthsShort=lc,ne.weekdaysMin=dc,ne.defineLocale=cs,ne.updateLocale=oa,ne.locales=aa,ne.weekdaysShort=hc,ne.normalizeUnits=Qe,ne.relativeTimeRounding=Hc,ne.relativeTimeThreshold=Uc,ne.calendarFormat=il,ne.prototype=te,ne.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Wc={class:"content"},$c={class:"form-abs"},jc={style:{position:"absolute","z-index":"99",right:"2vw","margin-top":"10px"}},Yc={style:{display:"flex","margin-top":"10px"}},qc={style:{"font-size":"15px","margin-right":"10px"}},zc={style:{position:"absolute","z-index":"99",right:"2vw","margin-top":"10px"}},Vc=ut({__name:"historyDataPopup",props:{gatewayDetail:Object},setup(e){const{CloseIcon:t,SearchIcon:c,AnalyticsIcon:f,ListIcon:E}=Qt.ionicons5;let R=Ee({tag:"",deviceCode:"",tagCode:"",date:"",count:100,description:"",desc:!0,requestId:"history",queryType:0,aggType:"LAST",CycleData:"10",cycle:10*6e4});const L=Ee([{value:50,label:"50"+$t("project.items")+"/"+$t("energy.page")},{value:100,label:"100"+$t("project.items")+"/"+$t("energy.page")},{value:200,label:"200"+$t("project.items")+"/"+$t("energy.page")},{value:500,label:"500"+$t("project.items")+"/"+$t("energy.page")},{value:1e3,label:"1000"+$t("project.items")+"/"+$t("energy.page")}]);let o=Ee({\u6700\u8FD1\u4E00\u5468:[new Date().getTime()-3600*1e3*24*7,new Date().getTime()],\u6700\u8FD1\u4E00\u4E2A\u6708:[new Date().getTime()-3600*1e3*24*30,new Date().getTime()],\u6700\u8FD1\u4E09\u4E2A\u6708:[new Date().getTime()-3600*1e3*24*90,new Date().getTime()]}),l=Ee([{label:"FIRST("+$t("energy.First_Value")+")",value:"FIRST"},{label:"LAST("+$t("energy.Last_Value")+")",value:"LAST"},{label:"MIN("+$t("energy.Minimum")+")",value:"MIN"},{label:"MAX("+$t("energy.Maximum")+")",value:"MAX"},{label:"SUM("+$t("energy.SUM")+")",value:"SUM"},{label:"AVG("+$t("energy.Average")+")",value:"AVG"},{label:"COUNT("+$t("energy.Number_of_Entries")+")",value:"COUNT"}]),h=J([new Date().getTime()-3600*1e3*24*1,new Date().getTime()]),S=J(0),a=J([]),p=J([]),w=J(1),b=J(100),m=J(!0),i=J(!1),s=J([]),r=Ee(["Time","Tags"]),n=J([{title:"Time",key:"time"}]),u=J([]),v=J([]),C=Ee({}),M=J(!1);const _=J(!1);let y=J([]);const I=J([]);let N=J("");const d=J([]);let g=J([]);const x=Tt(),B=Ui(),W=e,H=J(null),k=J([]),T=J([]);let A=J(null),P=J();Ee({});let q=J(null);As(async()=>{if(A.value){const ee=()=>new Promise((re,ue)=>{A.value.disconnect({onSuccess:()=>{console.log("MQTT\u8FDE\u63A5\u65AD\u5F00\u6210\u529F"),re(!0)},onFailure:pe=>{ue(pe)}})});try{await ee(),A.value=null}catch{}}});const U=()=>{M.value=!M.value,M.value},j=()=>{m.value=!1,w.value--,a.value=p.value[w.value]},G=()=>{R.desc==!1?(R.startTime=a.value[a.value.length-1].time,R.endTime=R.date[1]+".000",R.count=b.value-0+1,S.value=1):(R.startTime=R.date[0]+".000",R.endTime=a.value[a.value.length-1].time,R.count=b.value-0+1,S.value=1),De()},Q=()=>{_.value=!1},D=()=>{let ee=I.value,re=[];ee.forEach(ue=>{ue.tagId&&ue.tagId.split(".")[0]!="channel"&&re.push(ue.tagId)}),re.length==0?x.warning("\u8BF7\u9009\u62E9\u4E00\u4E2A\u6570\u636E\u70B9"):(p.value.length==0?_.value=!1:(_.value=!1,S.value=0),R.tagList={},re.forEach(ue=>{let pe=ue.split(".")[0];R.tagList[pe]==null&&(R.tagList[pe]=[]),R.tagList[pe].push(ue)}),R.tag=re.join("/"))},Y=({option:ee})=>{if(ee.check==!0)return _t(xs,{checked:d.value.includes(ee.tagCode),onClick:()=>{d.value.includes(ee.tagCode)?(d.value=d.value.filter(re=>re!==ee.tagCode),I.value=I.value.filter(re=>re.tagId!==ee.tagCode)):(d.value.push(ee.tagCode),I.value.push({tagId:ee.tagCode,desc:ee.description}))}})},V=ee=>{h.value=ee;let re="",ue="";re=Jt(ee[0],"yyyy-MM-dd HH:mm:ss"),ue=Jt(ee[1],"yyyy-MM-dd HH:mm:ss"),R.date=[re,ue],R.startTime=re+".000",R.endTime=ue+".000"};ks(()=>R.CycleData,ee=>{R.cycle=ee*6e4});const K=()=>{v.value.forEach(re=>{re.type="line"}),q.value=Xr(document.getElementById("linkChart"));var ee;ee={tooltip:{trigger:"axis"},grid:{top:70,right:150,bottom:50,left:50},legend:{textStyle:{color:"black"},data:s.value},xAxis:{type:"category",boundaryGap:!1,data:u.value,axisLabel:{show:!0,textStyle:{color:"black"}}},yAxis:{type:"value",axisTick:{show:!1},splitLine:{show:!1},axisLabel:{formatter:"{value}",textStyle:{color:"black"}}},series:v.value},ee&&q.value.setOption(ee),window.addEventListener("resize",()=>{q.value.resize()})},ae=async()=>{const ee=await gt({gatewayId:C.id});console.log(ee.data,"mqtt\u4E0B\u8F7D");let re=ee.data.mqttClientId,ue=ee.data.mqttPassword;A.value=new Ue.Client(ee.data.mqttUrl,Number(ee.data.mqttPort),re),A.value.onConnectionLost=rt,A.value.onMessageArrived=Te,P.value={timeout:30,userName:ee.data.mqttUserName,password:ue,keepAliveInterval:60,cleanSession:!0,reconnect:!1,onSuccess:ie,onFailure:me},A.value.connect(P.value)},ie=()=>{console.log("\u8FDE\u63A5mqtt websocket\u7AEF\u53E3\u6210\u529F",T.value[0]),A.value.subscribe(T.value[0],{qos:0,onSuccess:()=>{console.log("\u8BA2\u9605\u4E2D..."),De()},onFailure:function(ee){console.log("\u8BA2\u9605\u6570\u636E\u5931\u8D25",ee),A.value.connect(P.value)}})},me=ee=>{x.error($t("energy.connection_fail"))},De=()=>{let ee=new Ue.Message(JSON.stringify(R));ee.destinationName=k.value[0],A.value.send(ee)},Te=ee=>{const re=JSON.parse(ee.payloadString);R.requestId==re.requestId&&Pe(JSON.parse(JSON.stringify(re)))},rt=ee=>{A.value!=null&&(A.value.disconnect(),A.value=null),console.log("\u94FE\u63A5\u505C\u6B62/\u4E22\u5931")},_e=()=>{_n({id:C.sandboxId,userid:C.userId}).then(ee=>{const re=ee.data;y.value=X(re),dt(),_.value=!0})},dt=()=>{let ee=y.value,re=[];for(let ue of ee)ue.text=="I/O\u70B9"&&(re=ue.children,g.value.push(ue.text));for(let ue of re)g.value.push(ue.text)},X=(ee,re,ue)=>{for(let Ve in ee){var pe=ee[Ve];pe.value=!1,pe.id==re&&(pe.value=!0),pe.description!=null&&pe.description!=""&&(pe.text=pe.text+" ("+pe.description+")"),ue!=null&&ue!=""&&(pe.tagCode=ue+"."+pe.tagCode),pe.channelCode&&(pe.tagCode="channel."+pe.channelCode),pe.children?(pe.check=!1,pe.deviceCode!=null&&pe.deviceCode!=""?X(pe.children,re,pe.deviceCode):X(pe.children,re)):pe.tagCode&&(pe.check=!0)}return ee},Z=()=>{R.tagList.length<1?x.error("\u8BF7\u9009\u62E9\u4E00\u4E2A\u6709\u6548\u7684\u6570\u636E\u70B9"):R.date.length<=1?x.error("\u8BF7\u9009\u62E9\u67E5\u8BE2\u65F6\u95F4\u8303\u56F4"):R.aggType==""||R.CycleData==""?x.error("\u8BF7\u8F93\u5165\u805A\u5408\u67E5\u8BE2\u53C2\u6570"):R.CycleData<1?x.error("\u8BF7\u8F93\u5165\u805A\u5408\u5468\u671F"):(r=[],r=R.tag.split("/"),r.unshift("time"),i.value=!0,R.startTime=R.date[0]+".000",R.endTime=R.date[1]+".000",S.value=0,console.log("client",A.value),A.value?De():ae())},ve=()=>{B.success({title:"\u63D0\u793A",showIcon:!1,content:"\u786E\u5B9A\u8981\u6E05\u7A7A\u67E5\u8BE2\u7684\u6570\u636E\u5417?",positiveText:"\u786E\u5B9A",positiveButtonProps:{secondary:!0},negativeText:"\u53D6\u6D88",onPositiveClick:()=>{x.success("\u786E\u5B9A"),p.value=[],a.value=[],m.value=!0,w.value=1,u.value=[],v.value=[],q.value.clear()}})},ge=()=>{R.count=b.value,R.startTime=R.date[0]+".000",R.endTime=R.date[1]+".000",S.value=0},Pe=ee=>{console.log(ee,"\u62FF\u5230\u7684\u6570\u636E"),ee.TableData==null&&(ee.TableData=[]);let re=[];if(S.value==1?(ee.TableData.shift(),re=ee.TableData):(w.value=1,re=ee.TableData,p.value=[],a.value=[],u.value=[],v.value=[]),re.length==0)m.value=!0;else if(re.length<b.value){m.value=!0,w.value=w.value+S.value,a.value=re,p.value[w.value]=a.value,u.value=[],v.value=[];for(let ue of a.value)u.value.push(ue.time),v.value.push(ue.val);R.desc&&(v.value.reverse(),u.value.reverse()),K()}else m.value=!1,w.value=w.value+S.value,a.value=re,p.value[w.value]=a.value,ee.EchartsData.series.forEach((ue,pe)=>{s.value.push(ue.name)}),v.value=ee.EchartsData.series,u.value=ee.EchartsData.times.reverse(),K();if(R.queryType==1&&(m.value=!0),a.value.length>0){n.value=[];for(let ue in r)n.value.push({title:r[ue],key:r[ue]})}i.value=!1};return Mt(async()=>{let ee=Jt(h.value[0],"yyyy-MM-dd HH:mm:ss"),re=Jt(h.value[1],"yyyy-MM-dd HH:mm:ss");R.date=[ee,re],W.gatewayDetail&&(C=W.gatewayDetail,H.value=C.id,k.value=["/edge/history/"+C.sn+"/"+C.sn+"/get"],T.value=["/edge/history/"+C.sn+"/"+C.sn+"/get/reply"])}),(ee,re)=>{const ue=de("n-input"),pe=de("n-input-group"),Ve=de("n-switch"),Dt=de("n-select"),Ge=de("n-popover"),nt=de("n-data-table"),Me=de("n-text"),ot=de("n-space"),hi=de("n-card");return Se(),Fe("div",Wc,[ce("div",$c,[F(O(Xt),{ref:"formRef",inline:"",model:O(R),"label-placement":"left",style:{display:"flex","flex-wrap":"wrap"}},{default:z(()=>[F(O(ft),{label:ee.$t("energy.data_points")},{default:z(()=>[F(pe,null,{default:z(()=>[F(ue,{value:O(R).tag,"onUpdate:value":re[0]||(re[0]=Oe=>O(R).tag=Oe),placeholder:ee.$t("energy.please_select"),disabled:"",style:{width:"240px"}},null,8,["value","placeholder"]),F(O(Ne),{onClick:_e},{icon:z(()=>[F(O(It),null,{default:z(()=>[F(O(c))]),_:1})]),_:1})]),_:1})]),_:1},8,["label"]),F(O(ft),{label:ee.$t("energy.search")+ee.$t("energy.time_range")},{default:z(()=>[F(O(Gr),{value:O(h),"onUpdate:value":re[1]||(re[1]=Oe=>vt(h)?h.value=Oe:h=Oe),type:"datetimerange","on-update:value":V,separator:ee.$t("energy.to"),shortcuts:O(o),clearable:""},null,8,["value","separator","shortcuts"])]),_:1},8,["label"]),F(O(ft),{label:ee.$t("energy.aggregate_queries")},{default:z(()=>[F(Ve,{value:O(R).queryType,"onUpdate:value":re[2]||(re[2]=Oe=>O(R).queryType=Oe),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1},8,["label"]),O(R).queryType==1?(Se(),qe(O(ft),{key:0,label:ee.$t("energy.aggregation_period")},{default:z(()=>[F(ue,{value:O(R).CycleData,"onUpdate:value":re[3]||(re[3]=Oe=>O(R).CycleData=Oe)},null,8,["value"])]),_:1},8,["label"])):Ae("v-if",!0),O(R).queryType==1?(Se(),qe(O(ft),{key:1,label:ee.$t("energy.aggregate_function")},{default:z(()=>[F(Dt,{value:O(R).aggType,"onUpdate:value":re[4]||(re[4]=Oe=>O(R).aggType=Oe),options:O(l)},null,8,["value","options"])]),_:1},8,["label"])):Ae("v-if",!0),F(O(ft),null,{default:z(()=>[F(O(xs),{checked:O(R).desc,"onUpdate:checked":re[5]||(re[5]=Oe=>O(R).desc=Oe)},{default:z(()=>[le(se(ee.$t("energy.reverse_order")),1)]),_:1},8,["checked"])]),_:1}),F(O(ft),null,{default:z(()=>[F(O(Ne),{onClick:Z},{default:z(()=>[le(se(ee.$t("energy.search")),1)]),_:1})]),_:1}),F(O(ft),null,{default:z(()=>[F(O(Ne),{onClick:ve},{default:z(()=>[le(se(ee.$t("energy.clear")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),Rs(ce("div",null,[ce("div",jc,[F(Ge,{trigger:"hover"},{trigger:z(()=>[F(O(Ne),{style:{float:"right"},onClick:U},{default:z(()=>[F(O(It),null,{default:z(()=>[F(O(f))]),_:1})]),_:1})]),default:z(()=>[ce("span",null,se(ee.$t("energy.echarts")),1)]),_:1})]),F(nt,{columns:O(n),data:O(a),"max-height":"65vh"},null,8,["columns","data"]),ce("div",Yc,[ce("span",qc,se(ee.$t("energy.current_page_number"))+":"+se(O(w))+se(ee.$t("energy.page")),1),F(Dt,{value:O(b),"onUpdate:value":re[6]||(re[6]=Oe=>vt(b)?b.value=Oe:b=Oe),size:"small",placeholder:ee.$t("energy.please_select"),style:{width:"130px","margin-right":"10px"},"onChange:value":ge,options:L},null,8,["value","placeholder","options"]),F(O(Ne),{size:"small",onClick:j,disabled:O(w)==1,style:{"margin-right":"10px"}},{default:z(()=>[le(se(ee.$t("energy.previous_page")),1)]),_:1},8,["disabled"]),F(O(Ne),{size:"small",onClick:G,disabled:O(m),loading:O(i)},{default:z(()=>[le(se(ee.$t("energy.next_page")),1)]),_:1},8,["disabled","loading"])])],512),[[Ls,!O(M)]]),Rs(ce("div",null,[ce("div",zc,[F(Ge,{trigger:"hover"},{trigger:z(()=>[F(O(Ne),{style:{float:"right"},onClick:U},{default:z(()=>[F(O(It),null,{default:z(()=>[F(O(E))]),_:1})]),_:1})]),default:z(()=>[ce("span",null,se(ee.$t("energy.list")),1)]),_:1})]),ce("div",{style:Fi([{width:"75vw"},{height:O(R).queryType==1?"calc(100vh - 220px)":"calc(100vh - 270px)"}]),id:"linkChart"},null,4)],512),[[Ls,O(M)]]),Ae(" \u67E5\u8BE2\u6570\u636E\u70B9\u5F39\u7A97 "),_.value?(Se(),qe(O(di),{key:0,show:_.value,"onUpdate:show":re[8]||(re[8]=Oe=>_.value=Oe)},{default:z(()=>[F(hi,{bordered:!1,role:"dialog",size:"small","aria-modal":"true",style:{width:"600px",height:"700px"}},{header:z(()=>[F(ot,null,{default:z(()=>[F(Me,null,{default:z(()=>[le(se(ee.$t("project.bindDataPoint")),1)]),_:1})]),_:1})]),action:z(()=>[F(ot,{justify:`
                flex-end`},{default:z(()=>[F(ot,null,{default:z(()=>[F(O(Ne),{size:"medium",onClick:Q},{default:z(()=>[le(se(ee.$t("energy.close")),1)]),_:1}),F(O(Ne),{size:"medium",onClick:D},{default:z(()=>[le(se(ee.$t("energy.save")),1)]),_:1})]),_:1})]),_:1})]),default:z(()=>[F(ot,{size:"small",vertical:"",style:{height:"580px"}},{default:z(()=>[F(ue,{value:O(N),"onUpdate:value":re[7]||(re[7]=Oe=>vt(N)?N.value=Oe:N=Oe),placeholder:ee.$t("energy.search"),ref:"inputInstRef",style:{"margin-bottom":"10px"}},null,8,["value","placeholder"]),F(O(Jr),{data:O(y),pattern:O(N),"key-field":"text","render-prefix":Y,"show-irrelevant-nodes":!1,"label-field":"text",style:{height:"540px",overflow:"auto"},"default-expanded-keys":O(g)},null,8,["data","pattern","default-expanded-keys"])]),_:1})]),_:1})]),_:1},8,["show"])):Ae("v-if",!0)])}}}),Kc=At(Vc,[["__scopeId","data-v-c6c714b8"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/energy/gateway/historyDataPopup.vue"]]),Gc={class:"content"},Jc={style:{"margin-top":"10px"}},Xc={class:"log"},Qc={class:"log-content"},Zc={key:0},eh={key:1},th={key:0},ih={key:1},sh=ut({__name:"gateway-log",props:{gatewayDetail:Object},emits:["changeLoading"],setup(e,{emit:t}){const{AlertCircleOutlineIcon:c,CloseCircleOutlineIcon:f}=Qt.ionicons5;let E=J(),R=J(""),L=J("");const o=J(!1);let l=Ee({});const h=Tt();Ui();const S=e,a=J(null),p=J(),w=J();let b=J(null),m=J(),i=J(),s=J(!0),r=J(),n=Ee([]),u=J(!1),v=J(!1),C=J(!1),M=J([]);const _=()=>{R.value=L.value},y=()=>{let j=n.map(Q=>Q+`\r
`);var G=new Blob([...j],{type:"text/plain;charset=utf-8"});tn.saveAs(G,"\u65E5\u5FD7 "+ne().format("YYYY-MM-DD HH:mm"))},I=async()=>{if(b.value!==null){h.error("\u8BF7\u52FF\u91CD\u590D\u83B7\u53D6\u65E5\u5FD7!");return}const j=await gt({gatewayId:l.id});console.log(j.data,"mqtt\u4E0B\u8F7D");let G=j.data.mqttClientId,Q=j.data.mqttPassword;b.value=new Ue.Client(j.data.mqttUrl,Number(j.data.mqttPort),G),b.value.onConnectionLost=H,b.value.onMessageArrived=W;let D={timeout:30,userName:j.data.mqttUserName,password:Q,keepAliveInterval:60,cleanSession:!0,reconnect:!1,onSuccess:g,onFailure:x};b.value.connect(D)},N=async()=>{w.value=["/edge/log/"+l.sn+"/"+l.sn+"/pub","/edge/log/"+l.sn+"/"+l.sn+"/initial/reply"],p.value=["/edge/log/"+l.sn+"/"+l.sn+"/lifecycle","/edge/log/"+l.sn+"/"+l.sn+"/initial"],C.value=!0;const j=await gt({gatewayId:l.id});console.log(j.data,"mqtt\u4E0B\u8F7D");let G=j.data.mqttClientId,Q=j.data.mqttPassword;i.value=new Ue.Client(j.data.mqttUrl,Number(j.data.mqttPort),G),i.value.onConnectionLost=k,i.value.onMessageArrived=T;let D={timeout:30,userName:j.data.mqttUserName,password:Q,keepAliveInterval:60,cleanSession:!0,reconnect:!1,onSuccess:A,onFailure:P};i.value.connect(D)},d=()=>{if(m.value!=null&&(clearInterval(m.value),m.value=null),b.value!=null){v.value=!0;let j=new Ue.Message('{"direction": "stop"}');j.destinationName=p.value[0],b.value.send(j),setTimeout(()=>{b.value.disconnect(),b.value=null,v.value=!1},1e3)}},g=()=>{b.value.subscribe(w.value[0],{qos:0,onSuccess:()=>{console.log("\u8BA2\u9605\u4E2D..."),B()},onFailure:function(j){console.log("\u8BA2\u9605\u6570\u636E\u5931\u8D25",j),b.value.connect(r.value)}})},x=j=>{h.error($t("energy.connection_fail"))},B=()=>{console.log("\u5B9E\u65F6\u6570\u636E....");let j=new Ue.Message('{"direction": "start","duration":5}');j.destinationName=p.value[0],b.value.send(j),m.value=setInterval(function(){b.value.send(j)},5*60*1e3)},W=j=>{var G=j.payloadString;try{s.value==!1&&(G=G.indexOf("Tx")!=-1?"":G,G=G.indexOf("Rx")!=-1?"":G);var Q=!0;G!=""&&R.value!=""&&(Q=!1,R.value.split("||").forEach(D=>{D!=""&&G.indexOf(D)!=-1&&(Q=!0)})),Q==!1&&(G="")}catch(D){console.log("\u6570\u636E\u89E3\u6790\u62A5\u9519",D)}G!=""&&n.push(G),u.value&&Qr(()=>{document.querySelector(".log-content").scrollTop=document.querySelector(".log-content").scrollHeight})},H=()=>{console.log("\u94FE\u63A5\u505C\u6B62/\u4E22\u5931"),setTimeout(()=>{d()},100)},k=()=>{C.value=!1},T=j=>{C.value=!1;try{M.value=j.payloadString.split(`
`)}catch(G){console.log("\u6570\u636E\u89E3\u6790\u62A5\u9519",G),M.value=j.payloadString}o.value=!0,i.value!=null&&(i.value.disconnect(),i.value=null)},A=()=>{i.value.subscribe(w.value[1],{qos:0,onSuccess:()=>{console.log("\u8BA2\u9605\u4E2D..."),q()},onFailure:function(j){console.log("\u8BA2\u9605\u65E5\u5FD7\u5931\u8D25",j)}})},P=j=>{C.value=!1,h.error($t("energy.fail_to_get"))},q=()=>{var j=new Ue.Message('{"offset": 0,"count":100}');j.destinationName=p.value[1],i.value.send(j)},U=()=>{n.splice(0,n.length)};return Mt(async()=>{S.gatewayDetail&&(l=S.gatewayDetail,E.value=l.id,a.value=l.id,w.value=["/edge/log/"+l.sn+"/"+l.sn+"/pub","/edge/log/"+l.sn+"/"+l.sn+"/initial/reply"],p.value=["/edge/log/"+l.sn+"/"+l.sn+"/lifecycle","/edge/log/"+l.sn+"/"+l.sn+"/initial"])}),Gt(()=>{}),ui(()=>{d()}),(j,G)=>{const Q=de("n-input"),D=de("n-checkbox"),Y=de("n-card");return Se(),Fe("div",Gc,[ce("div",null,[ce("div",null,[F(O(Ne),{style:{"margin-right":"10px"},type:"primary",onClick:I,disabled:O(b)!=null,secondary:""},{default:z(()=>[le(se(j.$t("energy.Fetching_logs")),1)]),_:1},8,["disabled"]),F(O(Ne),{style:{"margin-right":"10px"},type:"primary",onClick:d,loading:O(v),disabled:O(b)==null,secondary:""},{default:z(()=>[le(se(j.$t("energy.Stop_fetching")),1)]),_:1},8,["loading","disabled"]),F(O(Ne),{style:{"margin-right":"10px"},type:"primary",onClick:N,loading:O(C),secondary:""},{default:z(()=>[le(se(j.$t("energy.Start_log")),1)]),_:1},8,["loading"]),F(O(Ne),{style:{"margin-right":"10px"},onClick:y},{default:z(()=>[le(se(j.$t("energy.save_logs")),1)]),_:1})]),ce("div",Jc,[F(Q,{value:O(L),"onUpdate:value":G[0]||(G[0]=V=>vt(L)?L.value=V:L=V),placeholder:j.$t("energy.please_enter"),style:{width:"150px","margin-right":"10px"}},null,8,["value","placeholder"]),F(O(Ne),{style:{"margin-right":"10px"},onClick:_},{default:z(()=>[le(se(j.$t("energy.filtrate")),1)]),_:1}),F(D,{style:{"margin-right":"10px"},checked:O(s),"onUpdate:checked":G[1]||(G[1]=V=>vt(s)?s.value=V:s=V)},{default:z(()=>[le(se(j.$t("energy.Display_packet")),1)]),_:1},8,["checked"]),F(D,{style:{"margin-right":"10px"},checked:O(u),"onUpdate:checked":G[2]||(G[2]=V=>vt(u)?u.value=V:u=V)},{default:z(()=>[le(se(j.$t("energy.roll")),1)]),_:1},8,["checked"]),F(O(Ne),{onClick:U},{default:z(()=>[le(se(j.$t("energy.cls")),1)]),_:1})])]),ce("div",Xc,[ce("div",Qc,[(Se(!0),Fe(Ts,null,Os(O(n),V=>(Se(),Fe("div",null,[V.includes("ERROR")?(Se(),Fe("span",Zc,[F(O(It),{color:"#F56C6C"},{default:z(()=>[F(O(f))]),_:1}),le(" "+se(V),1)])):(Se(),Fe("span",eh,[F(O(It),{color:"#409EFF"},{default:z(()=>[F(O(c))]),_:1}),le(" "+se(V),1)]))]))),256))])]),o.value?(Se(),qe(O(di),{key:0,show:o.value,"onUpdate:show":G[3]||(G[3]=V=>o.value=V),"auto-focus":!1},{default:z(()=>[F(Y,{title:j.$t("energy.Start_log"),style:{height:"90vh",width:"80vw","overflow-y":"auto"}},{default:z(()=>[Ae(' <div style="white-space: break-spaces">{{ firstLogData }}</div> '),(Se(!0),Fe(Ts,null,Os(O(M),V=>(Se(),Fe("div",null,[V.includes("ERROR")?(Se(),Fe("span",th,[F(O(It),{color:"#F56C6C"},{default:z(()=>[F(O(f))]),_:1}),le(" "+se(V),1)])):(Se(),Fe("span",ih,[F(O(It),{color:"#409EFF"},{default:z(()=>[F(O(c))]),_:1}),le(" "+se(V),1)]))]))),256))]),_:1},8,["title"])]),_:1},8,["show"])):Ae("v-if",!0)])}}}),rh=At(sh,[["__scopeId","data-v-955a17ef"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/energy/gateway/gateway-log.vue"]]);var Pr={exports:{}};(function(e,t){(function(c,f){e.exports=f()})(self,()=>(()=>{var c={4567:function(L,o,l){var h=this&&this.__decorate||function(n,u,v,C){var M,_=arguments.length,y=_<3?u:C===null?C=Object.getOwnPropertyDescriptor(u,v):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(n,u,v,C);else for(var I=n.length-1;I>=0;I--)(M=n[I])&&(y=(_<3?M(y):_>3?M(u,v,y):M(u,v))||y);return _>3&&y&&Object.defineProperty(u,v,y),y},S=this&&this.__param||function(n,u){return function(v,C){u(v,C,n)}};Object.defineProperty(o,"__esModule",{value:!0}),o.AccessibilityManager=void 0;const a=l(9042),p=l(6114),w=l(9924),b=l(844),m=l(5596),i=l(4725),s=l(3656);let r=o.AccessibilityManager=class extends b.Disposable{constructor(n,u){super(),this._terminal=n,this._renderService=u,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let v=0;v<this._terminal.rows;v++)this._rowElements[v]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[v]);if(this._topBoundaryFocusListener=v=>this._handleBoundaryFocus(v,0),this._bottomBoundaryFocusListener=v=>this._handleBoundaryFocus(v,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new w.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(v=>this._handleResize(v.rows))),this.register(this._terminal.onRender(v=>this._refreshRows(v.start,v.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(v=>this._handleChar(v))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(v=>this._handleTab(v))),this.register(this._terminal.onKey(v=>this._handleKey(v.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new m.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,s.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,b.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(n){for(let u=0;u<n;u++)this._handleChar(" ")}_handleChar(n){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==n&&(this._charsToAnnounce+=n):this._charsToAnnounce+=n,n===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=a.tooMuchOutput)),p.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,p.isMac&&this._liveRegion.remove()}_handleKey(n){this._clearLiveRegion(),/\p{Control}/u.test(n)||this._charsToConsume.push(n)}_refreshRows(n,u){this._liveRegionDebouncer.refresh(n,u,this._terminal.rows)}_renderRows(n,u){const v=this._terminal.buffer,C=v.lines.length.toString();for(let M=n;M<=u;M++){const _=v.translateBufferLineToString(v.ydisp+M,!0),y=(v.ydisp+M+1).toString(),I=this._rowElements[M];I&&(_.length===0?I.innerText="\xA0":I.textContent=_,I.setAttribute("aria-posinset",y),I.setAttribute("aria-setsize",C))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(n,u){const v=n.target,C=this._rowElements[u===0?1:this._rowElements.length-2];if(v.getAttribute("aria-posinset")===(u===0?"1":`${this._terminal.buffer.lines.length}`)||n.relatedTarget!==C)return;let M,_;if(u===0?(M=v,_=this._rowElements.pop(),this._rowContainer.removeChild(_)):(M=this._rowElements.shift(),_=v,this._rowContainer.removeChild(M)),M.removeEventListener("focus",this._topBoundaryFocusListener),_.removeEventListener("focus",this._bottomBoundaryFocusListener),u===0){const y=this._createAccessibilityTreeNode();this._rowElements.unshift(y),this._rowContainer.insertAdjacentElement("afterbegin",y)}else{const y=this._createAccessibilityTreeNode();this._rowElements.push(y),this._rowContainer.appendChild(y)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(u===0?-1:1),this._rowElements[u===0?1:this._rowElements.length-2].focus(),n.preventDefault(),n.stopImmediatePropagation()}_handleResize(n){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let u=this._rowContainer.children.length;u<this._terminal.rows;u++)this._rowElements[u]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[u]);for(;this._rowElements.length>n;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const n=document.createElement("div");return n.setAttribute("role","listitem"),n.tabIndex=-1,this._refreshRowDimensions(n),n}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let n=0;n<this._terminal.rows;n++)this._refreshRowDimensions(this._rowElements[n])}}_refreshRowDimensions(n){n.style.height=`${this._renderService.dimensions.css.cell.height}px`}};o.AccessibilityManager=r=h([S(1,i.IRenderService)],r)},3614:(L,o)=>{function l(p){return p.replace(/\r?\n/g,"\r")}function h(p,w){return w?"\x1B[200~"+p+"\x1B[201~":p}function S(p,w,b,m){p=h(p=l(p),b.decPrivateModes.bracketedPasteMode&&m.rawOptions.ignoreBracketedPasteMode!==!0),b.triggerDataEvent(p,!0),w.value=""}function a(p,w,b){const m=b.getBoundingClientRect(),i=p.clientX-m.left-10,s=p.clientY-m.top-10;w.style.width="20px",w.style.height="20px",w.style.left=`${i}px`,w.style.top=`${s}px`,w.style.zIndex="1000",w.focus()}Object.defineProperty(o,"__esModule",{value:!0}),o.rightClickHandler=o.moveTextAreaUnderMouseCursor=o.paste=o.handlePasteEvent=o.copyHandler=o.bracketTextForPaste=o.prepareTextForTerminal=void 0,o.prepareTextForTerminal=l,o.bracketTextForPaste=h,o.copyHandler=function(p,w){p.clipboardData&&p.clipboardData.setData("text/plain",w.selectionText),p.preventDefault()},o.handlePasteEvent=function(p,w,b,m){p.stopPropagation(),p.clipboardData&&S(p.clipboardData.getData("text/plain"),w,b,m)},o.paste=S,o.moveTextAreaUnderMouseCursor=a,o.rightClickHandler=function(p,w,b,m,i){a(p,w,b),i&&m.rightClickSelect(p),w.value=m.selectionText,w.select()}},7239:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ColorContrastCache=void 0;const h=l(1505);o.ColorContrastCache=class{constructor(){this._color=new h.TwoKeyMap,this._css=new h.TwoKeyMap}setCss(S,a,p){this._css.set(S,a,p)}getCss(S,a){return this._css.get(S,a)}setColor(S,a,p){this._color.set(S,a,p)}getColor(S,a){return this._color.get(S,a)}clear(){this._color.clear(),this._css.clear()}}},3656:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.addDisposableDomListener=void 0,o.addDisposableDomListener=function(l,h,S,a){l.addEventListener(h,S,a);let p=!1;return{dispose:()=>{p||(p=!0,l.removeEventListener(h,S,a))}}}},6465:function(L,o,l){var h=this&&this.__decorate||function(i,s,r,n){var u,v=arguments.length,C=v<3?s:n===null?n=Object.getOwnPropertyDescriptor(s,r):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(i,s,r,n);else for(var M=i.length-1;M>=0;M--)(u=i[M])&&(C=(v<3?u(C):v>3?u(s,r,C):u(s,r))||C);return v>3&&C&&Object.defineProperty(s,r,C),C},S=this&&this.__param||function(i,s){return function(r,n){s(r,n,i)}};Object.defineProperty(o,"__esModule",{value:!0}),o.Linkifier2=void 0;const a=l(3656),p=l(8460),w=l(844),b=l(2585);let m=o.Linkifier2=class extends w.Disposable{get currentLink(){return this._currentLink}constructor(i){super(),this._bufferService=i,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new p.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new p.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,w.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,w.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}registerLinkProvider(i){return this._linkProviders.push(i),{dispose:()=>{const s=this._linkProviders.indexOf(i);s!==-1&&this._linkProviders.splice(s,1)}}}attachToDom(i,s,r){this._element=i,this._mouseService=s,this._renderService=r,this.register((0,a.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,a.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,a.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,a.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(i){if(this._lastMouseEvent=i,!this._element||!this._mouseService)return;const s=this._positionFromMouseEvent(i,this._element,this._mouseService);if(!s)return;this._isMouseOut=!1;const r=i.composedPath();for(let n=0;n<r.length;n++){const u=r[n];if(u.classList.contains("xterm"))break;if(u.classList.contains("xterm-hover"))return}this._lastBufferCell&&s.x===this._lastBufferCell.x&&s.y===this._lastBufferCell.y||(this._handleHover(s),this._lastBufferCell=s)}_handleHover(i){if(this._activeLine!==i.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(i,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,i)||(this._clearCurrentLink(),this._askForLink(i,!0))}_askForLink(i,s){var r,n;this._activeProviderReplies&&s||((r=this._activeProviderReplies)===null||r===void 0||r.forEach(v=>{v?.forEach(C=>{C.link.dispose&&C.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=i.y);let u=!1;for(const[v,C]of this._linkProviders.entries())s?!((n=this._activeProviderReplies)===null||n===void 0)&&n.get(v)&&(u=this._checkLinkProviderResult(v,i,u)):C.provideLinks(i.y,M=>{var _,y;if(this._isMouseOut)return;const I=M?.map(N=>({link:N}));(_=this._activeProviderReplies)===null||_===void 0||_.set(v,I),u=this._checkLinkProviderResult(v,i,u),((y=this._activeProviderReplies)===null||y===void 0?void 0:y.size)===this._linkProviders.length&&this._removeIntersectingLinks(i.y,this._activeProviderReplies)})}_removeIntersectingLinks(i,s){const r=new Set;for(let n=0;n<s.size;n++){const u=s.get(n);if(u)for(let v=0;v<u.length;v++){const C=u[v],M=C.link.range.start.y<i?0:C.link.range.start.x,_=C.link.range.end.y>i?this._bufferService.cols:C.link.range.end.x;for(let y=M;y<=_;y++){if(r.has(y)){u.splice(v--,1);break}r.add(y)}}}}_checkLinkProviderResult(i,s,r){var n;if(!this._activeProviderReplies)return r;const u=this._activeProviderReplies.get(i);let v=!1;for(let C=0;C<i;C++)this._activeProviderReplies.has(C)&&!this._activeProviderReplies.get(C)||(v=!0);if(!v&&u){const C=u.find(M=>this._linkAtPosition(M.link,s));C&&(r=!0,this._handleNewLink(C))}if(this._activeProviderReplies.size===this._linkProviders.length&&!r)for(let C=0;C<this._activeProviderReplies.size;C++){const M=(n=this._activeProviderReplies.get(C))===null||n===void 0?void 0:n.find(_=>this._linkAtPosition(_.link,s));if(M){r=!0,this._handleNewLink(M);break}}return r}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(i){if(!this._element||!this._mouseService||!this._currentLink)return;const s=this._positionFromMouseEvent(i,this._element,this._mouseService);s&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,s)&&this._currentLink.link.activate(i,this._currentLink.link.text)}_clearCurrentLink(i,s){this._element&&this._currentLink&&this._lastMouseEvent&&(!i||!s||this._currentLink.link.range.start.y>=i&&this._currentLink.link.range.end.y<=s)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,w.disposeArray)(this._linkCacheDisposables))}_handleNewLink(i){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const s=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);s&&this._linkAtPosition(i.link,s)&&(this._currentLink=i,this._currentLink.state={decorations:{underline:i.link.decorations===void 0||i.link.decorations.underline,pointerCursor:i.link.decorations===void 0||i.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,i.link,this._lastMouseEvent),i.link.decorations={},Object.defineProperties(i.link.decorations,{pointerCursor:{get:()=>{var r,n;return(n=(r=this._currentLink)===null||r===void 0?void 0:r.state)===null||n===void 0?void 0:n.decorations.pointerCursor},set:r=>{var n,u;!((n=this._currentLink)===null||n===void 0)&&n.state&&this._currentLink.state.decorations.pointerCursor!==r&&(this._currentLink.state.decorations.pointerCursor=r,this._currentLink.state.isHovered&&((u=this._element)===null||u===void 0||u.classList.toggle("xterm-cursor-pointer",r)))}},underline:{get:()=>{var r,n;return(n=(r=this._currentLink)===null||r===void 0?void 0:r.state)===null||n===void 0?void 0:n.decorations.underline},set:r=>{var n,u,v;!((n=this._currentLink)===null||n===void 0)&&n.state&&((v=(u=this._currentLink)===null||u===void 0?void 0:u.state)===null||v===void 0?void 0:v.decorations.underline)!==r&&(this._currentLink.state.decorations.underline=r,this._currentLink.state.isHovered&&this._fireUnderlineEvent(i.link,r))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(r=>{if(!this._currentLink)return;const n=r.start===0?0:r.start+1+this._bufferService.buffer.ydisp,u=this._bufferService.buffer.ydisp+1+r.end;if(this._currentLink.link.range.start.y>=n&&this._currentLink.link.range.end.y<=u&&(this._clearCurrentLink(n,u),this._lastMouseEvent&&this._element)){const v=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);v&&this._askForLink(v,!1)}})))}_linkHover(i,s,r){var n;!((n=this._currentLink)===null||n===void 0)&&n.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(s,!0),this._currentLink.state.decorations.pointerCursor&&i.classList.add("xterm-cursor-pointer")),s.hover&&s.hover(r,s.text)}_fireUnderlineEvent(i,s){const r=i.range,n=this._bufferService.buffer.ydisp,u=this._createLinkUnderlineEvent(r.start.x-1,r.start.y-n-1,r.end.x,r.end.y-n-1,void 0);(s?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(u)}_linkLeave(i,s,r){var n;!((n=this._currentLink)===null||n===void 0)&&n.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(s,!1),this._currentLink.state.decorations.pointerCursor&&i.classList.remove("xterm-cursor-pointer")),s.leave&&s.leave(r,s.text)}_linkAtPosition(i,s){const r=i.range.start.y*this._bufferService.cols+i.range.start.x,n=i.range.end.y*this._bufferService.cols+i.range.end.x,u=s.y*this._bufferService.cols+s.x;return r<=u&&u<=n}_positionFromMouseEvent(i,s,r){const n=r.getCoords(i,s,this._bufferService.cols,this._bufferService.rows);if(n)return{x:n[0],y:n[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(i,s,r,n,u){return{x1:i,y1:s,x2:r,y2:n,cols:this._bufferService.cols,fg:u}}};o.Linkifier2=m=h([S(0,b.IBufferService)],m)},9042:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.tooMuchOutput=o.promptLabel=void 0,o.promptLabel="Terminal input",o.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(L,o,l){var h=this&&this.__decorate||function(m,i,s,r){var n,u=arguments.length,v=u<3?i:r===null?r=Object.getOwnPropertyDescriptor(i,s):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(m,i,s,r);else for(var C=m.length-1;C>=0;C--)(n=m[C])&&(v=(u<3?n(v):u>3?n(i,s,v):n(i,s))||v);return u>3&&v&&Object.defineProperty(i,s,v),v},S=this&&this.__param||function(m,i){return function(s,r){i(s,r,m)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OscLinkProvider=void 0;const a=l(511),p=l(2585);let w=o.OscLinkProvider=class{constructor(m,i,s){this._bufferService=m,this._optionsService=i,this._oscLinkService=s}provideLinks(m,i){var s;const r=this._bufferService.buffer.lines.get(m-1);if(!r)return void i(void 0);const n=[],u=this._optionsService.rawOptions.linkHandler,v=new a.CellData,C=r.getTrimmedLength();let M=-1,_=-1,y=!1;for(let I=0;I<C;I++)if(_!==-1||r.hasContent(I)){if(r.loadCell(I,v),v.hasExtendedAttrs()&&v.extended.urlId){if(_===-1){_=I,M=v.extended.urlId;continue}y=v.extended.urlId!==M}else _!==-1&&(y=!0);if(y||_!==-1&&I===C-1){const N=(s=this._oscLinkService.getLinkData(M))===null||s===void 0?void 0:s.uri;if(N){const d={start:{x:_+1,y:m},end:{x:I+(y||I!==C-1?0:1),y:m}};let g=!1;if(!u?.allowNonHttpProtocols)try{const x=new URL(N);["http:","https:"].includes(x.protocol)||(g=!0)}catch{g=!0}g||n.push({text:N,range:d,activate:(x,B)=>u?u.activate(x,B,d):b(0,B),hover:(x,B)=>{var W;return(W=u?.hover)===null||W===void 0?void 0:W.call(u,x,B,d)},leave:(x,B)=>{var W;return(W=u?.leave)===null||W===void 0?void 0:W.call(u,x,B,d)}})}y=!1,v.hasExtendedAttrs()&&v.extended.urlId?(_=I,M=v.extended.urlId):(_=-1,M=-1)}}i(n)}};function b(m,i){if(confirm(`Do you want to navigate to ${i}?

WARNING: This link could potentially be dangerous`)){const s=window.open();if(s){try{s.opener=null}catch{}s.location.href=i}else console.warn("Opening link blocked as opener could not be cleared")}}o.OscLinkProvider=w=h([S(0,p.IBufferService),S(1,p.IOptionsService),S(2,p.IOscLinkService)],w)},6193:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.RenderDebouncer=void 0,o.RenderDebouncer=class{constructor(l,h){this._parentWindow=l,this._renderCallback=h,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(l){return this._refreshCallbacks.push(l),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(l,h,S){this._rowCount=S,l=l!==void 0?l:0,h=h!==void 0?h:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,h):h,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const l=Math.max(this._rowStart,0),h=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,h),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const l of this._refreshCallbacks)l(0);this._refreshCallbacks=[]}}},5596:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ScreenDprMonitor=void 0;const h=l(844);class S extends h.Disposable{constructor(p){super(),this._parentWindow=p,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,h.toDisposable)(()=>{this.clearListener()}))}setListener(p){this._listener&&this.clearListener(),this._listener=p,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var p;this._outerListener&&((p=this._resolutionMediaMatchList)===null||p===void 0||p.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}o.ScreenDprMonitor=S},3236:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Terminal=void 0;const h=l(3614),S=l(3656),a=l(6465),p=l(9042),w=l(3730),b=l(1680),m=l(3107),i=l(5744),s=l(2950),r=l(1296),n=l(428),u=l(4269),v=l(5114),C=l(8934),M=l(3230),_=l(9312),y=l(4725),I=l(6731),N=l(8055),d=l(8969),g=l(8460),x=l(844),B=l(6114),W=l(8437),H=l(2584),k=l(7399),T=l(5941),A=l(9074),P=l(2585),q=l(5435),U=l(4567),j=typeof window<"u"?window.document:null;class G extends d.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(D={}){super(D),this.browser=B,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new x.MutableDisposable),this._onCursorMove=this.register(new g.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new g.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new g.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new g.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new g.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new g.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new g.EventEmitter),this._onBlur=this.register(new g.EventEmitter),this._onA11yCharEmitter=this.register(new g.EventEmitter),this._onA11yTabEmitter=this.register(new g.EventEmitter),this._onWillOpen=this.register(new g.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(a.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(w.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(A.DecorationService),this._instantiationService.setService(P.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((Y,V)=>this.refresh(Y,V))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(Y=>this._reportWindowsOptions(Y))),this.register(this._inputHandler.onColor(Y=>this._handleColorEvent(Y))),this.register((0,g.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,g.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,g.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,g.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(Y=>this._afterResize(Y.cols,Y.rows))),this.register((0,x.toDisposable)(()=>{var Y,V;this._customKeyEventHandler=void 0,(V=(Y=this.element)===null||Y===void 0?void 0:Y.parentNode)===null||V===void 0||V.removeChild(this.element)}))}_handleColorEvent(D){if(this._themeService)for(const Y of D){let V,K="";switch(Y.index){case 256:V="foreground",K="10";break;case 257:V="background",K="11";break;case 258:V="cursor",K="12";break;default:V="ansi",K="4;"+Y.index}switch(Y.type){case 0:const ae=N.color.toColorRGB(V==="ansi"?this._themeService.colors.ansi[Y.index]:this._themeService.colors[V]);this.coreService.triggerDataEvent(`${H.C0.ESC}]${K};${(0,T.toRgbString)(ae)}${H.C1_ESCAPED.ST}`);break;case 1:if(V==="ansi")this._themeService.modifyColors(ie=>ie.ansi[Y.index]=N.rgba.toColor(...Y.color));else{const ie=V;this._themeService.modifyColors(me=>me[ie]=N.rgba.toColor(...Y.color))}break;case 2:this._themeService.restoreColor(Y.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(D){D?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(U.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(D){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(H.C0.ESC+"[I"),this.updateCursorStyle(D),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var D;return(D=this.textarea)===null||D===void 0?void 0:D.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(H.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const D=this.buffer.ybase+this.buffer.y,Y=this.buffer.lines.get(D);if(!Y)return;const V=Math.min(this.buffer.x,this.cols-1),K=this._renderService.dimensions.css.cell.height,ae=Y.getWidth(V),ie=this._renderService.dimensions.css.cell.width*ae,me=this.buffer.y*this._renderService.dimensions.css.cell.height,De=V*this._renderService.dimensions.css.cell.width;this.textarea.style.left=De+"px",this.textarea.style.top=me+"px",this.textarea.style.width=ie+"px",this.textarea.style.height=K+"px",this.textarea.style.lineHeight=K+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,S.addDisposableDomListener)(this.element,"copy",Y=>{this.hasSelection()&&(0,h.copyHandler)(Y,this._selectionService)}));const D=Y=>(0,h.handlePasteEvent)(Y,this.textarea,this.coreService,this.optionsService);this.register((0,S.addDisposableDomListener)(this.textarea,"paste",D)),this.register((0,S.addDisposableDomListener)(this.element,"paste",D)),B.isFirefox?this.register((0,S.addDisposableDomListener)(this.element,"mousedown",Y=>{Y.button===2&&(0,h.rightClickHandler)(Y,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,S.addDisposableDomListener)(this.element,"contextmenu",Y=>{(0,h.rightClickHandler)(Y,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),B.isLinux&&this.register((0,S.addDisposableDomListener)(this.element,"auxclick",Y=>{Y.button===1&&(0,h.moveTextAreaUnderMouseCursor)(Y,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,S.addDisposableDomListener)(this.textarea,"keyup",D=>this._keyUp(D),!0)),this.register((0,S.addDisposableDomListener)(this.textarea,"keydown",D=>this._keyDown(D),!0)),this.register((0,S.addDisposableDomListener)(this.textarea,"keypress",D=>this._keyPress(D),!0)),this.register((0,S.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,S.addDisposableDomListener)(this.textarea,"compositionupdate",D=>this._compositionHelper.compositionupdate(D))),this.register((0,S.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,S.addDisposableDomListener)(this.textarea,"input",D=>this._inputEvent(D),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(D){var Y;if(!D)throw new Error("Terminal requires a parent element.");D.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=D.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),D.appendChild(this.element);const V=j.createDocumentFragment();this._viewportElement=j.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),V.appendChild(this._viewportElement),this._viewportScrollArea=j.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=j.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=j.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),V.appendChild(this.screenElement),this.textarea=j.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",p.promptLabel),B.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(v.CoreBrowserService,this.textarea,(Y=this._document.defaultView)!==null&&Y!==void 0?Y:window),this._instantiationService.setService(y.ICoreBrowserService,this._coreBrowserService),this.register((0,S.addDisposableDomListener)(this.textarea,"focus",K=>this._handleTextAreaFocus(K))),this.register((0,S.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(n.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(y.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(I.ThemeService),this._instantiationService.setService(y.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(u.CharacterJoinerService),this._instantiationService.setService(y.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(M.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(y.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(K=>this._onRender.fire(K))),this.onResize(K=>this._renderService.resize(K.cols,K.rows)),this._compositionView=j.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(s.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(V);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(C.MouseService),this._instantiationService.setService(y.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(b.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(K=>this.scrollLines(K.amount,K.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(_.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(y.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(K=>this.scrollLines(K.amount,K.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(K=>this._renderService.handleSelectionChanged(K.start,K.end,K.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(K=>{this.textarea.value=K,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(K=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,S.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(m.BufferDecorationRenderer,this.screenElement)),this.register((0,S.addDisposableDomListener)(this.element,"mousedown",K=>this._selectionService.handleMouseDown(K))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(U.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",K=>this._handleScreenReaderModeOptionChange(K))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(i.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",K=>{!this._overviewRulerRenderer&&K&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(i.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(r.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const D=this,Y=this.element;function V(ie){const me=D._mouseService.getMouseReportCoords(ie,D.screenElement);if(!me)return!1;let De,Te;switch(ie.overrideType||ie.type){case"mousemove":Te=32,ie.buttons===void 0?(De=3,ie.button!==void 0&&(De=ie.button<3?ie.button:3)):De=1&ie.buttons?0:4&ie.buttons?1:2&ie.buttons?2:3;break;case"mouseup":Te=0,De=ie.button<3?ie.button:3;break;case"mousedown":Te=1,De=ie.button<3?ie.button:3;break;case"wheel":if(D.viewport.getLinesScrolled(ie)===0)return!1;Te=ie.deltaY<0?0:1,De=4;break;default:return!1}return!(Te===void 0||De===void 0||De>4)&&D.coreMouseService.triggerMouseEvent({col:me.col,row:me.row,x:me.x,y:me.y,button:De,action:Te,ctrl:ie.ctrlKey,alt:ie.altKey,shift:ie.shiftKey})}const K={mouseup:null,wheel:null,mousedrag:null,mousemove:null},ae={mouseup:ie=>(V(ie),ie.buttons||(this._document.removeEventListener("mouseup",K.mouseup),K.mousedrag&&this._document.removeEventListener("mousemove",K.mousedrag)),this.cancel(ie)),wheel:ie=>(V(ie),this.cancel(ie,!0)),mousedrag:ie=>{ie.buttons&&V(ie)},mousemove:ie=>{ie.buttons||V(ie)}};this.register(this.coreMouseService.onProtocolChange(ie=>{ie?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(ie)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&ie?K.mousemove||(Y.addEventListener("mousemove",ae.mousemove),K.mousemove=ae.mousemove):(Y.removeEventListener("mousemove",K.mousemove),K.mousemove=null),16&ie?K.wheel||(Y.addEventListener("wheel",ae.wheel,{passive:!1}),K.wheel=ae.wheel):(Y.removeEventListener("wheel",K.wheel),K.wheel=null),2&ie?K.mouseup||(Y.addEventListener("mouseup",ae.mouseup),K.mouseup=ae.mouseup):(this._document.removeEventListener("mouseup",K.mouseup),Y.removeEventListener("mouseup",K.mouseup),K.mouseup=null),4&ie?K.mousedrag||(K.mousedrag=ae.mousedrag):(this._document.removeEventListener("mousemove",K.mousedrag),K.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,S.addDisposableDomListener)(Y,"mousedown",ie=>{if(ie.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(ie))return V(ie),K.mouseup&&this._document.addEventListener("mouseup",K.mouseup),K.mousedrag&&this._document.addEventListener("mousemove",K.mousedrag),this.cancel(ie)})),this.register((0,S.addDisposableDomListener)(Y,"wheel",ie=>{if(!K.wheel){if(!this.buffer.hasScrollback){const me=this.viewport.getLinesScrolled(ie);if(me===0)return;const De=H.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(ie.deltaY<0?"A":"B");let Te="";for(let rt=0;rt<Math.abs(me);rt++)Te+=De;return this.coreService.triggerDataEvent(Te,!0),this.cancel(ie,!0)}return this.viewport.handleWheel(ie)?this.cancel(ie):void 0}},{passive:!1})),this.register((0,S.addDisposableDomListener)(Y,"touchstart",ie=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(ie),this.cancel(ie)},{passive:!0})),this.register((0,S.addDisposableDomListener)(Y,"touchmove",ie=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(ie)?void 0:this.cancel(ie)},{passive:!1}))}refresh(D,Y){var V;(V=this._renderService)===null||V===void 0||V.refreshRows(D,Y)}updateCursorStyle(D){var Y;!((Y=this._selectionService)===null||Y===void 0)&&Y.shouldColumnSelect(D)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(D,Y,V=0){var K;V===1?(super.scrollLines(D,Y,V),this.refresh(0,this.rows-1)):(K=this.viewport)===null||K===void 0||K.scrollLines(D)}paste(D){(0,h.paste)(D,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(D){this._customKeyEventHandler=D}registerLinkProvider(D){return this.linkifier2.registerLinkProvider(D)}registerCharacterJoiner(D){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const Y=this._characterJoinerService.register(D);return this.refresh(0,this.rows-1),Y}deregisterCharacterJoiner(D){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(D)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(D){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+D)}registerDecoration(D){return this._decorationService.registerDecoration(D)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(D,Y,V){this._selectionService.setSelection(D,Y,V)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var D;(D=this._selectionService)===null||D===void 0||D.clearSelection()}selectAll(){var D;(D=this._selectionService)===null||D===void 0||D.selectAll()}selectLines(D,Y){var V;(V=this._selectionService)===null||V===void 0||V.selectLines(D,Y)}_keyDown(D){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(D)===!1)return!1;const Y=this.browser.isMac&&this.options.macOptionIsMeta&&D.altKey;if(!Y&&!this._compositionHelper.keydown(D))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;Y||D.key!=="Dead"&&D.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const V=(0,k.evaluateKeyboardEvent)(D,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(D),V.type===3||V.type===2){const K=this.rows-1;return this.scrollLines(V.type===2?-K:K),this.cancel(D,!0)}return V.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,D)||(V.cancel&&this.cancel(D,!0),!V.key||!!(D.key&&!D.ctrlKey&&!D.altKey&&!D.metaKey&&D.key.length===1&&D.key.charCodeAt(0)>=65&&D.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(V.key!==H.C0.ETX&&V.key!==H.C0.CR||(this.textarea.value=""),this._onKey.fire({key:V.key,domEvent:D}),this._showCursor(),this.coreService.triggerDataEvent(V.key,!0),!this.optionsService.rawOptions.screenReaderMode||D.altKey||D.ctrlKey?this.cancel(D,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(D,Y){const V=D.isMac&&!this.options.macOptionIsMeta&&Y.altKey&&!Y.ctrlKey&&!Y.metaKey||D.isWindows&&Y.altKey&&Y.ctrlKey&&!Y.metaKey||D.isWindows&&Y.getModifierState("AltGraph");return Y.type==="keypress"?V:V&&(!Y.keyCode||Y.keyCode>47)}_keyUp(D){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(D)===!1||(function(Y){return Y.keyCode===16||Y.keyCode===17||Y.keyCode===18}(D)||this.focus(),this.updateCursorStyle(D),this._keyPressHandled=!1)}_keyPress(D){let Y;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(D)===!1)return!1;if(this.cancel(D),D.charCode)Y=D.charCode;else if(D.which===null||D.which===void 0)Y=D.keyCode;else{if(D.which===0||D.charCode===0)return!1;Y=D.which}return!(!Y||(D.altKey||D.ctrlKey||D.metaKey)&&!this._isThirdLevelShift(this.browser,D)||(Y=String.fromCharCode(Y),this._onKey.fire({key:Y,domEvent:D}),this._showCursor(),this.coreService.triggerDataEvent(Y,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(D){if(D.data&&D.inputType==="insertText"&&(!D.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const Y=D.data;return this.coreService.triggerDataEvent(Y,!0),this.cancel(D),!0}return!1}resize(D,Y){D!==this.cols||Y!==this.rows?super.resize(D,Y):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(D,Y){var V,K;(V=this._charSizeService)===null||V===void 0||V.measure(),(K=this.viewport)===null||K===void 0||K.syncScrollArea(!0)}clear(){var D;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let Y=1;Y<this.rows;Y++)this.buffer.lines.push(this.buffer.getBlankLine(W.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(D=this.viewport)===null||D===void 0||D.reset(),this.refresh(0,this.rows-1)}}reset(){var D,Y;this.options.rows=this.rows,this.options.cols=this.cols;const V=this._customKeyEventHandler;this._setup(),super.reset(),(D=this._selectionService)===null||D===void 0||D.reset(),this._decorationService.reset(),(Y=this.viewport)===null||Y===void 0||Y.reset(),this._customKeyEventHandler=V,this.refresh(0,this.rows-1)}clearTextureAtlas(){var D;(D=this._renderService)===null||D===void 0||D.clearTextureAtlas()}_reportFocus(){var D;!((D=this.element)===null||D===void 0)&&D.classList.contains("focus")?this.coreService.triggerDataEvent(H.C0.ESC+"[I"):this.coreService.triggerDataEvent(H.C0.ESC+"[O")}_reportWindowsOptions(D){if(this._renderService)switch(D){case q.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const Y=this._renderService.dimensions.css.canvas.width.toFixed(0),V=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${H.C0.ESC}[4;${V};${Y}t`);break;case q.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const K=this._renderService.dimensions.css.cell.width.toFixed(0),ae=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${H.C0.ESC}[6;${ae};${K}t`)}}cancel(D,Y){if(this.options.cancelEvents||Y)return D.preventDefault(),D.stopPropagation(),!1}}o.Terminal=G},9924:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TimeBasedDebouncer=void 0,o.TimeBasedDebouncer=class{constructor(l,h=1e3){this._renderCallback=l,this._debounceThresholdMS=h,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(l,h,S){this._rowCount=S,l=l!==void 0?l:0,h=h!==void 0?h:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,h):h;const a=Date.now();if(a-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=a,this._innerRefresh();else if(!this._additionalRefreshRequested){const p=a-this._lastRefreshMs,w=this._debounceThresholdMS-p;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},w)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const l=Math.max(this._rowStart,0),h=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,h)}}},1680:function(L,o,l){var h=this&&this.__decorate||function(s,r,n,u){var v,C=arguments.length,M=C<3?r:u===null?u=Object.getOwnPropertyDescriptor(r,n):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(s,r,n,u);else for(var _=s.length-1;_>=0;_--)(v=s[_])&&(M=(C<3?v(M):C>3?v(r,n,M):v(r,n))||M);return C>3&&M&&Object.defineProperty(r,n,M),M},S=this&&this.__param||function(s,r){return function(n,u){r(n,u,s)}};Object.defineProperty(o,"__esModule",{value:!0}),o.Viewport=void 0;const a=l(3656),p=l(4725),w=l(8460),b=l(844),m=l(2585);let i=o.Viewport=class extends b.Disposable{constructor(s,r,n,u,v,C,M,_){super(),this._viewportElement=s,this._scrollArea=r,this._bufferService=n,this._optionsService=u,this._charSizeService=v,this._renderService=C,this._coreBrowserService=M,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new w.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,a.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(y=>this._activeBuffer=y.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(y=>this._renderDimensions=y)),this._handleThemeChange(_.colors),this.register(_.onChangeColors(y=>this._handleThemeChange(y))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(s){this._viewportElement.style.backgroundColor=s.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(s){if(s)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const r=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==r&&(this._lastRecordedBufferHeight=r,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const s=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==s&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=s),this._refreshAnimationFrame=null}syncScrollArea(s=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(s);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(s)}_handleScroll(s){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const r=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:r,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const s=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(s*(this._smoothScrollState.target-this._smoothScrollState.origin)),s<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(s,r){const n=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(r<0&&this._viewportElement.scrollTop!==0||r>0&&n<this._lastRecordedBufferHeight)||(s.cancelable&&s.preventDefault(),!1)}handleWheel(s){const r=this._getPixelsScrolled(s);return r!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+r:this._smoothScrollState.target+=r,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=r,this._bubbleScroll(s,r))}scrollLines(s){if(s!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const r=s*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+r,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:s,suppressScrollEvent:!1})}_getPixelsScrolled(s){if(s.deltaY===0||s.shiftKey)return 0;let r=this._applyScrollModifier(s.deltaY,s);return s.deltaMode===WheelEvent.DOM_DELTA_LINE?r*=this._currentRowHeight:s.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(r*=this._currentRowHeight*this._bufferService.rows),r}getBufferElements(s,r){var n;let u,v="";const C=[],M=r??this._bufferService.buffer.lines.length,_=this._bufferService.buffer.lines;for(let y=s;y<M;y++){const I=_.get(y);if(!I)continue;const N=(n=_.get(y+1))===null||n===void 0?void 0:n.isWrapped;if(v+=I.translateToString(!N),!N||y===_.length-1){const d=document.createElement("div");d.textContent=v,C.push(d),v.length>0&&(u=d),v=""}}return{bufferElements:C,cursorElement:u}}getLinesScrolled(s){if(s.deltaY===0||s.shiftKey)return 0;let r=this._applyScrollModifier(s.deltaY,s);return s.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(r/=this._currentRowHeight+0,this._wheelPartialScroll+=r,r=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):s.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(r*=this._bufferService.rows),r}_applyScrollModifier(s,r){const n=this._optionsService.rawOptions.fastScrollModifier;return n==="alt"&&r.altKey||n==="ctrl"&&r.ctrlKey||n==="shift"&&r.shiftKey?s*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:s*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(s){this._lastTouchY=s.touches[0].pageY}handleTouchMove(s){const r=this._lastTouchY-s.touches[0].pageY;return this._lastTouchY=s.touches[0].pageY,r!==0&&(this._viewportElement.scrollTop+=r,this._bubbleScroll(s,r))}};o.Viewport=i=h([S(2,m.IBufferService),S(3,m.IOptionsService),S(4,p.ICharSizeService),S(5,p.IRenderService),S(6,p.ICoreBrowserService),S(7,p.IThemeService)],i)},3107:function(L,o,l){var h=this&&this.__decorate||function(i,s,r,n){var u,v=arguments.length,C=v<3?s:n===null?n=Object.getOwnPropertyDescriptor(s,r):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(i,s,r,n);else for(var M=i.length-1;M>=0;M--)(u=i[M])&&(C=(v<3?u(C):v>3?u(s,r,C):u(s,r))||C);return v>3&&C&&Object.defineProperty(s,r,C),C},S=this&&this.__param||function(i,s){return function(r,n){s(r,n,i)}};Object.defineProperty(o,"__esModule",{value:!0}),o.BufferDecorationRenderer=void 0;const a=l(3656),p=l(4725),w=l(844),b=l(2585);let m=o.BufferDecorationRenderer=class extends w.Disposable{constructor(i,s,r,n){super(),this._screenElement=i,this._bufferService=s,this._decorationService=r,this._renderService=n,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,a.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(u=>this._removeDecoration(u))),this.register((0,w.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const i of this._decorationService.decorations)this._renderDecoration(i);this._dimensionsChanged=!1}_renderDecoration(i){this._refreshStyle(i),this._dimensionsChanged&&this._refreshXPosition(i)}_createElement(i){var s,r;const n=document.createElement("div");n.classList.add("xterm-decoration"),n.classList.toggle("xterm-decoration-top-layer",((s=i?.options)===null||s===void 0?void 0:s.layer)==="top"),n.style.width=`${Math.round((i.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,n.style.height=(i.options.height||1)*this._renderService.dimensions.css.cell.height+"px",n.style.top=(i.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",n.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const u=(r=i.options.x)!==null&&r!==void 0?r:0;return u&&u>this._bufferService.cols&&(n.style.display="none"),this._refreshXPosition(i,n),n}_refreshStyle(i){const s=i.marker.line-this._bufferService.buffers.active.ydisp;if(s<0||s>=this._bufferService.rows)i.element&&(i.element.style.display="none",i.onRenderEmitter.fire(i.element));else{let r=this._decorationElements.get(i);r||(r=this._createElement(i),i.element=r,this._decorationElements.set(i,r),this._container.appendChild(r),i.onDispose(()=>{this._decorationElements.delete(i),r.remove()})),r.style.top=s*this._renderService.dimensions.css.cell.height+"px",r.style.display=this._altBufferIsActive?"none":"block",i.onRenderEmitter.fire(r)}}_refreshXPosition(i,s=i.element){var r;if(!s)return;const n=(r=i.options.x)!==null&&r!==void 0?r:0;(i.options.anchor||"left")==="right"?s.style.right=n?n*this._renderService.dimensions.css.cell.width+"px":"":s.style.left=n?n*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(i){var s;(s=this._decorationElements.get(i))===null||s===void 0||s.remove(),this._decorationElements.delete(i),i.dispose()}};o.BufferDecorationRenderer=m=h([S(1,b.IBufferService),S(2,b.IDecorationService),S(3,p.IRenderService)],m)},5871:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ColorZoneStore=void 0,o.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(l){if(l.options.overviewRulerOptions){for(const h of this._zones)if(h.color===l.options.overviewRulerOptions.color&&h.position===l.options.overviewRulerOptions.position){if(this._lineIntersectsZone(h,l.marker.line))return;if(this._lineAdjacentToZone(h,l.marker.line,l.options.overviewRulerOptions.position))return void this._addLineToZone(h,l.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=l.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=l.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=l.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=l.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:l.options.overviewRulerOptions.color,position:l.options.overviewRulerOptions.position,startBufferLine:l.marker.line,endBufferLine:l.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(l){this._linePadding=l}_lineIntersectsZone(l,h){return h>=l.startBufferLine&&h<=l.endBufferLine}_lineAdjacentToZone(l,h,S){return h>=l.startBufferLine-this._linePadding[S||"full"]&&h<=l.endBufferLine+this._linePadding[S||"full"]}_addLineToZone(l,h){l.startBufferLine=Math.min(l.startBufferLine,h),l.endBufferLine=Math.max(l.endBufferLine,h)}}},5744:function(L,o,l){var h=this&&this.__decorate||function(u,v,C,M){var _,y=arguments.length,I=y<3?v:M===null?M=Object.getOwnPropertyDescriptor(v,C):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(u,v,C,M);else for(var N=u.length-1;N>=0;N--)(_=u[N])&&(I=(y<3?_(I):y>3?_(v,C,I):_(v,C))||I);return y>3&&I&&Object.defineProperty(v,C,I),I},S=this&&this.__param||function(u,v){return function(C,M){v(C,M,u)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OverviewRulerRenderer=void 0;const a=l(5871),p=l(3656),w=l(4725),b=l(844),m=l(2585),i={full:0,left:0,center:0,right:0},s={full:0,left:0,center:0,right:0},r={full:0,left:0,center:0,right:0};let n=o.OverviewRulerRenderer=class extends b.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(u,v,C,M,_,y,I){var N;super(),this._viewportElement=u,this._screenElement=v,this._bufferService=C,this._decorationService=M,this._renderService=_,this._optionsService=y,this._coreBrowseService=I,this._colorZoneStore=new a.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(N=this._viewportElement.parentElement)===null||N===void 0||N.insertBefore(this._canvas,this._viewportElement);const d=this._canvas.getContext("2d");if(!d)throw new Error("Ctx cannot be null");this._ctx=d,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,b.toDisposable)(()=>{var g;(g=this._canvas)===null||g===void 0||g.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,p.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const u=Math.floor(this._canvas.width/3),v=Math.ceil(this._canvas.width/3);s.full=this._canvas.width,s.left=u,s.center=v,s.right=u,this._refreshDrawHeightConstants(),r.full=0,r.left=0,r.center=s.left,r.right=s.left+s.center}_refreshDrawHeightConstants(){i.full=Math.round(2*this._coreBrowseService.dpr);const u=this._canvas.height/this._bufferService.buffer.lines.length,v=Math.round(Math.max(Math.min(u,12),6)*this._coreBrowseService.dpr);i.left=v,i.center=v,i.right=v}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*i.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*i.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*i.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*i.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const v of this._decorationService.decorations)this._colorZoneStore.addDecoration(v);this._ctx.lineWidth=1;const u=this._colorZoneStore.zones;for(const v of u)v.position!=="full"&&this._renderColorZone(v);for(const v of u)v.position==="full"&&this._renderColorZone(v);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(u){this._ctx.fillStyle=u.color,this._ctx.fillRect(r[u.position||"full"],Math.round((this._canvas.height-1)*(u.startBufferLine/this._bufferService.buffers.active.lines.length)-i[u.position||"full"]/2),s[u.position||"full"],Math.round((this._canvas.height-1)*((u.endBufferLine-u.startBufferLine)/this._bufferService.buffers.active.lines.length)+i[u.position||"full"]))}_queueRefresh(u,v){this._shouldUpdateDimensions=u||this._shouldUpdateDimensions,this._shouldUpdateAnchor=v||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};o.OverviewRulerRenderer=n=h([S(2,m.IBufferService),S(3,m.IDecorationService),S(4,w.IRenderService),S(5,m.IOptionsService),S(6,w.ICoreBrowserService)],n)},2950:function(L,o,l){var h=this&&this.__decorate||function(m,i,s,r){var n,u=arguments.length,v=u<3?i:r===null?r=Object.getOwnPropertyDescriptor(i,s):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(m,i,s,r);else for(var C=m.length-1;C>=0;C--)(n=m[C])&&(v=(u<3?n(v):u>3?n(i,s,v):n(i,s))||v);return u>3&&v&&Object.defineProperty(i,s,v),v},S=this&&this.__param||function(m,i){return function(s,r){i(s,r,m)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CompositionHelper=void 0;const a=l(4725),p=l(2585),w=l(2584);let b=o.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(m,i,s,r,n,u){this._textarea=m,this._compositionView=i,this._bufferService=s,this._optionsService=r,this._coreService=n,this._renderService=u,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(m){this._compositionView.textContent=m.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(m){if(this._isComposing||this._isSendingComposition){if(m.keyCode===229||m.keyCode===16||m.keyCode===17||m.keyCode===18)return!1;this._finalizeComposition(!1)}return m.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(m){if(this._compositionView.classList.remove("active"),this._isComposing=!1,m){const i={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let s;this._isSendingComposition=!1,i.start+=this._dataAlreadySent.length,s=this._isComposing?this._textarea.value.substring(i.start,i.end):this._textarea.value.substring(i.start),s.length>0&&this._coreService.triggerDataEvent(s,!0)}},0)}else{this._isSendingComposition=!1;const i=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(i,!0)}}_handleAnyTextareaChanges(){const m=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const i=this._textarea.value,s=i.replace(m,"");this._dataAlreadySent=s,i.length>m.length?this._coreService.triggerDataEvent(s,!0):i.length<m.length?this._coreService.triggerDataEvent(`${w.C0.DEL}`,!0):i.length===m.length&&i!==m&&this._coreService.triggerDataEvent(i,!0)}},0)}updateCompositionElements(m){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const i=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),s=this._renderService.dimensions.css.cell.height,r=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,n=i*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=n+"px",this._compositionView.style.top=r+"px",this._compositionView.style.height=s+"px",this._compositionView.style.lineHeight=s+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const u=this._compositionView.getBoundingClientRect();this._textarea.style.left=n+"px",this._textarea.style.top=r+"px",this._textarea.style.width=Math.max(u.width,1)+"px",this._textarea.style.height=Math.max(u.height,1)+"px",this._textarea.style.lineHeight=u.height+"px"}m||setTimeout(()=>this.updateCompositionElements(!0),0)}}};o.CompositionHelper=b=h([S(2,p.IBufferService),S(3,p.IOptionsService),S(4,p.ICoreService),S(5,a.IRenderService)],b)},9806:(L,o)=>{function l(h,S,a){const p=a.getBoundingClientRect(),w=h.getComputedStyle(a),b=parseInt(w.getPropertyValue("padding-left")),m=parseInt(w.getPropertyValue("padding-top"));return[S.clientX-p.left-b,S.clientY-p.top-m]}Object.defineProperty(o,"__esModule",{value:!0}),o.getCoords=o.getCoordsRelativeToElement=void 0,o.getCoordsRelativeToElement=l,o.getCoords=function(h,S,a,p,w,b,m,i,s){if(!b)return;const r=l(h,S,a);return r?(r[0]=Math.ceil((r[0]+(s?m/2:0))/m),r[1]=Math.ceil(r[1]/i),r[0]=Math.min(Math.max(r[0],1),p+(s?1:0)),r[1]=Math.min(Math.max(r[1],1),w),r):void 0}},9504:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.moveToCellSequence=void 0;const h=l(2584);function S(i,s,r,n){const u=i-a(i,r),v=s-a(s,r),C=Math.abs(u-v)-function(M,_,y){let I=0;const N=M-a(M,y),d=_-a(_,y);for(let g=0;g<Math.abs(N-d);g++){const x=p(M,_)==="A"?-1:1;y.buffer.lines.get(N+x*g)?.isWrapped&&I++}return I}(i,s,r);return m(C,b(p(i,s),n))}function a(i,s){let r=0,n=s.buffer.lines.get(i),u=n?.isWrapped;for(;u&&i>=0&&i<s.rows;)r++,n=s.buffer.lines.get(--i),u=n?.isWrapped;return r}function p(i,s){return i>s?"A":"B"}function w(i,s,r,n,u,v){let C=i,M=s,_="";for(;C!==r||M!==n;)C+=u?1:-1,u&&C>v.cols-1?(_+=v.buffer.translateBufferLineToString(M,!1,i,C),C=0,i=0,M++):!u&&C<0&&(_+=v.buffer.translateBufferLineToString(M,!1,0,i+1),C=v.cols-1,i=C,M--);return _+v.buffer.translateBufferLineToString(M,!1,i,C)}function b(i,s){const r=s?"O":"[";return h.C0.ESC+r+i}function m(i,s){i=Math.floor(i);let r="";for(let n=0;n<i;n++)r+=s;return r}o.moveToCellSequence=function(i,s,r,n){const u=r.buffer.x,v=r.buffer.y;if(!r.buffer.hasScrollback)return function(_,y,I,N,d,g){return S(y,N,d,g).length===0?"":m(w(_,y,_,y-a(y,d),!1,d).length,b("D",g))}(u,v,0,s,r,n)+S(v,s,r,n)+function(_,y,I,N,d,g){let x;x=S(y,N,d,g).length>0?N-a(N,d):y;const B=N,W=function(H,k,T,A,P,q){let U;return U=S(T,A,P,q).length>0?A-a(A,P):k,H<T&&U<=A||H>=T&&U<A?"C":"D"}(_,y,I,N,d,g);return m(w(_,x,I,B,W==="C",d).length,b(W,g))}(u,v,i,s,r,n);let C;if(v===s)return C=u>i?"D":"C",m(Math.abs(u-i),b(C,n));C=v>s?"D":"C";const M=Math.abs(v-s);return m(function(_,y){return y.cols-_}(v>s?i:u,r)+(M-1)*r.cols+1+((v>s?u:i)-1),b(C,n))}},1296:function(L,o,l){var h=this&&this.__decorate||function(d,g,x,B){var W,H=arguments.length,k=H<3?g:B===null?B=Object.getOwnPropertyDescriptor(g,x):B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(d,g,x,B);else for(var T=d.length-1;T>=0;T--)(W=d[T])&&(k=(H<3?W(k):H>3?W(g,x,k):W(g,x))||k);return H>3&&k&&Object.defineProperty(g,x,k),k},S=this&&this.__param||function(d,g){return function(x,B){g(x,B,d)}};Object.defineProperty(o,"__esModule",{value:!0}),o.DomRenderer=void 0;const a=l(3787),p=l(2550),w=l(2223),b=l(6171),m=l(4725),i=l(8055),s=l(8460),r=l(844),n=l(2585),u="xterm-dom-renderer-owner-",v="xterm-rows",C="xterm-fg-",M="xterm-bg-",_="xterm-focus",y="xterm-selection";let I=1,N=o.DomRenderer=class extends r.Disposable{constructor(d,g,x,B,W,H,k,T,A,P){super(),this._element=d,this._screenElement=g,this._viewportElement=x,this._linkifier2=B,this._charSizeService=H,this._optionsService=k,this._bufferService=T,this._coreBrowserService=A,this._themeService=P,this._terminalClass=I++,this._rowElements=[],this.onRequestRedraw=this.register(new s.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add(v),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add(y),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,b.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(q=>this._injectCss(q))),this._injectCss(this._themeService.colors),this._rowFactory=W.createInstance(a.DomRendererRowFactory,document),this._element.classList.add(u+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(q=>this._handleLinkHover(q))),this.register(this._linkifier2.onHideLinkUnderline(q=>this._handleLinkLeave(q))),this.register((0,r.toDisposable)(()=>{this._element.classList.remove(u+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new p.WidthCache(document),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const d=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*d,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*d),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/d),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/d),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const x of this._rowElements)x.style.width=`${this.dimensions.css.canvas.width}px`,x.style.height=`${this.dimensions.css.cell.height}px`,x.style.lineHeight=`${this.dimensions.css.cell.height}px`,x.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const g=`${this._terminalSelector} .${v} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=g,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(d){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let g=`${this._terminalSelector} .${v} { color: ${d.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;g+=`${this._terminalSelector} .${v} .xterm-dim { color: ${i.color.multiplyOpacity(d.foreground,.5).css};}`,g+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`,g+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",g+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${d.cursor.css};  color: ${d.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${d.cursor.css}; }}`,g+=`${this._terminalSelector} .${v}.${_} .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${v}.${_} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${v} .xterm-cursor.xterm-cursor-block { background-color: ${d.cursor.css}; color: ${d.cursorAccent.css};}${this._terminalSelector} .${v} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${d.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${v} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${d.cursor.css} inset;}${this._terminalSelector} .${v} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${d.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,g+=`${this._terminalSelector} .${y} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${y} div { position: absolute; background-color: ${d.selectionBackgroundOpaque.css};}${this._terminalSelector} .${y} div { position: absolute; background-color: ${d.selectionInactiveBackgroundOpaque.css};}`;for(const[x,B]of d.ansi.entries())g+=`${this._terminalSelector} .${C}${x} { color: ${B.css}; }${this._terminalSelector} .${C}${x}.xterm-dim { color: ${i.color.multiplyOpacity(B,.5).css}; }${this._terminalSelector} .${M}${x} { background-color: ${B.css}; }`;g+=`${this._terminalSelector} .${C}${w.INVERTED_DEFAULT_COLOR} { color: ${i.color.opaque(d.background).css}; }${this._terminalSelector} .${C}${w.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${i.color.multiplyOpacity(i.color.opaque(d.background),.5).css}; }${this._terminalSelector} .${M}${w.INVERTED_DEFAULT_COLOR} { background-color: ${d.foreground.css}; }`,this._themeStyleElement.textContent=g}_setDefaultSpacing(){const d=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${d}px`,this._rowFactory.defaultSpacing=d}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(d,g){for(let x=this._rowElements.length;x<=g;x++){const B=document.createElement("div");this._rowContainer.appendChild(B),this._rowElements.push(B)}for(;this._rowElements.length>g;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(d,g){this._refreshRowElements(d,g),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(_)}handleFocus(){this._rowContainer.classList.add(_),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(d,g,x){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(d,g,x),this.renderRows(0,this._bufferService.rows-1),!d||!g)return;const B=d[1]-this._bufferService.buffer.ydisp,W=g[1]-this._bufferService.buffer.ydisp,H=Math.max(B,0),k=Math.min(W,this._bufferService.rows-1);if(H>=this._bufferService.rows||k<0)return;const T=document.createDocumentFragment();if(x){const A=d[0]>g[0];T.appendChild(this._createSelectionElement(H,A?g[0]:d[0],A?d[0]:g[0],k-H+1))}else{const A=B===H?d[0]:0,P=H===W?g[0]:this._bufferService.cols;T.appendChild(this._createSelectionElement(H,A,P));const q=k-H-1;if(T.appendChild(this._createSelectionElement(H+1,0,this._bufferService.cols,q)),H!==k){const U=W===k?g[0]:this._bufferService.cols;T.appendChild(this._createSelectionElement(k,0,U))}}this._selectionContainer.appendChild(T)}_createSelectionElement(d,g,x,B=1){const W=document.createElement("div");return W.style.height=B*this.dimensions.css.cell.height+"px",W.style.top=d*this.dimensions.css.cell.height+"px",W.style.left=g*this.dimensions.css.cell.width+"px",W.style.width=this.dimensions.css.cell.width*(x-g)+"px",W}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const d of this._rowElements)d.replaceChildren()}renderRows(d,g){const x=this._bufferService.buffer,B=x.ybase+x.y,W=Math.min(x.x,this._bufferService.cols-1),H=this._optionsService.rawOptions.cursorBlink,k=this._optionsService.rawOptions.cursorStyle,T=this._optionsService.rawOptions.cursorInactiveStyle;for(let A=d;A<=g;A++){const P=A+x.ydisp,q=this._rowElements[A],U=x.lines.get(P);if(!q||!U)break;q.replaceChildren(...this._rowFactory.createRow(U,P,P===B,k,T,W,H,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${u}${this._terminalClass}`}_handleLinkHover(d){this._setCellUnderline(d.x1,d.x2,d.y1,d.y2,d.cols,!0)}_handleLinkLeave(d){this._setCellUnderline(d.x1,d.x2,d.y1,d.y2,d.cols,!1)}_setCellUnderline(d,g,x,B,W,H){x<0&&(d=0),B<0&&(g=0);const k=this._bufferService.rows-1;x=Math.max(Math.min(x,k),0),B=Math.max(Math.min(B,k),0),W=Math.min(W,this._bufferService.cols);const T=this._bufferService.buffer,A=T.ybase+T.y,P=Math.min(T.x,W-1),q=this._optionsService.rawOptions.cursorBlink,U=this._optionsService.rawOptions.cursorStyle,j=this._optionsService.rawOptions.cursorInactiveStyle;for(let G=x;G<=B;++G){const Q=G+T.ydisp,D=this._rowElements[G],Y=T.lines.get(Q);if(!D||!Y)break;D.replaceChildren(...this._rowFactory.createRow(Y,Q,Q===A,U,j,P,q,this.dimensions.css.cell.width,this._widthCache,H?G===x?d:0:-1,H?(G===B?g:W)-1:-1))}}};o.DomRenderer=N=h([S(4,n.IInstantiationService),S(5,m.ICharSizeService),S(6,n.IOptionsService),S(7,n.IBufferService),S(8,m.ICoreBrowserService),S(9,m.IThemeService)],N)},3787:function(L,o,l){var h=this&&this.__decorate||function(C,M,_,y){var I,N=arguments.length,d=N<3?M:y===null?y=Object.getOwnPropertyDescriptor(M,_):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(C,M,_,y);else for(var g=C.length-1;g>=0;g--)(I=C[g])&&(d=(N<3?I(d):N>3?I(M,_,d):I(M,_))||d);return N>3&&d&&Object.defineProperty(M,_,d),d},S=this&&this.__param||function(C,M){return function(_,y){M(_,y,C)}};Object.defineProperty(o,"__esModule",{value:!0}),o.DomRendererRowFactory=void 0;const a=l(2223),p=l(643),w=l(511),b=l(2585),m=l(8055),i=l(4725),s=l(4269),r=l(6171),n=l(3734);let u=o.DomRendererRowFactory=class{constructor(C,M,_,y,I,N,d){this._document=C,this._characterJoinerService=M,this._optionsService=_,this._coreBrowserService=y,this._coreService=I,this._decorationService=N,this._themeService=d,this._workCell=new w.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(C,M,_){this._selectionStart=C,this._selectionEnd=M,this._columnSelectMode=_}createRow(C,M,_,y,I,N,d,g,x,B,W){const H=[],k=this._characterJoinerService.getJoinedCharacters(M),T=this._themeService.colors;let A,P=C.getNoBgTrimmedLength();_&&P<N+1&&(P=N+1);let q=0,U="",j=0,G=0,Q=0,D=!1,Y=0,V=!1,K=0;const ae=[],ie=B!==-1&&W!==-1;for(let me=0;me<P;me++){C.loadCell(me,this._workCell);let De=this._workCell.getWidth();if(De===0)continue;let Te=!1,rt=me,_e=this._workCell;if(k.length>0&&me===k[0][0]){Te=!0;const Me=k.shift();_e=new s.JoinedCellData(this._workCell,C.translateToString(!0,Me[0],Me[1]),Me[1]-Me[0]),rt=Me[1]-1,De=_e.getWidth()}const dt=this._isCellInSelection(me,M),X=_&&me===N,Z=ie&&me>=B&&me<=W;let ve=!1;this._decorationService.forEachDecorationAtCell(me,M,void 0,Me=>{ve=!0});let ge=_e.getChars()||p.WHITESPACE_CELL_CHAR;if(ge===" "&&(_e.isUnderline()||_e.isOverline())&&(ge="\xA0"),K=De*g-x.get(ge,_e.isBold(),_e.isItalic()),A){if(q&&(dt&&V||!dt&&!V&&_e.bg===j)&&(dt&&V&&T.selectionForeground||_e.fg===G)&&_e.extended.ext===Q&&Z===D&&K===Y&&!X&&!Te&&!ve){U+=ge,q++;continue}q&&(A.textContent=U),A=this._document.createElement("span"),q=0,U=""}else A=this._document.createElement("span");if(j=_e.bg,G=_e.fg,Q=_e.extended.ext,D=Z,Y=K,V=dt,Te&&N>=me&&N<=rt&&(N=me),!this._coreService.isCursorHidden&&X){if(ae.push("xterm-cursor"),this._coreBrowserService.isFocused)d&&ae.push("xterm-cursor-blink"),ae.push(y==="bar"?"xterm-cursor-bar":y==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(I)switch(I){case"outline":ae.push("xterm-cursor-outline");break;case"block":ae.push("xterm-cursor-block");break;case"bar":ae.push("xterm-cursor-bar");break;case"underline":ae.push("xterm-cursor-underline")}}if(_e.isBold()&&ae.push("xterm-bold"),_e.isItalic()&&ae.push("xterm-italic"),_e.isDim()&&ae.push("xterm-dim"),U=_e.isInvisible()?p.WHITESPACE_CELL_CHAR:_e.getChars()||p.WHITESPACE_CELL_CHAR,_e.isUnderline()&&(ae.push(`xterm-underline-${_e.extended.underlineStyle}`),U===" "&&(U="\xA0"),!_e.isUnderlineColorDefault()))if(_e.isUnderlineColorRGB())A.style.textDecorationColor=`rgb(${n.AttributeData.toColorRGB(_e.getUnderlineColor()).join(",")})`;else{let Me=_e.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&_e.isBold()&&Me<8&&(Me+=8),A.style.textDecorationColor=T.ansi[Me].css}_e.isOverline()&&(ae.push("xterm-overline"),U===" "&&(U="\xA0")),_e.isStrikethrough()&&ae.push("xterm-strikethrough"),Z&&(A.style.textDecoration="underline");let Pe=_e.getFgColor(),ee=_e.getFgColorMode(),re=_e.getBgColor(),ue=_e.getBgColorMode();const pe=!!_e.isInverse();if(pe){const Me=Pe;Pe=re,re=Me;const ot=ee;ee=ue,ue=ot}let Ve,Dt,Ge,nt=!1;switch(this._decorationService.forEachDecorationAtCell(me,M,void 0,Me=>{Me.options.layer!=="top"&&nt||(Me.backgroundColorRGB&&(ue=50331648,re=Me.backgroundColorRGB.rgba>>8&16777215,Ve=Me.backgroundColorRGB),Me.foregroundColorRGB&&(ee=50331648,Pe=Me.foregroundColorRGB.rgba>>8&16777215,Dt=Me.foregroundColorRGB),nt=Me.options.layer==="top")}),!nt&&dt&&(Ve=this._coreBrowserService.isFocused?T.selectionBackgroundOpaque:T.selectionInactiveBackgroundOpaque,re=Ve.rgba>>8&16777215,ue=50331648,nt=!0,T.selectionForeground&&(ee=50331648,Pe=T.selectionForeground.rgba>>8&16777215,Dt=T.selectionForeground)),nt&&ae.push("xterm-decoration-top"),ue){case 16777216:case 33554432:Ge=T.ansi[re],ae.push(`xterm-bg-${re}`);break;case 50331648:Ge=m.rgba.toColor(re>>16,re>>8&255,255&re),this._addStyle(A,`background-color:#${v((re>>>0).toString(16),"0",6)}`);break;default:pe?(Ge=T.foreground,ae.push(`xterm-bg-${a.INVERTED_DEFAULT_COLOR}`)):Ge=T.background}switch(Ve||_e.isDim()&&(Ve=m.color.multiplyOpacity(Ge,.5)),ee){case 16777216:case 33554432:_e.isBold()&&Pe<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(Pe+=8),this._applyMinimumContrast(A,Ge,T.ansi[Pe],_e,Ve,void 0)||ae.push(`xterm-fg-${Pe}`);break;case 50331648:const Me=m.rgba.toColor(Pe>>16&255,Pe>>8&255,255&Pe);this._applyMinimumContrast(A,Ge,Me,_e,Ve,Dt)||this._addStyle(A,`color:#${v(Pe.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(A,Ge,T.foreground,_e,Ve,void 0)||pe&&ae.push(`xterm-fg-${a.INVERTED_DEFAULT_COLOR}`)}ae.length&&(A.className=ae.join(" "),ae.length=0),X||Te||ve?A.textContent=U:q++,K!==this.defaultSpacing&&(A.style.letterSpacing=`${K}px`),H.push(A),me=rt}return A&&q&&(A.textContent=U),H}_applyMinimumContrast(C,M,_,y,I,N){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,r.excludeFromContrastRatioDemands)(y.getCode()))return!1;const d=this._getContrastCache(y);let g;if(I||N||(g=d.getColor(M.rgba,_.rgba)),g===void 0){const x=this._optionsService.rawOptions.minimumContrastRatio/(y.isDim()?2:1);g=m.color.ensureContrastRatio(I||M,N||_,x),d.setColor((I||M).rgba,(N||_).rgba,g??null)}return!!g&&(this._addStyle(C,`color:${g.css}`),!0)}_getContrastCache(C){return C.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(C,M){C.setAttribute("style",`${C.getAttribute("style")||""}${M};`)}_isCellInSelection(C,M){const _=this._selectionStart,y=this._selectionEnd;return!(!_||!y)&&(this._columnSelectMode?_[0]<=y[0]?C>=_[0]&&M>=_[1]&&C<y[0]&&M<=y[1]:C<_[0]&&M>=_[1]&&C>=y[0]&&M<=y[1]:M>_[1]&&M<y[1]||_[1]===y[1]&&M===_[1]&&C>=_[0]&&C<y[0]||_[1]<y[1]&&M===y[1]&&C<y[0]||_[1]<y[1]&&M===_[1]&&C>=_[0])}};function v(C,M,_){for(;C.length<_;)C=M+C;return C}o.DomRendererRowFactory=u=h([S(1,i.ICharacterJoinerService),S(2,b.IOptionsService),S(3,i.ICoreBrowserService),S(4,b.ICoreService),S(5,b.IDecorationService),S(6,i.IThemeService)],u)},2550:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WidthCache=void 0,o.WidthCache=class{constructor(l){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=l.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const h=l.createElement("span"),S=l.createElement("span");S.style.fontWeight="bold";const a=l.createElement("span");a.style.fontStyle="italic";const p=l.createElement("span");p.style.fontWeight="bold",p.style.fontStyle="italic",this._measureElements=[h,S,a,p],this._container.appendChild(h),this._container.appendChild(S),this._container.appendChild(a),this._container.appendChild(p),l.body.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(l,h,S,a){l===this._font&&h===this._fontSize&&S===this._weight&&a===this._weightBold||(this._font=l,this._fontSize=h,this._weight=S,this._weightBold=a,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${S}`,this._measureElements[1].style.fontWeight=`${a}`,this._measureElements[2].style.fontWeight=`${S}`,this._measureElements[3].style.fontWeight=`${a}`,this.clear())}get(l,h,S){let a=0;if(!h&&!S&&l.length===1&&(a=l.charCodeAt(0))<256)return this._flat[a]!==-9999?this._flat[a]:this._flat[a]=this._measure(l,0);let p=l;h&&(p+="B"),S&&(p+="I");let w=this._holey.get(p);if(w===void 0){let b=0;h&&(b|=1),S&&(b|=2),w=this._measure(l,b),this._holey.set(p,w)}return w}_measure(l,h){const S=this._measureElements[h];return S.textContent=l.repeat(32),S.offsetWidth/32}}},2223:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TEXT_BASELINE=o.DIM_OPACITY=o.INVERTED_DEFAULT_COLOR=void 0;const h=l(6114);o.INVERTED_DEFAULT_COLOR=257,o.DIM_OPACITY=.5,o.TEXT_BASELINE=h.isFirefox||h.isLegacyEdge?"bottom":"ideographic"},6171:(L,o)=>{function l(h){return 57508<=h&&h<=57558}Object.defineProperty(o,"__esModule",{value:!0}),o.createRenderDimensions=o.excludeFromContrastRatioDemands=o.isRestrictedPowerlineGlyph=o.isPowerlineGlyph=o.throwIfFalsy=void 0,o.throwIfFalsy=function(h){if(!h)throw new Error("value must not be falsy");return h},o.isPowerlineGlyph=l,o.isRestrictedPowerlineGlyph=function(h){return 57520<=h&&h<=57527},o.excludeFromContrastRatioDemands=function(h){return l(h)||function(S){return 9472<=S&&S<=9631}(h)},o.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.SelectionModel=void 0,o.SelectionModel=class{constructor(l){this._bufferService=l,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?l%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)-1]:[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[l,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[Math.max(l,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const l=this.selectionStart,h=this.selectionEnd;return!(!l||!h)&&(l[1]>h[1]||l[1]===h[1]&&l[0]>h[0])}handleTrim(l){return this.selectionStart&&(this.selectionStart[1]-=l),this.selectionEnd&&(this.selectionEnd[1]-=l),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(L,o,l){var h=this&&this.__decorate||function(i,s,r,n){var u,v=arguments.length,C=v<3?s:n===null?n=Object.getOwnPropertyDescriptor(s,r):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(i,s,r,n);else for(var M=i.length-1;M>=0;M--)(u=i[M])&&(C=(v<3?u(C):v>3?u(s,r,C):u(s,r))||C);return v>3&&C&&Object.defineProperty(s,r,C),C},S=this&&this.__param||function(i,s){return function(r,n){s(r,n,i)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CharSizeService=void 0;const a=l(2585),p=l(8460),w=l(844);let b=o.CharSizeService=class extends w.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(i,s,r){super(),this._optionsService=r,this.width=0,this.height=0,this._onCharSizeChange=this.register(new p.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new m(i,s,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const i=this._measureStrategy.measure();i.width===this.width&&i.height===this.height||(this.width=i.width,this.height=i.height,this._onCharSizeChange.fire())}};o.CharSizeService=b=h([S(2,a.IOptionsService)],b);class m{constructor(s,r,n){this._document=s,this._parentElement=r,this._optionsService=n,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const s={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return s.width!==0&&s.height!==0&&(this._result.width=s.width/32,this._result.height=Math.ceil(s.height)),this._result}}},4269:function(L,o,l){var h=this&&this.__decorate||function(s,r,n,u){var v,C=arguments.length,M=C<3?r:u===null?u=Object.getOwnPropertyDescriptor(r,n):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(s,r,n,u);else for(var _=s.length-1;_>=0;_--)(v=s[_])&&(M=(C<3?v(M):C>3?v(r,n,M):v(r,n))||M);return C>3&&M&&Object.defineProperty(r,n,M),M},S=this&&this.__param||function(s,r){return function(n,u){r(n,u,s)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CharacterJoinerService=o.JoinedCellData=void 0;const a=l(3734),p=l(643),w=l(511),b=l(2585);class m extends a.AttributeData{constructor(r,n,u){super(),this.content=0,this.combinedData="",this.fg=r.fg,this.bg=r.bg,this.combinedData=n,this._width=u}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(r){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}o.JoinedCellData=m;let i=o.CharacterJoinerService=class Hr{constructor(r){this._bufferService=r,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new w.CellData}register(r){const n={id:this._nextCharacterJoinerId++,handler:r};return this._characterJoiners.push(n),n.id}deregister(r){for(let n=0;n<this._characterJoiners.length;n++)if(this._characterJoiners[n].id===r)return this._characterJoiners.splice(n,1),!0;return!1}getJoinedCharacters(r){if(this._characterJoiners.length===0)return[];const n=this._bufferService.buffer.lines.get(r);if(!n||n.length===0)return[];const u=[],v=n.translateToString(!0);let C=0,M=0,_=0,y=n.getFg(0),I=n.getBg(0);for(let N=0;N<n.getTrimmedLength();N++)if(n.loadCell(N,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==y||this._workCell.bg!==I){if(N-C>1){const d=this._getJoinedRanges(v,_,M,n,C);for(let g=0;g<d.length;g++)u.push(d[g])}C=N,_=M,y=this._workCell.fg,I=this._workCell.bg}M+=this._workCell.getChars().length||p.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-C>1){const N=this._getJoinedRanges(v,_,M,n,C);for(let d=0;d<N.length;d++)u.push(N[d])}return u}_getJoinedRanges(r,n,u,v,C){const M=r.substring(n,u);let _=[];try{_=this._characterJoiners[0].handler(M)}catch(y){console.error(y)}for(let y=1;y<this._characterJoiners.length;y++)try{const I=this._characterJoiners[y].handler(M);for(let N=0;N<I.length;N++)Hr._mergeRanges(_,I[N])}catch(I){console.error(I)}return this._stringRangesToCellRanges(_,v,C),_}_stringRangesToCellRanges(r,n,u){let v=0,C=!1,M=0,_=r[v];if(_){for(let y=u;y<this._bufferService.cols;y++){const I=n.getWidth(y),N=n.getString(y).length||p.WHITESPACE_CELL_CHAR.length;if(I!==0){if(!C&&_[0]<=M&&(_[0]=y,C=!0),_[1]<=M){if(_[1]=y,_=r[++v],!_)break;_[0]<=M?(_[0]=y,C=!0):C=!1}M+=N}}_&&(_[1]=this._bufferService.cols)}}static _mergeRanges(r,n){let u=!1;for(let v=0;v<r.length;v++){const C=r[v];if(u){if(n[1]<=C[0])return r[v-1][1]=n[1],r;if(n[1]<=C[1])return r[v-1][1]=Math.max(n[1],C[1]),r.splice(v,1),r;r.splice(v,1),v--}else{if(n[1]<=C[0])return r.splice(v,0,n),r;if(n[1]<=C[1])return C[0]=Math.min(n[0],C[0]),r;n[0]<C[1]&&(C[0]=Math.min(n[0],C[0]),u=!0)}}return u?r[r.length-1][1]=n[1]:r.push(n),r}};o.CharacterJoinerService=i=h([S(0,b.IBufferService)],i)},5114:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CoreBrowserService=void 0,o.CoreBrowserService=class{constructor(l,h){this._textarea=l,this.window=h,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(L,o,l){var h=this&&this.__decorate||function(b,m,i,s){var r,n=arguments.length,u=n<3?m:s===null?s=Object.getOwnPropertyDescriptor(m,i):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(b,m,i,s);else for(var v=b.length-1;v>=0;v--)(r=b[v])&&(u=(n<3?r(u):n>3?r(m,i,u):r(m,i))||u);return n>3&&u&&Object.defineProperty(m,i,u),u},S=this&&this.__param||function(b,m){return function(i,s){m(i,s,b)}};Object.defineProperty(o,"__esModule",{value:!0}),o.MouseService=void 0;const a=l(4725),p=l(9806);let w=o.MouseService=class{constructor(b,m){this._renderService=b,this._charSizeService=m}getCoords(b,m,i,s,r){return(0,p.getCoords)(window,b,m,i,s,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,r)}getMouseReportCoords(b,m){const i=(0,p.getCoordsRelativeToElement)(window,b,m);if(this._charSizeService.hasValidSize)return i[0]=Math.min(Math.max(i[0],0),this._renderService.dimensions.css.canvas.width-1),i[1]=Math.min(Math.max(i[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(i[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(i[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(i[0]),y:Math.floor(i[1])}}};o.MouseService=w=h([S(0,a.IRenderService),S(1,a.ICharSizeService)],w)},3230:function(L,o,l){var h=this&&this.__decorate||function(u,v,C,M){var _,y=arguments.length,I=y<3?v:M===null?M=Object.getOwnPropertyDescriptor(v,C):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(u,v,C,M);else for(var N=u.length-1;N>=0;N--)(_=u[N])&&(I=(y<3?_(I):y>3?_(v,C,I):_(v,C))||I);return y>3&&I&&Object.defineProperty(v,C,I),I},S=this&&this.__param||function(u,v){return function(C,M){v(C,M,u)}};Object.defineProperty(o,"__esModule",{value:!0}),o.RenderService=void 0;const a=l(3656),p=l(6193),w=l(5596),b=l(4725),m=l(8460),i=l(844),s=l(7226),r=l(2585);let n=o.RenderService=class extends i.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(u,v,C,M,_,y,I,N){if(super(),this._rowCount=u,this._charSizeService=M,this._renderer=this.register(new i.MutableDisposable),this._pausedResizeTask=new s.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new m.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new m.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new m.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new m.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new p.RenderDebouncer(I.window,(d,g)=>this._renderRows(d,g)),this.register(this._renderDebouncer),this._screenDprMonitor=new w.ScreenDprMonitor(I.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(y.onResize(()=>this._fullRefresh())),this.register(y.buffers.onBufferActivate(()=>{var d;return(d=this._renderer.value)===null||d===void 0?void 0:d.clear()})),this.register(C.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(_.onDecorationRegistered(()=>this._fullRefresh())),this.register(_.onDecorationRemoved(()=>this._fullRefresh())),this.register(C.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(y.cols,y.rows),this._fullRefresh()})),this.register(C.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(y.buffer.y,y.buffer.y,!0))),this.register((0,a.addDisposableDomListener)(I.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(N.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in I.window){const d=new I.window.IntersectionObserver(g=>this._handleIntersectionChange(g[g.length-1]),{threshold:0});d.observe(v),this.register({dispose:()=>d.disconnect()})}}_handleIntersectionChange(u){this._isPaused=u.isIntersecting===void 0?u.intersectionRatio===0:!u.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(u,v,C=!1){this._isPaused?this._needsFullRefresh=!0:(C||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(u,v,this._rowCount))}_renderRows(u,v){this._renderer.value&&(u=Math.min(u,this._rowCount-1),v=Math.min(v,this._rowCount-1),this._renderer.value.renderRows(u,v),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:u,end:v}),this._onRender.fire({start:u,end:v}),this._isNextRenderRedrawOnly=!0)}resize(u,v){this._rowCount=v,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(u){this._renderer.value=u,this._renderer.value.onRequestRedraw(v=>this.refreshRows(v.start,v.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(u){return this._renderDebouncer.addRefreshCallback(u)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var u,v;this._renderer.value&&((v=(u=this._renderer.value).clearTextureAtlas)===null||v===void 0||v.call(u),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(u,v){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value.handleResize(u,v)):this._renderer.value.handleResize(u,v),this._fullRefresh())}handleCharSizeChanged(){var u;(u=this._renderer.value)===null||u===void 0||u.handleCharSizeChanged()}handleBlur(){var u;(u=this._renderer.value)===null||u===void 0||u.handleBlur()}handleFocus(){var u;(u=this._renderer.value)===null||u===void 0||u.handleFocus()}handleSelectionChanged(u,v,C){var M;this._selectionState.start=u,this._selectionState.end=v,this._selectionState.columnSelectMode=C,(M=this._renderer.value)===null||M===void 0||M.handleSelectionChanged(u,v,C)}handleCursorMove(){var u;(u=this._renderer.value)===null||u===void 0||u.handleCursorMove()}clear(){var u;(u=this._renderer.value)===null||u===void 0||u.clear()}};o.RenderService=n=h([S(2,r.IOptionsService),S(3,b.ICharSizeService),S(4,r.IDecorationService),S(5,r.IBufferService),S(6,b.ICoreBrowserService),S(7,b.IThemeService)],n)},9312:function(L,o,l){var h=this&&this.__decorate||function(_,y,I,N){var d,g=arguments.length,x=g<3?y:N===null?N=Object.getOwnPropertyDescriptor(y,I):N;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(_,y,I,N);else for(var B=_.length-1;B>=0;B--)(d=_[B])&&(x=(g<3?d(x):g>3?d(y,I,x):d(y,I))||x);return g>3&&x&&Object.defineProperty(y,I,x),x},S=this&&this.__param||function(_,y){return function(I,N){y(I,N,_)}};Object.defineProperty(o,"__esModule",{value:!0}),o.SelectionService=void 0;const a=l(9806),p=l(9504),w=l(456),b=l(4725),m=l(8460),i=l(844),s=l(6114),r=l(4841),n=l(511),u=l(2585),v=String.fromCharCode(160),C=new RegExp(v,"g");let M=o.SelectionService=class extends i.Disposable{constructor(_,y,I,N,d,g,x,B,W){super(),this._element=_,this._screenElement=y,this._linkifier=I,this._bufferService=N,this._coreService=d,this._mouseService=g,this._optionsService=x,this._renderService=B,this._coreBrowserService=W,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new n.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new m.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new m.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new m.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new m.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=H=>this._handleMouseMove(H),this._mouseUpListener=H=>this._handleMouseUp(H),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(H=>this._handleTrim(H)),this.register(this._bufferService.buffers.onBufferActivate(H=>this._handleBufferActivate(H))),this.enable(),this._model=new w.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,i.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const _=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;return!(!_||!y||_[0]===y[0]&&_[1]===y[1])}get selectionText(){const _=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;if(!_||!y)return"";const I=this._bufferService.buffer,N=[];if(this._activeSelectionMode===3){if(_[0]===y[0])return"";const d=_[0]<y[0]?_[0]:y[0],g=_[0]<y[0]?y[0]:_[0];for(let x=_[1];x<=y[1];x++){const B=I.translateBufferLineToString(x,!0,d,g);N.push(B)}}else{const d=_[1]===y[1]?y[0]:void 0;N.push(I.translateBufferLineToString(_[1],!0,_[0],d));for(let g=_[1]+1;g<=y[1]-1;g++){const x=I.lines.get(g),B=I.translateBufferLineToString(g,!0);x?.isWrapped?N[N.length-1]+=B:N.push(B)}if(_[1]!==y[1]){const g=I.lines.get(y[1]),x=I.translateBufferLineToString(y[1],!0,0,y[0]);g&&g.isWrapped?N[N.length-1]+=x:N.push(x)}}return N.map(d=>d.replace(C," ")).join(s.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(_){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),s.isLinux&&_&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(_){const y=this._getMouseBufferCoords(_),I=this._model.finalSelectionStart,N=this._model.finalSelectionEnd;return!!(I&&N&&y)&&this._areCoordsInSelection(y,I,N)}isCellInSelection(_,y){const I=this._model.finalSelectionStart,N=this._model.finalSelectionEnd;return!(!I||!N)&&this._areCoordsInSelection([_,y],I,N)}_areCoordsInSelection(_,y,I){return _[1]>y[1]&&_[1]<I[1]||y[1]===I[1]&&_[1]===y[1]&&_[0]>=y[0]&&_[0]<I[0]||y[1]<I[1]&&_[1]===I[1]&&_[0]<I[0]||y[1]<I[1]&&_[1]===y[1]&&_[0]>=y[0]}_selectWordAtCursor(_,y){var I,N;const d=(N=(I=this._linkifier.currentLink)===null||I===void 0?void 0:I.link)===null||N===void 0?void 0:N.range;if(d)return this._model.selectionStart=[d.start.x-1,d.start.y-1],this._model.selectionStartLength=(0,r.getRangeLength)(d,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const g=this._getMouseBufferCoords(_);return!!g&&(this._selectWordAt(g,y),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(_,y){this._model.clearSelection(),_=Math.max(_,0),y=Math.min(y,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,_],this._model.selectionEnd=[this._bufferService.cols,y],this.refresh(),this._onSelectionChange.fire()}_handleTrim(_){this._model.handleTrim(_)&&this.refresh()}_getMouseBufferCoords(_){const y=this._mouseService.getCoords(_,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(y)return y[0]--,y[1]--,y[1]+=this._bufferService.buffer.ydisp,y}_getMouseEventScrollAmount(_){let y=(0,a.getCoordsRelativeToElement)(this._coreBrowserService.window,_,this._screenElement)[1];const I=this._renderService.dimensions.css.canvas.height;return y>=0&&y<=I?0:(y>I&&(y-=I),y=Math.min(Math.max(y,-50),50),y/=50,y/Math.abs(y)+Math.round(14*y))}shouldForceSelection(_){return s.isMac?_.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:_.shiftKey}handleMouseDown(_){if(this._mouseDownTimeStamp=_.timeStamp,(_.button!==2||!this.hasSelection)&&_.button===0){if(!this._enabled){if(!this.shouldForceSelection(_))return;_.stopPropagation()}_.preventDefault(),this._dragScrollAmount=0,this._enabled&&_.shiftKey?this._handleIncrementalClick(_):_.detail===1?this._handleSingleClick(_):_.detail===2?this._handleDoubleClick(_):_.detail===3&&this._handleTripleClick(_),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(_){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(_))}_handleSingleClick(_){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(_)?3:0,this._model.selectionStart=this._getMouseBufferCoords(_),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const y=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);y&&y.length!==this._model.selectionStart[0]&&y.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(_){this._selectWordAtCursor(_,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(_){const y=this._getMouseBufferCoords(_);y&&(this._activeSelectionMode=2,this._selectLineAt(y[1]))}shouldColumnSelect(_){return _.altKey&&!(s.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(_){if(_.stopImmediatePropagation(),!this._model.selectionStart)return;const y=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(_),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(_),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const I=this._bufferService.buffer;if(this._model.selectionEnd[1]<I.lines.length){const N=I.lines.get(this._model.selectionEnd[1]);N&&N.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}y&&y[0]===this._model.selectionEnd[0]&&y[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const _=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(_.ydisp+this._bufferService.rows,_.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=_.ydisp),this.refresh()}}_handleMouseUp(_){const y=_.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&y<500&&_.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const I=this._mouseService.getCoords(_,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(I&&I[0]!==void 0&&I[1]!==void 0){const N=(0,p.moveToCellSequence)(I[0]-1,I[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(N,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const _=this._model.finalSelectionStart,y=this._model.finalSelectionEnd,I=!(!_||!y||_[0]===y[0]&&_[1]===y[1]);I?_&&y&&(this._oldSelectionStart&&this._oldSelectionEnd&&_[0]===this._oldSelectionStart[0]&&_[1]===this._oldSelectionStart[1]&&y[0]===this._oldSelectionEnd[0]&&y[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(_,y,I)):this._oldHasSelection&&this._fireOnSelectionChange(_,y,I)}_fireOnSelectionChange(_,y,I){this._oldSelectionStart=_,this._oldSelectionEnd=y,this._oldHasSelection=I,this._onSelectionChange.fire()}_handleBufferActivate(_){this.clearSelection(),this._trimListener.dispose(),this._trimListener=_.activeBuffer.lines.onTrim(y=>this._handleTrim(y))}_convertViewportColToCharacterIndex(_,y){let I=y;for(let N=0;y>=N;N++){const d=_.loadCell(N,this._workCell).getChars().length;this._workCell.getWidth()===0?I--:d>1&&y!==N&&(I+=d-1)}return I}setSelection(_,y,I){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[_,y],this._model.selectionStartLength=I,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(_){this._isClickInSelection(_)||(this._selectWordAtCursor(_,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(_,y,I=!0,N=!0){if(_[0]>=this._bufferService.cols)return;const d=this._bufferService.buffer,g=d.lines.get(_[1]);if(!g)return;const x=d.translateBufferLineToString(_[1],!1);let B=this._convertViewportColToCharacterIndex(g,_[0]),W=B;const H=_[0]-B;let k=0,T=0,A=0,P=0;if(x.charAt(B)===" "){for(;B>0&&x.charAt(B-1)===" ";)B--;for(;W<x.length&&x.charAt(W+1)===" ";)W++}else{let j=_[0],G=_[0];g.getWidth(j)===0&&(k++,j--),g.getWidth(G)===2&&(T++,G++);const Q=g.getString(G).length;for(Q>1&&(P+=Q-1,W+=Q-1);j>0&&B>0&&!this._isCharWordSeparator(g.loadCell(j-1,this._workCell));){g.loadCell(j-1,this._workCell);const D=this._workCell.getChars().length;this._workCell.getWidth()===0?(k++,j--):D>1&&(A+=D-1,B-=D-1),B--,j--}for(;G<g.length&&W+1<x.length&&!this._isCharWordSeparator(g.loadCell(G+1,this._workCell));){g.loadCell(G+1,this._workCell);const D=this._workCell.getChars().length;this._workCell.getWidth()===2?(T++,G++):D>1&&(P+=D-1,W+=D-1),W++,G++}}W++;let q=B+H-k+A,U=Math.min(this._bufferService.cols,W-B+k+T-A-P);if(y||x.slice(B,W).trim()!==""){if(I&&q===0&&g.getCodePoint(0)!==32){const j=d.lines.get(_[1]-1);if(j&&g.isWrapped&&j.getCodePoint(this._bufferService.cols-1)!==32){const G=this._getWordAt([this._bufferService.cols-1,_[1]-1],!1,!0,!1);if(G){const Q=this._bufferService.cols-G.start;q-=Q,U+=Q}}}if(N&&q+U===this._bufferService.cols&&g.getCodePoint(this._bufferService.cols-1)!==32){const j=d.lines.get(_[1]+1);if(j?.isWrapped&&j.getCodePoint(0)!==32){const G=this._getWordAt([0,_[1]+1],!1,!1,!0);G&&(U+=G.length)}}return{start:q,length:U}}}_selectWordAt(_,y){const I=this._getWordAt(_,y);if(I){for(;I.start<0;)I.start+=this._bufferService.cols,_[1]--;this._model.selectionStart=[I.start,_[1]],this._model.selectionStartLength=I.length}}_selectToWordAt(_){const y=this._getWordAt(_,!0);if(y){let I=_[1];for(;y.start<0;)y.start+=this._bufferService.cols,I--;if(!this._model.areSelectionValuesReversed())for(;y.start+y.length>this._bufferService.cols;)y.length-=this._bufferService.cols,I++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?y.start:y.start+y.length,I]}}_isCharWordSeparator(_){return _.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(_.getChars())>=0}_selectLineAt(_){const y=this._bufferService.buffer.getWrappedRangeForLine(_),I={start:{x:0,y:y.first},end:{x:this._bufferService.cols-1,y:y.last}};this._model.selectionStart=[0,y.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,r.getRangeLength)(I,this._bufferService.cols)}};o.SelectionService=M=h([S(3,u.IBufferService),S(4,u.ICoreService),S(5,b.IMouseService),S(6,u.IOptionsService),S(7,b.IRenderService),S(8,b.ICoreBrowserService)],M)},4725:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.IThemeService=o.ICharacterJoinerService=o.ISelectionService=o.IRenderService=o.IMouseService=o.ICoreBrowserService=o.ICharSizeService=void 0;const h=l(8343);o.ICharSizeService=(0,h.createDecorator)("CharSizeService"),o.ICoreBrowserService=(0,h.createDecorator)("CoreBrowserService"),o.IMouseService=(0,h.createDecorator)("MouseService"),o.IRenderService=(0,h.createDecorator)("RenderService"),o.ISelectionService=(0,h.createDecorator)("SelectionService"),o.ICharacterJoinerService=(0,h.createDecorator)("CharacterJoinerService"),o.IThemeService=(0,h.createDecorator)("ThemeService")},6731:function(L,o,l){var h=this&&this.__decorate||function(M,_,y,I){var N,d=arguments.length,g=d<3?_:I===null?I=Object.getOwnPropertyDescriptor(_,y):I;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(M,_,y,I);else for(var x=M.length-1;x>=0;x--)(N=M[x])&&(g=(d<3?N(g):d>3?N(_,y,g):N(_,y))||g);return d>3&&g&&Object.defineProperty(_,y,g),g},S=this&&this.__param||function(M,_){return function(y,I){_(y,I,M)}};Object.defineProperty(o,"__esModule",{value:!0}),o.ThemeService=o.DEFAULT_ANSI_COLORS=void 0;const a=l(7239),p=l(8055),w=l(8460),b=l(844),m=l(2585),i=p.css.toColor("#ffffff"),s=p.css.toColor("#000000"),r=p.css.toColor("#ffffff"),n=p.css.toColor("#000000"),u={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};o.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const M=[p.css.toColor("#2e3436"),p.css.toColor("#cc0000"),p.css.toColor("#4e9a06"),p.css.toColor("#c4a000"),p.css.toColor("#3465a4"),p.css.toColor("#75507b"),p.css.toColor("#06989a"),p.css.toColor("#d3d7cf"),p.css.toColor("#555753"),p.css.toColor("#ef2929"),p.css.toColor("#8ae234"),p.css.toColor("#fce94f"),p.css.toColor("#729fcf"),p.css.toColor("#ad7fa8"),p.css.toColor("#34e2e2"),p.css.toColor("#eeeeec")],_=[0,95,135,175,215,255];for(let y=0;y<216;y++){const I=_[y/36%6|0],N=_[y/6%6|0],d=_[y%6];M.push({css:p.channels.toCss(I,N,d),rgba:p.channels.toRgba(I,N,d)})}for(let y=0;y<24;y++){const I=8+10*y;M.push({css:p.channels.toCss(I,I,I),rgba:p.channels.toRgba(I,I,I)})}return M})());let v=o.ThemeService=class extends b.Disposable{get colors(){return this._colors}constructor(M){super(),this._optionsService=M,this._contrastCache=new a.ColorContrastCache,this._halfContrastCache=new a.ColorContrastCache,this._onChangeColors=this.register(new w.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:i,background:s,cursor:r,cursorAccent:n,selectionForeground:void 0,selectionBackgroundTransparent:u,selectionBackgroundOpaque:p.color.blend(s,u),selectionInactiveBackgroundTransparent:u,selectionInactiveBackgroundOpaque:p.color.blend(s,u),ansi:o.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(M={}){const _=this._colors;if(_.foreground=C(M.foreground,i),_.background=C(M.background,s),_.cursor=C(M.cursor,r),_.cursorAccent=C(M.cursorAccent,n),_.selectionBackgroundTransparent=C(M.selectionBackground,u),_.selectionBackgroundOpaque=p.color.blend(_.background,_.selectionBackgroundTransparent),_.selectionInactiveBackgroundTransparent=C(M.selectionInactiveBackground,_.selectionBackgroundTransparent),_.selectionInactiveBackgroundOpaque=p.color.blend(_.background,_.selectionInactiveBackgroundTransparent),_.selectionForeground=M.selectionForeground?C(M.selectionForeground,p.NULL_COLOR):void 0,_.selectionForeground===p.NULL_COLOR&&(_.selectionForeground=void 0),p.color.isOpaque(_.selectionBackgroundTransparent)&&(_.selectionBackgroundTransparent=p.color.opacity(_.selectionBackgroundTransparent,.3)),p.color.isOpaque(_.selectionInactiveBackgroundTransparent)&&(_.selectionInactiveBackgroundTransparent=p.color.opacity(_.selectionInactiveBackgroundTransparent,.3)),_.ansi=o.DEFAULT_ANSI_COLORS.slice(),_.ansi[0]=C(M.black,o.DEFAULT_ANSI_COLORS[0]),_.ansi[1]=C(M.red,o.DEFAULT_ANSI_COLORS[1]),_.ansi[2]=C(M.green,o.DEFAULT_ANSI_COLORS[2]),_.ansi[3]=C(M.yellow,o.DEFAULT_ANSI_COLORS[3]),_.ansi[4]=C(M.blue,o.DEFAULT_ANSI_COLORS[4]),_.ansi[5]=C(M.magenta,o.DEFAULT_ANSI_COLORS[5]),_.ansi[6]=C(M.cyan,o.DEFAULT_ANSI_COLORS[6]),_.ansi[7]=C(M.white,o.DEFAULT_ANSI_COLORS[7]),_.ansi[8]=C(M.brightBlack,o.DEFAULT_ANSI_COLORS[8]),_.ansi[9]=C(M.brightRed,o.DEFAULT_ANSI_COLORS[9]),_.ansi[10]=C(M.brightGreen,o.DEFAULT_ANSI_COLORS[10]),_.ansi[11]=C(M.brightYellow,o.DEFAULT_ANSI_COLORS[11]),_.ansi[12]=C(M.brightBlue,o.DEFAULT_ANSI_COLORS[12]),_.ansi[13]=C(M.brightMagenta,o.DEFAULT_ANSI_COLORS[13]),_.ansi[14]=C(M.brightCyan,o.DEFAULT_ANSI_COLORS[14]),_.ansi[15]=C(M.brightWhite,o.DEFAULT_ANSI_COLORS[15]),M.extendedAnsi){const y=Math.min(_.ansi.length-16,M.extendedAnsi.length);for(let I=0;I<y;I++)_.ansi[I+16]=C(M.extendedAnsi[I],o.DEFAULT_ANSI_COLORS[I+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(M){this._restoreColor(M),this._onChangeColors.fire(this.colors)}_restoreColor(M){if(M!==void 0)switch(M){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[M]=this._restoreColors.ansi[M]}else for(let _=0;_<this._restoreColors.ansi.length;++_)this._colors.ansi[_]=this._restoreColors.ansi[_]}modifyColors(M){M(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function C(M,_){if(M!==void 0)try{return p.css.toColor(M)}catch{}return _}o.ThemeService=v=h([S(0,m.IOptionsService)],v)},6349:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CircularList=void 0;const h=l(8460),S=l(844);class a extends S.Disposable{constructor(w){super(),this._maxLength=w,this.onDeleteEmitter=this.register(new h.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new h.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new h.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(w){if(this._maxLength===w)return;const b=new Array(w);for(let m=0;m<Math.min(w,this.length);m++)b[m]=this._array[this._getCyclicIndex(m)];this._array=b,this._maxLength=w,this._startIndex=0}get length(){return this._length}set length(w){if(w>this._length)for(let b=this._length;b<w;b++)this._array[b]=void 0;this._length=w}get(w){return this._array[this._getCyclicIndex(w)]}set(w,b){this._array[this._getCyclicIndex(w)]=b}push(w){this._array[this._getCyclicIndex(this._length)]=w,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(w,b,...m){if(b){for(let i=w;i<this._length-b;i++)this._array[this._getCyclicIndex(i)]=this._array[this._getCyclicIndex(i+b)];this._length-=b,this.onDeleteEmitter.fire({index:w,amount:b})}for(let i=this._length-1;i>=w;i--)this._array[this._getCyclicIndex(i+m.length)]=this._array[this._getCyclicIndex(i)];for(let i=0;i<m.length;i++)this._array[this._getCyclicIndex(w+i)]=m[i];if(m.length&&this.onInsertEmitter.fire({index:w,amount:m.length}),this._length+m.length>this._maxLength){const i=this._length+m.length-this._maxLength;this._startIndex+=i,this._length=this._maxLength,this.onTrimEmitter.fire(i)}else this._length+=m.length}trimStart(w){w>this._length&&(w=this._length),this._startIndex+=w,this._length-=w,this.onTrimEmitter.fire(w)}shiftElements(w,b,m){if(!(b<=0)){if(w<0||w>=this._length)throw new Error("start argument out of range");if(w+m<0)throw new Error("Cannot shift elements in list beyond index 0");if(m>0){for(let s=b-1;s>=0;s--)this.set(w+s+m,this.get(w+s));const i=w+b+m-this._length;if(i>0)for(this._length+=i;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let i=0;i<b;i++)this.set(w+i+m,this.get(w+i))}}_getCyclicIndex(w){return(this._startIndex+w)%this._maxLength}}o.CircularList=a},1439:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.clone=void 0,o.clone=function l(h,S=5){if(typeof h!="object")return h;const a=Array.isArray(h)?[]:{};for(const p in h)a[p]=S<=1?h[p]:h[p]&&l(h[p],S-1);return a}},8055:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.contrastRatio=o.toPaddedHex=o.rgba=o.rgb=o.css=o.color=o.channels=o.NULL_COLOR=void 0;const h=l(6114);let S=0,a=0,p=0,w=0;var b,m,i,s,r;function n(v){const C=v.toString(16);return C.length<2?"0"+C:C}function u(v,C){return v<C?(C+.05)/(v+.05):(v+.05)/(C+.05)}o.NULL_COLOR={css:"#00000000",rgba:0},function(v){v.toCss=function(C,M,_,y){return y!==void 0?`#${n(C)}${n(M)}${n(_)}${n(y)}`:`#${n(C)}${n(M)}${n(_)}`},v.toRgba=function(C,M,_,y=255){return(C<<24|M<<16|_<<8|y)>>>0}}(b||(o.channels=b={})),function(v){function C(M,_){return w=Math.round(255*_),[S,a,p]=r.toChannels(M.rgba),{css:b.toCss(S,a,p,w),rgba:b.toRgba(S,a,p,w)}}v.blend=function(M,_){if(w=(255&_.rgba)/255,w===1)return{css:_.css,rgba:_.rgba};const y=_.rgba>>24&255,I=_.rgba>>16&255,N=_.rgba>>8&255,d=M.rgba>>24&255,g=M.rgba>>16&255,x=M.rgba>>8&255;return S=d+Math.round((y-d)*w),a=g+Math.round((I-g)*w),p=x+Math.round((N-x)*w),{css:b.toCss(S,a,p),rgba:b.toRgba(S,a,p)}},v.isOpaque=function(M){return(255&M.rgba)==255},v.ensureContrastRatio=function(M,_,y){const I=r.ensureContrastRatio(M.rgba,_.rgba,y);if(I)return r.toColor(I>>24&255,I>>16&255,I>>8&255)},v.opaque=function(M){const _=(255|M.rgba)>>>0;return[S,a,p]=r.toChannels(_),{css:b.toCss(S,a,p),rgba:_}},v.opacity=C,v.multiplyOpacity=function(M,_){return w=255&M.rgba,C(M,w*_/255)},v.toColorRGB=function(M){return[M.rgba>>24&255,M.rgba>>16&255,M.rgba>>8&255]}}(m||(o.color=m={})),function(v){let C,M;if(!h.isNode){const _=document.createElement("canvas");_.width=1,_.height=1;const y=_.getContext("2d",{willReadFrequently:!0});y&&(C=y,C.globalCompositeOperation="copy",M=C.createLinearGradient(0,0,1,1))}v.toColor=function(_){if(_.match(/#[\da-f]{3,8}/i))switch(_.length){case 4:return S=parseInt(_.slice(1,2).repeat(2),16),a=parseInt(_.slice(2,3).repeat(2),16),p=parseInt(_.slice(3,4).repeat(2),16),r.toColor(S,a,p);case 5:return S=parseInt(_.slice(1,2).repeat(2),16),a=parseInt(_.slice(2,3).repeat(2),16),p=parseInt(_.slice(3,4).repeat(2),16),w=parseInt(_.slice(4,5).repeat(2),16),r.toColor(S,a,p,w);case 7:return{css:_,rgba:(parseInt(_.slice(1),16)<<8|255)>>>0};case 9:return{css:_,rgba:parseInt(_.slice(1),16)>>>0}}const y=_.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(y)return S=parseInt(y[1]),a=parseInt(y[2]),p=parseInt(y[3]),w=Math.round(255*(y[5]===void 0?1:parseFloat(y[5]))),r.toColor(S,a,p,w);if(!C||!M)throw new Error("css.toColor: Unsupported css format");if(C.fillStyle=M,C.fillStyle=_,typeof C.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(C.fillRect(0,0,1,1),[S,a,p,w]=C.getImageData(0,0,1,1).data,w!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:b.toRgba(S,a,p,w),css:_}}}(i||(o.css=i={})),function(v){function C(M,_,y){const I=M/255,N=_/255,d=y/255;return .2126*(I<=.03928?I/12.92:Math.pow((I+.055)/1.055,2.4))+.7152*(N<=.03928?N/12.92:Math.pow((N+.055)/1.055,2.4))+.0722*(d<=.03928?d/12.92:Math.pow((d+.055)/1.055,2.4))}v.relativeLuminance=function(M){return C(M>>16&255,M>>8&255,255&M)},v.relativeLuminance2=C}(s||(o.rgb=s={})),function(v){function C(_,y,I){const N=_>>24&255,d=_>>16&255,g=_>>8&255;let x=y>>24&255,B=y>>16&255,W=y>>8&255,H=u(s.relativeLuminance2(x,B,W),s.relativeLuminance2(N,d,g));for(;H<I&&(x>0||B>0||W>0);)x-=Math.max(0,Math.ceil(.1*x)),B-=Math.max(0,Math.ceil(.1*B)),W-=Math.max(0,Math.ceil(.1*W)),H=u(s.relativeLuminance2(x,B,W),s.relativeLuminance2(N,d,g));return(x<<24|B<<16|W<<8|255)>>>0}function M(_,y,I){const N=_>>24&255,d=_>>16&255,g=_>>8&255;let x=y>>24&255,B=y>>16&255,W=y>>8&255,H=u(s.relativeLuminance2(x,B,W),s.relativeLuminance2(N,d,g));for(;H<I&&(x<255||B<255||W<255);)x=Math.min(255,x+Math.ceil(.1*(255-x))),B=Math.min(255,B+Math.ceil(.1*(255-B))),W=Math.min(255,W+Math.ceil(.1*(255-W))),H=u(s.relativeLuminance2(x,B,W),s.relativeLuminance2(N,d,g));return(x<<24|B<<16|W<<8|255)>>>0}v.ensureContrastRatio=function(_,y,I){const N=s.relativeLuminance(_>>8),d=s.relativeLuminance(y>>8);if(u(N,d)<I){if(d<N){const B=C(_,y,I),W=u(N,s.relativeLuminance(B>>8));if(W<I){const H=M(_,y,I);return W>u(N,s.relativeLuminance(H>>8))?B:H}return B}const g=M(_,y,I),x=u(N,s.relativeLuminance(g>>8));if(x<I){const B=C(_,y,I);return x>u(N,s.relativeLuminance(B>>8))?g:B}return g}},v.reduceLuminance=C,v.increaseLuminance=M,v.toChannels=function(_){return[_>>24&255,_>>16&255,_>>8&255,255&_]},v.toColor=function(_,y,I,N){return{css:b.toCss(_,y,I,N),rgba:b.toRgba(_,y,I,N)}}}(r||(o.rgba=r={})),o.toPaddedHex=n,o.contrastRatio=u},8969:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CoreTerminal=void 0;const h=l(844),S=l(2585),a=l(4348),p=l(7866),w=l(744),b=l(7302),m=l(6975),i=l(8460),s=l(1753),r=l(1480),n=l(7994),u=l(9282),v=l(5435),C=l(5981),M=l(2660);let _=!1;class y extends h.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new i.EventEmitter),this._onScroll.event(N=>{var d;(d=this._onScrollApi)===null||d===void 0||d.fire(N.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(N){for(const d in N)this.optionsService.options[d]=N[d]}constructor(N){super(),this._windowsWrappingHeuristics=this.register(new h.MutableDisposable),this._onBinary=this.register(new i.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new i.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new i.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new i.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new i.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new i.EventEmitter),this._instantiationService=new a.InstantiationService,this.optionsService=this.register(new b.OptionsService(N)),this._instantiationService.setService(S.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(w.BufferService)),this._instantiationService.setService(S.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(p.LogService)),this._instantiationService.setService(S.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(m.CoreService)),this._instantiationService.setService(S.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(s.CoreMouseService)),this._instantiationService.setService(S.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(r.UnicodeService)),this._instantiationService.setService(S.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(n.CharsetService),this._instantiationService.setService(S.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(M.OscLinkService),this._instantiationService.setService(S.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new v.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,i.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,i.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,i.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,i.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(d=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(d=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new C.WriteBuffer((d,g)=>this._inputHandler.parse(d,g))),this.register((0,i.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(N,d){this._writeBuffer.write(N,d)}writeSync(N,d){this._logService.logLevel<=S.LogLevelEnum.WARN&&!_&&(this._logService.warn("writeSync is unreliable and will be removed soon."),_=!0),this._writeBuffer.writeSync(N,d)}resize(N,d){isNaN(N)||isNaN(d)||(N=Math.max(N,w.MINIMUM_COLS),d=Math.max(d,w.MINIMUM_ROWS),this._bufferService.resize(N,d))}scroll(N,d=!1){this._bufferService.scroll(N,d)}scrollLines(N,d,g){this._bufferService.scrollLines(N,d,g)}scrollPages(N){this.scrollLines(N*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(N){const d=N-this._bufferService.buffer.ydisp;d!==0&&this.scrollLines(d)}registerEscHandler(N,d){return this._inputHandler.registerEscHandler(N,d)}registerDcsHandler(N,d){return this._inputHandler.registerDcsHandler(N,d)}registerCsiHandler(N,d){return this._inputHandler.registerCsiHandler(N,d)}registerOscHandler(N,d){return this._inputHandler.registerOscHandler(N,d)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let N=!1;const d=this.optionsService.rawOptions.windowsPty;d&&d.buildNumber!==void 0&&d.buildNumber!==void 0?N=d.backend==="conpty"&&d.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(N=!0),N?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const N=[];N.push(this.onLineFeed(u.updateWindowsModeWrappedState.bind(null,this._bufferService))),N.push(this.registerCsiHandler({final:"H"},()=>((0,u.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,h.toDisposable)(()=>{for(const d of N)d.dispose()})}}}o.CoreTerminal=y},8460:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.forwardEvent=o.EventEmitter=void 0,o.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=l=>(this._listeners.push(l),{dispose:()=>{if(!this._disposed){for(let h=0;h<this._listeners.length;h++)if(this._listeners[h]===l)return void this._listeners.splice(h,1)}}})),this._event}fire(l,h){const S=[];for(let a=0;a<this._listeners.length;a++)S.push(this._listeners[a]);for(let a=0;a<S.length;a++)S[a].call(void 0,l,h)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},o.forwardEvent=function(l,h){return l(S=>h.fire(S))}},5435:function(L,o,l){var h=this&&this.__decorate||function(H,k,T,A){var P,q=arguments.length,U=q<3?k:A===null?A=Object.getOwnPropertyDescriptor(k,T):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(H,k,T,A);else for(var j=H.length-1;j>=0;j--)(P=H[j])&&(U=(q<3?P(U):q>3?P(k,T,U):P(k,T))||U);return q>3&&U&&Object.defineProperty(k,T,U),U},S=this&&this.__param||function(H,k){return function(T,A){k(T,A,H)}};Object.defineProperty(o,"__esModule",{value:!0}),o.InputHandler=o.WindowsOptionsReportType=void 0;const a=l(2584),p=l(7116),w=l(2015),b=l(844),m=l(482),i=l(8437),s=l(8460),r=l(643),n=l(511),u=l(3734),v=l(2585),C=l(6242),M=l(6351),_=l(5941),y={"(":0,")":1,"*":2,"+":3,"-":1,".":2},I=131072;function N(H,k){if(H>24)return k.setWinLines||!1;switch(H){case 1:return!!k.restoreWin;case 2:return!!k.minimizeWin;case 3:return!!k.setWinPosition;case 4:return!!k.setWinSizePixels;case 5:return!!k.raiseWin;case 6:return!!k.lowerWin;case 7:return!!k.refreshWin;case 8:return!!k.setWinSizeChars;case 9:return!!k.maximizeWin;case 10:return!!k.fullscreenWin;case 11:return!!k.getWinState;case 13:return!!k.getWinPosition;case 14:return!!k.getWinSizePixels;case 15:return!!k.getScreenSizePixels;case 16:return!!k.getCellSizePixels;case 18:return!!k.getWinSizeChars;case 19:return!!k.getScreenSizeChars;case 20:return!!k.getIconTitle;case 21:return!!k.getWinTitle;case 22:return!!k.pushTitle;case 23:return!!k.popTitle;case 24:return!!k.setWinLines}return!1}var d;(function(H){H[H.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",H[H.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(d||(o.WindowsOptionsReportType=d={}));let g=0;class x extends b.Disposable{getAttrData(){return this._curAttrData}constructor(k,T,A,P,q,U,j,G,Q=new w.EscapeSequenceParser){super(),this._bufferService=k,this._charsetService=T,this._coreService=A,this._logService=P,this._optionsService=q,this._oscLinkService=U,this._coreMouseService=j,this._unicodeService=G,this._parser=Q,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new m.StringToUtf32,this._utf8Decoder=new m.Utf8ToUtf32,this._workCell=new n.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=i.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new s.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new s.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new s.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new s.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new s.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new s.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new s.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new s.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new s.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new s.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new s.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new s.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new s.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new B(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(D=>this._activeBuffer=D.activeBuffer)),this._parser.setCsiHandlerFallback((D,Y)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(D),params:Y.toArray()})}),this._parser.setEscHandlerFallback(D=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(D)})}),this._parser.setExecuteHandlerFallback(D=>{this._logService.debug("Unknown EXECUTE code: ",{code:D})}),this._parser.setOscHandlerFallback((D,Y,V)=>{this._logService.debug("Unknown OSC code: ",{identifier:D,action:Y,data:V})}),this._parser.setDcsHandlerFallback((D,Y,V)=>{Y==="HOOK"&&(V=V.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(D),action:Y,payload:V})}),this._parser.setPrintHandler((D,Y,V)=>this.print(D,Y,V)),this._parser.registerCsiHandler({final:"@"},D=>this.insertChars(D)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},D=>this.scrollLeft(D)),this._parser.registerCsiHandler({final:"A"},D=>this.cursorUp(D)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},D=>this.scrollRight(D)),this._parser.registerCsiHandler({final:"B"},D=>this.cursorDown(D)),this._parser.registerCsiHandler({final:"C"},D=>this.cursorForward(D)),this._parser.registerCsiHandler({final:"D"},D=>this.cursorBackward(D)),this._parser.registerCsiHandler({final:"E"},D=>this.cursorNextLine(D)),this._parser.registerCsiHandler({final:"F"},D=>this.cursorPrecedingLine(D)),this._parser.registerCsiHandler({final:"G"},D=>this.cursorCharAbsolute(D)),this._parser.registerCsiHandler({final:"H"},D=>this.cursorPosition(D)),this._parser.registerCsiHandler({final:"I"},D=>this.cursorForwardTab(D)),this._parser.registerCsiHandler({final:"J"},D=>this.eraseInDisplay(D,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},D=>this.eraseInDisplay(D,!0)),this._parser.registerCsiHandler({final:"K"},D=>this.eraseInLine(D,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},D=>this.eraseInLine(D,!0)),this._parser.registerCsiHandler({final:"L"},D=>this.insertLines(D)),this._parser.registerCsiHandler({final:"M"},D=>this.deleteLines(D)),this._parser.registerCsiHandler({final:"P"},D=>this.deleteChars(D)),this._parser.registerCsiHandler({final:"S"},D=>this.scrollUp(D)),this._parser.registerCsiHandler({final:"T"},D=>this.scrollDown(D)),this._parser.registerCsiHandler({final:"X"},D=>this.eraseChars(D)),this._parser.registerCsiHandler({final:"Z"},D=>this.cursorBackwardTab(D)),this._parser.registerCsiHandler({final:"`"},D=>this.charPosAbsolute(D)),this._parser.registerCsiHandler({final:"a"},D=>this.hPositionRelative(D)),this._parser.registerCsiHandler({final:"b"},D=>this.repeatPrecedingCharacter(D)),this._parser.registerCsiHandler({final:"c"},D=>this.sendDeviceAttributesPrimary(D)),this._parser.registerCsiHandler({prefix:">",final:"c"},D=>this.sendDeviceAttributesSecondary(D)),this._parser.registerCsiHandler({final:"d"},D=>this.linePosAbsolute(D)),this._parser.registerCsiHandler({final:"e"},D=>this.vPositionRelative(D)),this._parser.registerCsiHandler({final:"f"},D=>this.hVPosition(D)),this._parser.registerCsiHandler({final:"g"},D=>this.tabClear(D)),this._parser.registerCsiHandler({final:"h"},D=>this.setMode(D)),this._parser.registerCsiHandler({prefix:"?",final:"h"},D=>this.setModePrivate(D)),this._parser.registerCsiHandler({final:"l"},D=>this.resetMode(D)),this._parser.registerCsiHandler({prefix:"?",final:"l"},D=>this.resetModePrivate(D)),this._parser.registerCsiHandler({final:"m"},D=>this.charAttributes(D)),this._parser.registerCsiHandler({final:"n"},D=>this.deviceStatus(D)),this._parser.registerCsiHandler({prefix:"?",final:"n"},D=>this.deviceStatusPrivate(D)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},D=>this.softReset(D)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},D=>this.setCursorStyle(D)),this._parser.registerCsiHandler({final:"r"},D=>this.setScrollRegion(D)),this._parser.registerCsiHandler({final:"s"},D=>this.saveCursor(D)),this._parser.registerCsiHandler({final:"t"},D=>this.windowOptions(D)),this._parser.registerCsiHandler({final:"u"},D=>this.restoreCursor(D)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},D=>this.insertColumns(D)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},D=>this.deleteColumns(D)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},D=>this.selectProtected(D)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},D=>this.requestMode(D,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},D=>this.requestMode(D,!1)),this._parser.setExecuteHandler(a.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(a.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(a.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(a.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(a.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(a.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(a.C1.IND,()=>this.index()),this._parser.setExecuteHandler(a.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(a.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new C.OscHandler(D=>(this.setTitle(D),this.setIconName(D),!0))),this._parser.registerOscHandler(1,new C.OscHandler(D=>this.setIconName(D))),this._parser.registerOscHandler(2,new C.OscHandler(D=>this.setTitle(D))),this._parser.registerOscHandler(4,new C.OscHandler(D=>this.setOrReportIndexedColor(D))),this._parser.registerOscHandler(8,new C.OscHandler(D=>this.setHyperlink(D))),this._parser.registerOscHandler(10,new C.OscHandler(D=>this.setOrReportFgColor(D))),this._parser.registerOscHandler(11,new C.OscHandler(D=>this.setOrReportBgColor(D))),this._parser.registerOscHandler(12,new C.OscHandler(D=>this.setOrReportCursorColor(D))),this._parser.registerOscHandler(104,new C.OscHandler(D=>this.restoreIndexedColor(D))),this._parser.registerOscHandler(110,new C.OscHandler(D=>this.restoreFgColor(D))),this._parser.registerOscHandler(111,new C.OscHandler(D=>this.restoreBgColor(D))),this._parser.registerOscHandler(112,new C.OscHandler(D=>this.restoreCursorColor(D))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const D in p.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:D},()=>this.selectCharset("("+D)),this._parser.registerEscHandler({intermediates:")",final:D},()=>this.selectCharset(")"+D)),this._parser.registerEscHandler({intermediates:"*",final:D},()=>this.selectCharset("*"+D)),this._parser.registerEscHandler({intermediates:"+",final:D},()=>this.selectCharset("+"+D)),this._parser.registerEscHandler({intermediates:"-",final:D},()=>this.selectCharset("-"+D)),this._parser.registerEscHandler({intermediates:".",final:D},()=>this.selectCharset("."+D)),this._parser.registerEscHandler({intermediates:"/",final:D},()=>this.selectCharset("/"+D));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(D=>(this._logService.error("Parsing error: ",D),D)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new M.DcsHandler((D,Y)=>this.requestStatusString(D,Y)))}_preserveStack(k,T,A,P){this._parseStack.paused=!0,this._parseStack.cursorStartX=k,this._parseStack.cursorStartY=T,this._parseStack.decodedLength=A,this._parseStack.position=P}_logSlowResolvingAsync(k){this._logService.logLevel<=v.LogLevelEnum.WARN&&Promise.race([k,new Promise((T,A)=>setTimeout(()=>A("#SLOW_TIMEOUT"),5e3))]).catch(T=>{if(T!=="#SLOW_TIMEOUT")throw T;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(k,T){let A,P=this._activeBuffer.x,q=this._activeBuffer.y,U=0;const j=this._parseStack.paused;if(j){if(A=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,T))return this._logSlowResolvingAsync(A),A;P=this._parseStack.cursorStartX,q=this._parseStack.cursorStartY,this._parseStack.paused=!1,k.length>I&&(U=this._parseStack.position+I)}if(this._logService.logLevel<=v.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof k=="string"?` "${k}"`:` "${Array.prototype.map.call(k,G=>String.fromCharCode(G)).join("")}"`),typeof k=="string"?k.split("").map(G=>G.charCodeAt(0)):k),this._parseBuffer.length<k.length&&this._parseBuffer.length<I&&(this._parseBuffer=new Uint32Array(Math.min(k.length,I))),j||this._dirtyRowTracker.clearRange(),k.length>I)for(let G=U;G<k.length;G+=I){const Q=G+I<k.length?G+I:k.length,D=typeof k=="string"?this._stringDecoder.decode(k.substring(G,Q),this._parseBuffer):this._utf8Decoder.decode(k.subarray(G,Q),this._parseBuffer);if(A=this._parser.parse(this._parseBuffer,D))return this._preserveStack(P,q,D,G),this._logSlowResolvingAsync(A),A}else if(!j){const G=typeof k=="string"?this._stringDecoder.decode(k,this._parseBuffer):this._utf8Decoder.decode(k,this._parseBuffer);if(A=this._parser.parse(this._parseBuffer,G))return this._preserveStack(P,q,G,0),this._logSlowResolvingAsync(A),A}this._activeBuffer.x===P&&this._activeBuffer.y===q||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(k,T,A){let P,q;const U=this._charsetService.charset,j=this._optionsService.rawOptions.screenReaderMode,G=this._bufferService.cols,Q=this._coreService.decPrivateModes.wraparound,D=this._coreService.modes.insertMode,Y=this._curAttrData;let V=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&A-T>0&&V.getWidth(this._activeBuffer.x-1)===2&&V.setCellFromCodePoint(this._activeBuffer.x-1,0,1,Y.fg,Y.bg,Y.extended);for(let K=T;K<A;++K){if(P=k[K],q=this._unicodeService.wcwidth(P),P<127&&U){const ae=U[String.fromCharCode(P)];ae&&(P=ae.charCodeAt(0))}if(j&&this._onA11yChar.fire((0,m.stringFromCodePoint)(P)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),q||!this._activeBuffer.x){if(this._activeBuffer.x+q-1>=G){if(Q){for(;this._activeBuffer.x<G;)V.setCellFromCodePoint(this._activeBuffer.x++,0,1,Y.fg,Y.bg,Y.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),V=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=G-1,q===2)continue}if(D&&(V.insertCells(this._activeBuffer.x,q,this._activeBuffer.getNullCell(Y),Y),V.getWidth(G-1)===2&&V.setCellFromCodePoint(G-1,r.NULL_CELL_CODE,r.NULL_CELL_WIDTH,Y.fg,Y.bg,Y.extended)),V.setCellFromCodePoint(this._activeBuffer.x++,P,q,Y.fg,Y.bg,Y.extended),q>0)for(;--q;)V.setCellFromCodePoint(this._activeBuffer.x++,0,0,Y.fg,Y.bg,Y.extended)}else V.getWidth(this._activeBuffer.x-1)?V.addCodepointToCell(this._activeBuffer.x-1,P):V.addCodepointToCell(this._activeBuffer.x-2,P)}A-T>0&&(V.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<G&&A-T>0&&V.getWidth(this._activeBuffer.x)===0&&!V.hasContent(this._activeBuffer.x)&&V.setCellFromCodePoint(this._activeBuffer.x,0,1,Y.fg,Y.bg,Y.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(k,T){return k.final!=="t"||k.prefix||k.intermediates?this._parser.registerCsiHandler(k,T):this._parser.registerCsiHandler(k,A=>!N(A.params[0],this._optionsService.rawOptions.windowOptions)||T(A))}registerDcsHandler(k,T){return this._parser.registerDcsHandler(k,new M.DcsHandler(T))}registerEscHandler(k,T){return this._parser.registerEscHandler(k,T)}registerOscHandler(k,T){return this._parser.registerOscHandler(k,new C.OscHandler(T))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var k;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&!((k=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||k===void 0)&&k.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);T.hasWidth(this._activeBuffer.x)&&!T.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const k=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-k),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(k=this._bufferService.cols-1){this._activeBuffer.x=Math.min(k,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(k,T){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=k,this._activeBuffer.y=this._activeBuffer.scrollTop+T):(this._activeBuffer.x=k,this._activeBuffer.y=T),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(k,T){this._restrictCursor(),this._setCursor(this._activeBuffer.x+k,this._activeBuffer.y+T)}cursorUp(k){const T=this._activeBuffer.y-this._activeBuffer.scrollTop;return T>=0?this._moveCursor(0,-Math.min(T,k.params[0]||1)):this._moveCursor(0,-(k.params[0]||1)),!0}cursorDown(k){const T=this._activeBuffer.scrollBottom-this._activeBuffer.y;return T>=0?this._moveCursor(0,Math.min(T,k.params[0]||1)):this._moveCursor(0,k.params[0]||1),!0}cursorForward(k){return this._moveCursor(k.params[0]||1,0),!0}cursorBackward(k){return this._moveCursor(-(k.params[0]||1),0),!0}cursorNextLine(k){return this.cursorDown(k),this._activeBuffer.x=0,!0}cursorPrecedingLine(k){return this.cursorUp(k),this._activeBuffer.x=0,!0}cursorCharAbsolute(k){return this._setCursor((k.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(k){return this._setCursor(k.length>=2?(k.params[1]||1)-1:0,(k.params[0]||1)-1),!0}charPosAbsolute(k){return this._setCursor((k.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(k){return this._moveCursor(k.params[0]||1,0),!0}linePosAbsolute(k){return this._setCursor(this._activeBuffer.x,(k.params[0]||1)-1),!0}vPositionRelative(k){return this._moveCursor(0,k.params[0]||1),!0}hVPosition(k){return this.cursorPosition(k),!0}tabClear(k){const T=k.params[0];return T===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:T===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(k){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let T=k.params[0]||1;for(;T--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(k){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let T=k.params[0]||1;for(;T--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(k){const T=k.params[0];return T===1&&(this._curAttrData.bg|=536870912),T!==2&&T!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(k,T,A,P=!1,q=!1){const U=this._activeBuffer.lines.get(this._activeBuffer.ybase+k);U.replaceCells(T,A,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),q),P&&(U.isWrapped=!1)}_resetBufferLine(k,T=!1){const A=this._activeBuffer.lines.get(this._activeBuffer.ybase+k);A&&(A.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),T),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+k),A.isWrapped=!1)}eraseInDisplay(k,T=!1){let A;switch(this._restrictCursor(this._bufferService.cols),k.params[0]){case 0:for(A=this._activeBuffer.y,this._dirtyRowTracker.markDirty(A),this._eraseInBufferLine(A++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,T);A<this._bufferService.rows;A++)this._resetBufferLine(A,T);this._dirtyRowTracker.markDirty(A);break;case 1:for(A=this._activeBuffer.y,this._dirtyRowTracker.markDirty(A),this._eraseInBufferLine(A,0,this._activeBuffer.x+1,!0,T),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(A+1).isWrapped=!1);A--;)this._resetBufferLine(A,T);this._dirtyRowTracker.markDirty(0);break;case 2:for(A=this._bufferService.rows,this._dirtyRowTracker.markDirty(A-1);A--;)this._resetBufferLine(A,T);this._dirtyRowTracker.markDirty(0);break;case 3:const P=this._activeBuffer.lines.length-this._bufferService.rows;P>0&&(this._activeBuffer.lines.trimStart(P),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-P,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-P,0),this._onScroll.fire(0))}return!0}eraseInLine(k,T=!1){switch(this._restrictCursor(this._bufferService.cols),k.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,T);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,T);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,T)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(k){this._restrictCursor();let T=k.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const A=this._activeBuffer.ybase+this._activeBuffer.y,P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,q=this._bufferService.rows-1+this._activeBuffer.ybase-P+1;for(;T--;)this._activeBuffer.lines.splice(q-1,1),this._activeBuffer.lines.splice(A,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(k){this._restrictCursor();let T=k.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const A=this._activeBuffer.ybase+this._activeBuffer.y;let P;for(P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,P=this._bufferService.rows-1+this._activeBuffer.ybase-P;T--;)this._activeBuffer.lines.splice(A,1),this._activeBuffer.lines.splice(P,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(k){this._restrictCursor();const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return T&&(T.insertCells(this._activeBuffer.x,k.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(k){this._restrictCursor();const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return T&&(T.deleteCells(this._activeBuffer.x,k.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(k){let T=k.params[0]||1;for(;T--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(k){let T=k.params[0]||1;for(;T--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(i.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=k.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);P.deleteCells(0,T,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=k.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);P.insertCells(0,T,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=k.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);P.insertCells(this._activeBuffer.x,T,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const T=k.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);P.deleteCells(this._activeBuffer.x,T,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(k){this._restrictCursor();const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return T&&(T.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(k.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(k){if(!this._parser.precedingCodepoint)return!0;const T=k.params[0]||1,A=new Uint32Array(T);for(let P=0;P<T;++P)A[P]=this._parser.precedingCodepoint;return this.print(A,0,A.length),!0}sendDeviceAttributesPrimary(k){return k.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(a.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(a.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(k){return k.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(a.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(a.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(k.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(a.C0.ESC+"[>83;40003;0c")),!0}_is(k){return(this._optionsService.rawOptions.termName+"").indexOf(k)===0}setMode(k){for(let T=0;T<k.length;T++)switch(k.params[T]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(k){for(let T=0;T<k.length;T++)switch(k.params[T]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,p.DEFAULT_CHARSET),this._charsetService.setgCharset(1,p.DEFAULT_CHARSET),this._charsetService.setgCharset(2,p.DEFAULT_CHARSET),this._charsetService.setgCharset(3,p.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(k){for(let T=0;T<k.length;T++)switch(k.params[T]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(k){for(let T=0;T<k.length;T++)switch(k.params[T]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),k.params[T]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(k,T){const A=this._coreService.decPrivateModes,{activeProtocol:P,activeEncoding:q}=this._coreMouseService,U=this._coreService,{buffers:j,cols:G}=this._bufferService,{active:Q,alt:D}=j,Y=this._optionsService.rawOptions,V=me=>me?1:2,K=k.params[0];return ae=K,ie=T?K===2?4:K===4?V(U.modes.insertMode):K===12?3:K===20?V(Y.convertEol):0:K===1?V(A.applicationCursorKeys):K===3?Y.windowOptions.setWinLines?G===80?2:G===132?1:0:0:K===6?V(A.origin):K===7?V(A.wraparound):K===8?3:K===9?V(P==="X10"):K===12?V(Y.cursorBlink):K===25?V(!U.isCursorHidden):K===45?V(A.reverseWraparound):K===66?V(A.applicationKeypad):K===67?4:K===1e3?V(P==="VT200"):K===1002?V(P==="DRAG"):K===1003?V(P==="ANY"):K===1004?V(A.sendFocus):K===1005?4:K===1006?V(q==="SGR"):K===1015?4:K===1016?V(q==="SGR_PIXELS"):K===1048?1:K===47||K===1047||K===1049?V(Q===D):K===2004?V(A.bracketedPasteMode):0,U.triggerDataEvent(`${a.C0.ESC}[${T?"":"?"}${ae};${ie}$y`),!0;var ae,ie}_updateAttrColor(k,T,A,P,q){return T===2?(k|=50331648,k&=-16777216,k|=u.AttributeData.fromColorRGB([A,P,q])):T===5&&(k&=-50331904,k|=33554432|255&A),k}_extractColor(k,T,A){const P=[0,0,-1,0,0,0];let q=0,U=0;do{if(P[U+q]=k.params[T+U],k.hasSubParams(T+U)){const j=k.getSubParams(T+U);let G=0;do P[1]===5&&(q=1),P[U+G+1+q]=j[G];while(++G<j.length&&G+U+1+q<P.length);break}if(P[1]===5&&U+q>=2||P[1]===2&&U+q>=5)break;P[1]&&(q=1)}while(++U+T<k.length&&U+q<P.length);for(let j=2;j<P.length;++j)P[j]===-1&&(P[j]=0);switch(P[0]){case 38:A.fg=this._updateAttrColor(A.fg,P[1],P[3],P[4],P[5]);break;case 48:A.bg=this._updateAttrColor(A.bg,P[1],P[3],P[4],P[5]);break;case 58:A.extended=A.extended.clone(),A.extended.underlineColor=this._updateAttrColor(A.extended.underlineColor,P[1],P[3],P[4],P[5])}return U}_processUnderline(k,T){T.extended=T.extended.clone(),(!~k||k>5)&&(k=1),T.extended.underlineStyle=k,T.fg|=268435456,k===0&&(T.fg&=-268435457),T.updateExtended()}_processSGR0(k){k.fg=i.DEFAULT_ATTR_DATA.fg,k.bg=i.DEFAULT_ATTR_DATA.bg,k.extended=k.extended.clone(),k.extended.underlineStyle=0,k.extended.underlineColor&=-67108864,k.updateExtended()}charAttributes(k){if(k.length===1&&k.params[0]===0)return this._processSGR0(this._curAttrData),!0;const T=k.length;let A;const P=this._curAttrData;for(let q=0;q<T;q++)A=k.params[q],A>=30&&A<=37?(P.fg&=-50331904,P.fg|=16777216|A-30):A>=40&&A<=47?(P.bg&=-50331904,P.bg|=16777216|A-40):A>=90&&A<=97?(P.fg&=-50331904,P.fg|=16777224|A-90):A>=100&&A<=107?(P.bg&=-50331904,P.bg|=16777224|A-100):A===0?this._processSGR0(P):A===1?P.fg|=134217728:A===3?P.bg|=67108864:A===4?(P.fg|=268435456,this._processUnderline(k.hasSubParams(q)?k.getSubParams(q)[0]:1,P)):A===5?P.fg|=536870912:A===7?P.fg|=67108864:A===8?P.fg|=1073741824:A===9?P.fg|=2147483648:A===2?P.bg|=134217728:A===21?this._processUnderline(2,P):A===22?(P.fg&=-134217729,P.bg&=-134217729):A===23?P.bg&=-67108865:A===24?(P.fg&=-268435457,this._processUnderline(0,P)):A===25?P.fg&=-536870913:A===27?P.fg&=-67108865:A===28?P.fg&=-1073741825:A===29?P.fg&=2147483647:A===39?(P.fg&=-67108864,P.fg|=16777215&i.DEFAULT_ATTR_DATA.fg):A===49?(P.bg&=-67108864,P.bg|=16777215&i.DEFAULT_ATTR_DATA.bg):A===38||A===48||A===58?q+=this._extractColor(k,q,P):A===53?P.bg|=1073741824:A===55?P.bg&=-1073741825:A===59?(P.extended=P.extended.clone(),P.extended.underlineColor=-1,P.updateExtended()):A===100?(P.fg&=-67108864,P.fg|=16777215&i.DEFAULT_ATTR_DATA.fg,P.bg&=-67108864,P.bg|=16777215&i.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",A);return!0}deviceStatus(k){switch(k.params[0]){case 5:this._coreService.triggerDataEvent(`${a.C0.ESC}[0n`);break;case 6:const T=this._activeBuffer.y+1,A=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${a.C0.ESC}[${T};${A}R`)}return!0}deviceStatusPrivate(k){if(k.params[0]===6){const T=this._activeBuffer.y+1,A=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${a.C0.ESC}[?${T};${A}R`)}return!0}softReset(k){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(k){const T=k.params[0]||1;switch(T){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const A=T%2==1;return this._optionsService.options.cursorBlink=A,!0}setScrollRegion(k){const T=k.params[0]||1;let A;return(k.length<2||(A=k.params[1])>this._bufferService.rows||A===0)&&(A=this._bufferService.rows),A>T&&(this._activeBuffer.scrollTop=T-1,this._activeBuffer.scrollBottom=A-1,this._setCursor(0,0)),!0}windowOptions(k){if(!N(k.params[0],this._optionsService.rawOptions.windowOptions))return!0;const T=k.length>1?k.params[1]:0;switch(k.params[0]){case 14:T!==2&&this._onRequestWindowsOptionsReport.fire(d.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(d.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${a.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:T!==0&&T!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),T!==0&&T!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:T!==0&&T!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),T!==0&&T!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(k){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(k){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(k){return this._windowTitle=k,this._onTitleChange.fire(k),!0}setIconName(k){return this._iconName=k,!0}setOrReportIndexedColor(k){const T=[],A=k.split(";");for(;A.length>1;){const P=A.shift(),q=A.shift();if(/^\d+$/.exec(P)){const U=parseInt(P);if(W(U))if(q==="?")T.push({type:0,index:U});else{const j=(0,_.parseColor)(q);j&&T.push({type:1,index:U,color:j})}}}return T.length&&this._onColor.fire(T),!0}setHyperlink(k){const T=k.split(";");return!(T.length<2)&&(T[1]?this._createHyperlink(T[0],T[1]):!T[0]&&this._finishHyperlink())}_createHyperlink(k,T){this._getCurrentLinkId()&&this._finishHyperlink();const A=k.split(":");let P;const q=A.findIndex(U=>U.startsWith("id="));return q!==-1&&(P=A[q].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:P,uri:T}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(k,T){const A=k.split(";");for(let P=0;P<A.length&&!(T>=this._specialColors.length);++P,++T)if(A[P]==="?")this._onColor.fire([{type:0,index:this._specialColors[T]}]);else{const q=(0,_.parseColor)(A[P]);q&&this._onColor.fire([{type:1,index:this._specialColors[T],color:q}])}return!0}setOrReportFgColor(k){return this._setOrReportSpecialColor(k,0)}setOrReportBgColor(k){return this._setOrReportSpecialColor(k,1)}setOrReportCursorColor(k){return this._setOrReportSpecialColor(k,2)}restoreIndexedColor(k){if(!k)return this._onColor.fire([{type:2}]),!0;const T=[],A=k.split(";");for(let P=0;P<A.length;++P)if(/^\d+$/.exec(A[P])){const q=parseInt(A[P]);W(q)&&T.push({type:2,index:q})}return T.length&&this._onColor.fire(T),!0}restoreFgColor(k){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(k){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(k){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,p.DEFAULT_CHARSET),!0}selectCharset(k){return k.length!==2?(this.selectDefaultCharset(),!0):(k[0]==="/"||this._charsetService.setgCharset(y[k[0]],p.CHARSETS[k[1]]||p.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const k=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,k,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=i.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(k){return this._charsetService.setgLevel(k),!0}screenAlignmentPattern(){const k=new n.CellData;k.content=4194304|"E".charCodeAt(0),k.fg=this._curAttrData.fg,k.bg=this._curAttrData.bg,this._setCursor(0,0);for(let T=0;T<this._bufferService.rows;++T){const A=this._activeBuffer.ybase+this._activeBuffer.y+T,P=this._activeBuffer.lines.get(A);P&&(P.fill(k),P.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(k,T){const A=this._bufferService.buffer,P=this._optionsService.rawOptions;return(q=>(this._coreService.triggerDataEvent(`${a.C0.ESC}${q}${a.C0.ESC}\\`),!0))(k==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:k==='"p'?'P1$r61;1"p':k==="r"?`P1$r${A.scrollTop+1};${A.scrollBottom+1}r`:k==="m"?"P1$r0m":k===" q"?`P1$r${{block:2,underline:4,bar:6}[P.cursorStyle]-(P.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(k,T){this._dirtyRowTracker.markRangeDirty(k,T)}}o.InputHandler=x;let B=class{constructor(H){this._bufferService=H,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(H){H<this.start?this.start=H:H>this.end&&(this.end=H)}markRangeDirty(H,k){H>k&&(g=H,H=k,k=g),H<this.start&&(this.start=H),k>this.end&&(this.end=k)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function W(H){return 0<=H&&H<256}B=h([S(0,v.IBufferService)],B)},844:(L,o)=>{function l(h){for(const S of h)S.dispose();h.length=0}Object.defineProperty(o,"__esModule",{value:!0}),o.getDisposeArrayDisposable=o.disposeArray=o.toDisposable=o.MutableDisposable=o.Disposable=void 0,o.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const h of this._disposables)h.dispose();this._disposables.length=0}register(h){return this._disposables.push(h),h}unregister(h){const S=this._disposables.indexOf(h);S!==-1&&this._disposables.splice(S,1)}},o.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(h){var S;this._isDisposed||h===this._value||((S=this._value)===null||S===void 0||S.dispose(),this._value=h)}clear(){this.value=void 0}dispose(){var h;this._isDisposed=!0,(h=this._value)===null||h===void 0||h.dispose(),this._value=void 0}},o.toDisposable=function(h){return{dispose:h}},o.disposeArray=l,o.getDisposeArrayDisposable=function(h){return{dispose:()=>l(h)}}},1505:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.FourKeyMap=o.TwoKeyMap=void 0;class l{constructor(){this._data={}}set(S,a,p){this._data[S]||(this._data[S]={}),this._data[S][a]=p}get(S,a){return this._data[S]?this._data[S][a]:void 0}clear(){this._data={}}}o.TwoKeyMap=l,o.FourKeyMap=class{constructor(){this._data=new l}set(h,S,a,p,w){this._data.get(h,S)||this._data.set(h,S,new l),this._data.get(h,S).set(a,p,w)}get(h,S,a,p){var w;return(w=this._data.get(h,S))===null||w===void 0?void 0:w.get(a,p)}clear(){this._data.clear()}}},6114:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isChromeOS=o.isLinux=o.isWindows=o.isIphone=o.isIpad=o.isMac=o.getSafariVersion=o.isSafari=o.isLegacyEdge=o.isFirefox=o.isNode=void 0,o.isNode=typeof navigator>"u";const l=o.isNode?"node":navigator.userAgent,h=o.isNode?"node":navigator.platform;o.isFirefox=l.includes("Firefox"),o.isLegacyEdge=l.includes("Edge"),o.isSafari=/^((?!chrome|android).)*safari/i.test(l),o.getSafariVersion=function(){if(!o.isSafari)return 0;const S=l.match(/Version\/(\d+)/);return S===null||S.length<2?0:parseInt(S[1])},o.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(h),o.isIpad=h==="iPad",o.isIphone=h==="iPhone",o.isWindows=["Windows","Win16","Win32","WinCE"].includes(h),o.isLinux=h.indexOf("Linux")>=0,o.isChromeOS=/\bCrOS\b/.test(l)},6106:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.SortedList=void 0;let l=0;o.SortedList=class{constructor(h){this._getKey=h,this._array=[]}clear(){this._array.length=0}insert(h){this._array.length!==0?(l=this._search(this._getKey(h)),this._array.splice(l,0,h)):this._array.push(h)}delete(h){if(this._array.length===0)return!1;const S=this._getKey(h);if(S===void 0||(l=this._search(S),l===-1)||this._getKey(this._array[l])!==S)return!1;do if(this._array[l]===h)return this._array.splice(l,1),!0;while(++l<this._array.length&&this._getKey(this._array[l])===S);return!1}*getKeyIterator(h){if(this._array.length!==0&&(l=this._search(h),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===h))do yield this._array[l];while(++l<this._array.length&&this._getKey(this._array[l])===h)}forEachByKey(h,S){if(this._array.length!==0&&(l=this._search(h),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===h))do S(this._array[l]);while(++l<this._array.length&&this._getKey(this._array[l])===h)}values(){return[...this._array].values()}_search(h){let S=0,a=this._array.length-1;for(;a>=S;){let p=S+a>>1;const w=this._getKey(this._array[p]);if(w>h)a=p-1;else{if(!(w<h)){for(;p>0&&this._getKey(this._array[p-1])===h;)p--;return p}S=p+1}}return S}}},7226:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DebouncedIdleTask=o.IdleTaskQueue=o.PriorityTaskQueue=void 0;const h=l(6114);class S{constructor(){this._tasks=[],this._i=0}enqueue(w){this._tasks.push(w),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(w){this._idleCallback=void 0;let b=0,m=0,i=w.timeRemaining(),s=0;for(;this._i<this._tasks.length;){if(b=Date.now(),this._tasks[this._i]()||this._i++,b=Math.max(1,Date.now()-b),m=Math.max(b,m),s=w.timeRemaining(),1.5*m>s)return i-b<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(i-b))}ms`),void this._start();i=s}this.clear()}}class a extends S{_requestCallback(w){return setTimeout(()=>w(this._createDeadline(16)))}_cancelCallback(w){clearTimeout(w)}_createDeadline(w){const b=Date.now()+w;return{timeRemaining:()=>Math.max(0,b-Date.now())}}}o.PriorityTaskQueue=a,o.IdleTaskQueue=!h.isNode&&"requestIdleCallback"in window?class extends S{_requestCallback(p){return requestIdleCallback(p)}_cancelCallback(p){cancelIdleCallback(p)}}:a,o.DebouncedIdleTask=class{constructor(){this._queue=new o.IdleTaskQueue}set(p){this._queue.clear(),this._queue.enqueue(p)}flush(){this._queue.flush()}}},9282:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.updateWindowsModeWrappedState=void 0;const h=l(643);o.updateWindowsModeWrappedState=function(S){const a=S.buffer.lines.get(S.buffer.ybase+S.buffer.y-1),p=a?.get(S.cols-1),w=S.buffer.lines.get(S.buffer.ybase+S.buffer.y);w&&p&&(w.isWrapped=p[h.CHAR_DATA_CODE_INDEX]!==h.NULL_CELL_CODE&&p[h.CHAR_DATA_CODE_INDEX]!==h.WHITESPACE_CELL_CODE)}},3734:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ExtendedAttrs=o.AttributeData=void 0;class l{constructor(){this.fg=0,this.bg=0,this.extended=new h}static toColorRGB(a){return[a>>>16&255,a>>>8&255,255&a]}static fromColorRGB(a){return(255&a[0])<<16|(255&a[1])<<8|255&a[2]}clone(){const a=new l;return a.fg=this.fg,a.bg=this.bg,a.extended=this.extended.clone(),a}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}o.AttributeData=l;class h{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(a){this._ext=a}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(a){this._ext&=-469762049,this._ext|=a<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(a){this._ext&=-67108864,this._ext|=67108863&a}get urlId(){return this._urlId}set urlId(a){this._urlId=a}constructor(a=0,p=0){this._ext=0,this._urlId=0,this._ext=a,this._urlId=p}clone(){return new h(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}o.ExtendedAttrs=h},9092:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Buffer=o.MAX_BUFFER_SIZE=void 0;const h=l(6349),S=l(7226),a=l(3734),p=l(8437),w=l(4634),b=l(511),m=l(643),i=l(4863),s=l(7116);o.MAX_BUFFER_SIZE=4294967295,o.Buffer=class{constructor(r,n,u){this._hasScrollback=r,this._optionsService=n,this._bufferService=u,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=p.DEFAULT_ATTR_DATA.clone(),this.savedCharset=s.DEFAULT_CHARSET,this.markers=[],this._nullCell=b.CellData.fromCharData([0,m.NULL_CELL_CHAR,m.NULL_CELL_WIDTH,m.NULL_CELL_CODE]),this._whitespaceCell=b.CellData.fromCharData([0,m.WHITESPACE_CELL_CHAR,m.WHITESPACE_CELL_WIDTH,m.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new S.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new h.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(r){return r?(this._nullCell.fg=r.fg,this._nullCell.bg=r.bg,this._nullCell.extended=r.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new a.ExtendedAttrs),this._nullCell}getWhitespaceCell(r){return r?(this._whitespaceCell.fg=r.fg,this._whitespaceCell.bg=r.bg,this._whitespaceCell.extended=r.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new a.ExtendedAttrs),this._whitespaceCell}getBlankLine(r,n){return new p.BufferLine(this._bufferService.cols,this.getNullCell(r),n)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const r=this.ybase+this.y-this.ydisp;return r>=0&&r<this._rows}_getCorrectBufferLength(r){if(!this._hasScrollback)return r;const n=r+this._optionsService.rawOptions.scrollback;return n>o.MAX_BUFFER_SIZE?o.MAX_BUFFER_SIZE:n}fillViewportRows(r){if(this.lines.length===0){r===void 0&&(r=p.DEFAULT_ATTR_DATA);let n=this._rows;for(;n--;)this.lines.push(this.getBlankLine(r))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new h.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(r,n){const u=this.getNullCell(p.DEFAULT_ATTR_DATA);let v=0;const C=this._getCorrectBufferLength(n);if(C>this.lines.maxLength&&(this.lines.maxLength=C),this.lines.length>0){if(this._cols<r)for(let _=0;_<this.lines.length;_++)v+=+this.lines.get(_).resize(r,u);let M=0;if(this._rows<n)for(let _=this._rows;_<n;_++)this.lines.length<n+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new p.BufferLine(r,u)):this.ybase>0&&this.lines.length<=this.ybase+this.y+M+1?(this.ybase--,M++,this.ydisp>0&&this.ydisp--):this.lines.push(new p.BufferLine(r,u)));else for(let _=this._rows;_>n;_--)this.lines.length>n+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(C<this.lines.maxLength){const _=this.lines.length-C;_>0&&(this.lines.trimStart(_),this.ybase=Math.max(this.ybase-_,0),this.ydisp=Math.max(this.ydisp-_,0),this.savedY=Math.max(this.savedY-_,0)),this.lines.maxLength=C}this.x=Math.min(this.x,r-1),this.y=Math.min(this.y,n-1),M&&(this.y+=M),this.savedX=Math.min(this.savedX,r-1),this.scrollTop=0}if(this.scrollBottom=n-1,this._isReflowEnabled&&(this._reflow(r,n),this._cols>r))for(let M=0;M<this.lines.length;M++)v+=+this.lines.get(M).resize(r,u);this._cols=r,this._rows=n,this._memoryCleanupQueue.clear(),v>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let r=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,r=!1);let n=0;for(;this._memoryCleanupPosition<this.lines.length;)if(n+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),n>100)return!0;return r}get _isReflowEnabled(){const r=this._optionsService.rawOptions.windowsPty;return r&&r.buildNumber?this._hasScrollback&&r.backend==="conpty"&&r.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(r,n){this._cols!==r&&(r>this._cols?this._reflowLarger(r,n):this._reflowSmaller(r,n))}_reflowLarger(r,n){const u=(0,w.reflowLargerGetLinesToRemove)(this.lines,this._cols,r,this.ybase+this.y,this.getNullCell(p.DEFAULT_ATTR_DATA));if(u.length>0){const v=(0,w.reflowLargerCreateNewLayout)(this.lines,u);(0,w.reflowLargerApplyNewLayout)(this.lines,v.layout),this._reflowLargerAdjustViewport(r,n,v.countRemoved)}}_reflowLargerAdjustViewport(r,n,u){const v=this.getNullCell(p.DEFAULT_ATTR_DATA);let C=u;for(;C-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<n&&this.lines.push(new p.BufferLine(r,v))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-u,0)}_reflowSmaller(r,n){const u=this.getNullCell(p.DEFAULT_ATTR_DATA),v=[];let C=0;for(let M=this.lines.length-1;M>=0;M--){let _=this.lines.get(M);if(!_||!_.isWrapped&&_.getTrimmedLength()<=r)continue;const y=[_];for(;_.isWrapped&&M>0;)_=this.lines.get(--M),y.unshift(_);const I=this.ybase+this.y;if(I>=M&&I<M+y.length)continue;const N=y[y.length-1].getTrimmedLength(),d=(0,w.reflowSmallerGetNewLineLengths)(y,this._cols,r),g=d.length-y.length;let x;x=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+g):Math.max(0,this.lines.length-this.lines.maxLength+g);const B=[];for(let P=0;P<g;P++){const q=this.getBlankLine(p.DEFAULT_ATTR_DATA,!0);B.push(q)}B.length>0&&(v.push({start:M+y.length+C,newLines:B}),C+=B.length),y.push(...B);let W=d.length-1,H=d[W];H===0&&(W--,H=d[W]);let k=y.length-g-1,T=N;for(;k>=0;){const P=Math.min(T,H);if(y[W]===void 0)break;if(y[W].copyCellsFrom(y[k],T-P,H-P,P,!0),H-=P,H===0&&(W--,H=d[W]),T-=P,T===0){k--;const q=Math.max(k,0);T=(0,w.getWrappedLineTrimmedLength)(y,q,this._cols)}}for(let P=0;P<y.length;P++)d[P]<r&&y[P].setCell(d[P],u);let A=g-x;for(;A-- >0;)this.ybase===0?this.y<n-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+C)-n&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+g,this.ybase+n-1)}if(v.length>0){const M=[],_=[];for(let W=0;W<this.lines.length;W++)_.push(this.lines.get(W));const y=this.lines.length;let I=y-1,N=0,d=v[N];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+C);let g=0;for(let W=Math.min(this.lines.maxLength-1,y+C-1);W>=0;W--)if(d&&d.start>I+g){for(let H=d.newLines.length-1;H>=0;H--)this.lines.set(W--,d.newLines[H]);W++,M.push({index:I+1,amount:d.newLines.length}),g+=d.newLines.length,d=v[++N]}else this.lines.set(W,_[I--]);let x=0;for(let W=M.length-1;W>=0;W--)M[W].index+=x,this.lines.onInsertEmitter.fire(M[W]),x+=M[W].amount;const B=Math.max(0,y+C-this.lines.maxLength);B>0&&this.lines.onTrimEmitter.fire(B)}}translateBufferLineToString(r,n,u=0,v){const C=this.lines.get(r);return C?C.translateToString(n,u,v):""}getWrappedRangeForLine(r){let n=r,u=r;for(;n>0&&this.lines.get(n).isWrapped;)n--;for(;u+1<this.lines.length&&this.lines.get(u+1).isWrapped;)u++;return{first:n,last:u}}setupTabStops(r){for(r!=null?this.tabs[r]||(r=this.prevStop(r)):(this.tabs={},r=0);r<this._cols;r+=this._optionsService.rawOptions.tabStopWidth)this.tabs[r]=!0}prevStop(r){for(r==null&&(r=this.x);!this.tabs[--r]&&r>0;);return r>=this._cols?this._cols-1:r<0?0:r}nextStop(r){for(r==null&&(r=this.x);!this.tabs[++r]&&r<this._cols;);return r>=this._cols?this._cols-1:r<0?0:r}clearMarkers(r){this._isClearing=!0;for(let n=0;n<this.markers.length;n++)this.markers[n].line===r&&(this.markers[n].dispose(),this.markers.splice(n--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let r=0;r<this.markers.length;r++)this.markers[r].dispose(),this.markers.splice(r--,1);this._isClearing=!1}addMarker(r){const n=new i.Marker(r);return this.markers.push(n),n.register(this.lines.onTrim(u=>{n.line-=u,n.line<0&&n.dispose()})),n.register(this.lines.onInsert(u=>{n.line>=u.index&&(n.line+=u.amount)})),n.register(this.lines.onDelete(u=>{n.line>=u.index&&n.line<u.index+u.amount&&n.dispose(),n.line>u.index&&(n.line-=u.amount)})),n.register(n.onDispose(()=>this._removeMarker(n))),n}_removeMarker(r){this._isClearing||this.markers.splice(this.markers.indexOf(r),1)}}},8437:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferLine=o.DEFAULT_ATTR_DATA=void 0;const h=l(3734),S=l(511),a=l(643),p=l(482);o.DEFAULT_ATTR_DATA=Object.freeze(new h.AttributeData);let w=0;class b{constructor(i,s,r=!1){this.isWrapped=r,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*i);const n=s||S.CellData.fromCharData([0,a.NULL_CELL_CHAR,a.NULL_CELL_WIDTH,a.NULL_CELL_CODE]);for(let u=0;u<i;++u)this.setCell(u,n);this.length=i}get(i){const s=this._data[3*i+0],r=2097151&s;return[this._data[3*i+1],2097152&s?this._combined[i]:r?(0,p.stringFromCodePoint)(r):"",s>>22,2097152&s?this._combined[i].charCodeAt(this._combined[i].length-1):r]}set(i,s){this._data[3*i+1]=s[a.CHAR_DATA_ATTR_INDEX],s[a.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[i]=s[1],this._data[3*i+0]=2097152|i|s[a.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*i+0]=s[a.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|s[a.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(i){return this._data[3*i+0]>>22}hasWidth(i){return 12582912&this._data[3*i+0]}getFg(i){return this._data[3*i+1]}getBg(i){return this._data[3*i+2]}hasContent(i){return 4194303&this._data[3*i+0]}getCodePoint(i){const s=this._data[3*i+0];return 2097152&s?this._combined[i].charCodeAt(this._combined[i].length-1):2097151&s}isCombined(i){return 2097152&this._data[3*i+0]}getString(i){const s=this._data[3*i+0];return 2097152&s?this._combined[i]:2097151&s?(0,p.stringFromCodePoint)(2097151&s):""}isProtected(i){return 536870912&this._data[3*i+2]}loadCell(i,s){return w=3*i,s.content=this._data[w+0],s.fg=this._data[w+1],s.bg=this._data[w+2],2097152&s.content&&(s.combinedData=this._combined[i]),268435456&s.bg&&(s.extended=this._extendedAttrs[i]),s}setCell(i,s){2097152&s.content&&(this._combined[i]=s.combinedData),268435456&s.bg&&(this._extendedAttrs[i]=s.extended),this._data[3*i+0]=s.content,this._data[3*i+1]=s.fg,this._data[3*i+2]=s.bg}setCellFromCodePoint(i,s,r,n,u,v){268435456&u&&(this._extendedAttrs[i]=v),this._data[3*i+0]=s|r<<22,this._data[3*i+1]=n,this._data[3*i+2]=u}addCodepointToCell(i,s){let r=this._data[3*i+0];2097152&r?this._combined[i]+=(0,p.stringFromCodePoint)(s):(2097151&r?(this._combined[i]=(0,p.stringFromCodePoint)(2097151&r)+(0,p.stringFromCodePoint)(s),r&=-2097152,r|=2097152):r=s|4194304,this._data[3*i+0]=r)}insertCells(i,s,r,n){if((i%=this.length)&&this.getWidth(i-1)===2&&this.setCellFromCodePoint(i-1,0,1,n?.fg||0,n?.bg||0,n?.extended||new h.ExtendedAttrs),s<this.length-i){const u=new S.CellData;for(let v=this.length-i-s-1;v>=0;--v)this.setCell(i+s+v,this.loadCell(i+v,u));for(let v=0;v<s;++v)this.setCell(i+v,r)}else for(let u=i;u<this.length;++u)this.setCell(u,r);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,n?.fg||0,n?.bg||0,n?.extended||new h.ExtendedAttrs)}deleteCells(i,s,r,n){if(i%=this.length,s<this.length-i){const u=new S.CellData;for(let v=0;v<this.length-i-s;++v)this.setCell(i+v,this.loadCell(i+s+v,u));for(let v=this.length-s;v<this.length;++v)this.setCell(v,r)}else for(let u=i;u<this.length;++u)this.setCell(u,r);i&&this.getWidth(i-1)===2&&this.setCellFromCodePoint(i-1,0,1,n?.fg||0,n?.bg||0,n?.extended||new h.ExtendedAttrs),this.getWidth(i)!==0||this.hasContent(i)||this.setCellFromCodePoint(i,0,1,n?.fg||0,n?.bg||0,n?.extended||new h.ExtendedAttrs)}replaceCells(i,s,r,n,u=!1){if(u)for(i&&this.getWidth(i-1)===2&&!this.isProtected(i-1)&&this.setCellFromCodePoint(i-1,0,1,n?.fg||0,n?.bg||0,n?.extended||new h.ExtendedAttrs),s<this.length&&this.getWidth(s-1)===2&&!this.isProtected(s)&&this.setCellFromCodePoint(s,0,1,n?.fg||0,n?.bg||0,n?.extended||new h.ExtendedAttrs);i<s&&i<this.length;)this.isProtected(i)||this.setCell(i,r),i++;else for(i&&this.getWidth(i-1)===2&&this.setCellFromCodePoint(i-1,0,1,n?.fg||0,n?.bg||0,n?.extended||new h.ExtendedAttrs),s<this.length&&this.getWidth(s-1)===2&&this.setCellFromCodePoint(s,0,1,n?.fg||0,n?.bg||0,n?.extended||new h.ExtendedAttrs);i<s&&i<this.length;)this.setCell(i++,r)}resize(i,s){if(i===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const r=3*i;if(i>this.length){if(this._data.buffer.byteLength>=4*r)this._data=new Uint32Array(this._data.buffer,0,r);else{const n=new Uint32Array(r);n.set(this._data),this._data=n}for(let n=this.length;n<i;++n)this.setCell(n,s)}else{this._data=this._data.subarray(0,r);const n=Object.keys(this._combined);for(let v=0;v<n.length;v++){const C=parseInt(n[v],10);C>=i&&delete this._combined[C]}const u=Object.keys(this._extendedAttrs);for(let v=0;v<u.length;v++){const C=parseInt(u[v],10);C>=i&&delete this._extendedAttrs[C]}}return this.length=i,4*r*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const i=new Uint32Array(this._data.length);return i.set(this._data),this._data=i,1}return 0}fill(i,s=!1){if(s)for(let r=0;r<this.length;++r)this.isProtected(r)||this.setCell(r,i);else{this._combined={},this._extendedAttrs={};for(let r=0;r<this.length;++r)this.setCell(r,i)}}copyFrom(i){this.length!==i.length?this._data=new Uint32Array(i._data):this._data.set(i._data),this.length=i.length,this._combined={};for(const s in i._combined)this._combined[s]=i._combined[s];this._extendedAttrs={};for(const s in i._extendedAttrs)this._extendedAttrs[s]=i._extendedAttrs[s];this.isWrapped=i.isWrapped}clone(){const i=new b(0);i._data=new Uint32Array(this._data),i.length=this.length;for(const s in this._combined)i._combined[s]=this._combined[s];for(const s in this._extendedAttrs)i._extendedAttrs[s]=this._extendedAttrs[s];return i.isWrapped=this.isWrapped,i}getTrimmedLength(){for(let i=this.length-1;i>=0;--i)if(4194303&this._data[3*i+0])return i+(this._data[3*i+0]>>22);return 0}getNoBgTrimmedLength(){for(let i=this.length-1;i>=0;--i)if(4194303&this._data[3*i+0]||50331648&this._data[3*i+2])return i+(this._data[3*i+0]>>22);return 0}copyCellsFrom(i,s,r,n,u){const v=i._data;if(u)for(let M=n-1;M>=0;M--){for(let _=0;_<3;_++)this._data[3*(r+M)+_]=v[3*(s+M)+_];268435456&v[3*(s+M)+2]&&(this._extendedAttrs[r+M]=i._extendedAttrs[s+M])}else for(let M=0;M<n;M++){for(let _=0;_<3;_++)this._data[3*(r+M)+_]=v[3*(s+M)+_];268435456&v[3*(s+M)+2]&&(this._extendedAttrs[r+M]=i._extendedAttrs[s+M])}const C=Object.keys(i._combined);for(let M=0;M<C.length;M++){const _=parseInt(C[M],10);_>=s&&(this._combined[_-s+r]=i._combined[_])}}translateToString(i=!1,s=0,r=this.length){i&&(r=Math.min(r,this.getTrimmedLength()));let n="";for(;s<r;){const u=this._data[3*s+0],v=2097151&u;n+=2097152&u?this._combined[s]:v?(0,p.stringFromCodePoint)(v):a.WHITESPACE_CELL_CHAR,s+=u>>22||1}return n}}o.BufferLine=b},4841:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.getRangeLength=void 0,o.getRangeLength=function(l,h){if(l.start.y>l.end.y)throw new Error(`Buffer range end (${l.end.x}, ${l.end.y}) cannot be before start (${l.start.x}, ${l.start.y})`);return h*(l.end.y-l.start.y)+(l.end.x-l.start.x+1)}},4634:(L,o)=>{function l(h,S,a){if(S===h.length-1)return h[S].getTrimmedLength();const p=!h[S].hasContent(a-1)&&h[S].getWidth(a-1)===1,w=h[S+1].getWidth(0)===2;return p&&w?a-1:a}Object.defineProperty(o,"__esModule",{value:!0}),o.getWrappedLineTrimmedLength=o.reflowSmallerGetNewLineLengths=o.reflowLargerApplyNewLayout=o.reflowLargerCreateNewLayout=o.reflowLargerGetLinesToRemove=void 0,o.reflowLargerGetLinesToRemove=function(h,S,a,p,w){const b=[];for(let m=0;m<h.length-1;m++){let i=m,s=h.get(++i);if(!s.isWrapped)continue;const r=[h.get(m)];for(;i<h.length&&s.isWrapped;)r.push(s),s=h.get(++i);if(p>=m&&p<i){m+=r.length-1;continue}let n=0,u=l(r,n,S),v=1,C=0;for(;v<r.length;){const _=l(r,v,S),y=_-C,I=a-u,N=Math.min(y,I);r[n].copyCellsFrom(r[v],C,u,N,!1),u+=N,u===a&&(n++,u=0),C+=N,C===_&&(v++,C=0),u===0&&n!==0&&r[n-1].getWidth(a-1)===2&&(r[n].copyCellsFrom(r[n-1],a-1,u++,1,!1),r[n-1].setCell(a-1,w))}r[n].replaceCells(u,a,w);let M=0;for(let _=r.length-1;_>0&&(_>n||r[_].getTrimmedLength()===0);_--)M++;M>0&&(b.push(m+r.length-M),b.push(M)),m+=r.length-1}return b},o.reflowLargerCreateNewLayout=function(h,S){const a=[];let p=0,w=S[p],b=0;for(let m=0;m<h.length;m++)if(w===m){const i=S[++p];h.onDeleteEmitter.fire({index:m-b,amount:i}),m+=i-1,b+=i,w=S[++p]}else a.push(m);return{layout:a,countRemoved:b}},o.reflowLargerApplyNewLayout=function(h,S){const a=[];for(let p=0;p<S.length;p++)a.push(h.get(S[p]));for(let p=0;p<a.length;p++)h.set(p,a[p]);h.length=S.length},o.reflowSmallerGetNewLineLengths=function(h,S,a){const p=[],w=h.map((s,r)=>l(h,r,S)).reduce((s,r)=>s+r);let b=0,m=0,i=0;for(;i<w;){if(w-i<a){p.push(w-i);break}b+=a;const s=l(h,m,S);b>s&&(b-=s,m++);const r=h[m].getWidth(b-1)===2;r&&b--;const n=r?a-1:a;p.push(n),i+=n}return p},o.getWrappedLineTrimmedLength=l},5295:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferSet=void 0;const h=l(8460),S=l(844),a=l(9092);class p extends S.Disposable{constructor(b,m){super(),this._optionsService=b,this._bufferService=m,this._onBufferActivate=this.register(new h.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new a.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new a.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(b){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(b),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(b,m){this._normal.resize(b,m),this._alt.resize(b,m),this.setupTabStops(b)}setupTabStops(b){this._normal.setupTabStops(b),this._alt.setupTabStops(b)}}o.BufferSet=p},511:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CellData=void 0;const h=l(482),S=l(643),a=l(3734);class p extends a.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new a.ExtendedAttrs,this.combinedData=""}static fromCharData(b){const m=new p;return m.setFromCharData(b),m}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,h.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(b){this.fg=b[S.CHAR_DATA_ATTR_INDEX],this.bg=0;let m=!1;if(b[S.CHAR_DATA_CHAR_INDEX].length>2)m=!0;else if(b[S.CHAR_DATA_CHAR_INDEX].length===2){const i=b[S.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){const s=b[S.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=s&&s<=57343?this.content=1024*(i-55296)+s-56320+65536|b[S.CHAR_DATA_WIDTH_INDEX]<<22:m=!0}else m=!0}else this.content=b[S.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|b[S.CHAR_DATA_WIDTH_INDEX]<<22;m&&(this.combinedData=b[S.CHAR_DATA_CHAR_INDEX],this.content=2097152|b[S.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}o.CellData=p},643:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WHITESPACE_CELL_CODE=o.WHITESPACE_CELL_WIDTH=o.WHITESPACE_CELL_CHAR=o.NULL_CELL_CODE=o.NULL_CELL_WIDTH=o.NULL_CELL_CHAR=o.CHAR_DATA_CODE_INDEX=o.CHAR_DATA_WIDTH_INDEX=o.CHAR_DATA_CHAR_INDEX=o.CHAR_DATA_ATTR_INDEX=o.DEFAULT_EXT=o.DEFAULT_ATTR=o.DEFAULT_COLOR=void 0,o.DEFAULT_COLOR=0,o.DEFAULT_ATTR=256|o.DEFAULT_COLOR<<9,o.DEFAULT_EXT=0,o.CHAR_DATA_ATTR_INDEX=0,o.CHAR_DATA_CHAR_INDEX=1,o.CHAR_DATA_WIDTH_INDEX=2,o.CHAR_DATA_CODE_INDEX=3,o.NULL_CELL_CHAR="",o.NULL_CELL_WIDTH=1,o.NULL_CELL_CODE=0,o.WHITESPACE_CELL_CHAR=" ",o.WHITESPACE_CELL_WIDTH=1,o.WHITESPACE_CELL_CODE=32},4863:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Marker=void 0;const h=l(8460),S=l(844);class a{get id(){return this._id}constructor(w){this.line=w,this.isDisposed=!1,this._disposables=[],this._id=a._nextId++,this._onDispose=this.register(new h.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,S.disposeArray)(this._disposables),this._disposables.length=0)}register(w){return this._disposables.push(w),w}}o.Marker=a,a._nextId=1},7116:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DEFAULT_CHARSET=o.CHARSETS=void 0,o.CHARSETS={},o.DEFAULT_CHARSET=o.CHARSETS.B,o.CHARSETS[0]={"`":"\u25C6",a:"\u2592",b:"\u2409",c:"\u240C",d:"\u240D",e:"\u240A",f:"\xB0",g:"\xB1",h:"\u2424",i:"\u240B",j:"\u2518",k:"\u2510",l:"\u250C",m:"\u2514",n:"\u253C",o:"\u23BA",p:"\u23BB",q:"\u2500",r:"\u23BC",s:"\u23BD",t:"\u251C",u:"\u2524",v:"\u2534",w:"\u252C",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03C0","|":"\u2260","}":"\xA3","~":"\xB7"},o.CHARSETS.A={"#":"\xA3"},o.CHARSETS.B=void 0,o.CHARSETS[4]={"#":"\xA3","@":"\xBE","[":"ij","\\":"\xBD","]":"|","{":"\xA8","|":"f","}":"\xBC","~":"\xB4"},o.CHARSETS.C=o.CHARSETS[5]={"[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},o.CHARSETS.R={"#":"\xA3","@":"\xE0","[":"\xB0","\\":"\xE7","]":"\xA7","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xA8"},o.CHARSETS.Q={"@":"\xE0","[":"\xE2","\\":"\xE7","]":"\xEA","^":"\xEE","`":"\xF4","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xFB"},o.CHARSETS.K={"@":"\xA7","[":"\xC4","\\":"\xD6","]":"\xDC","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xDF"},o.CHARSETS.Y={"#":"\xA3","@":"\xA7","[":"\xB0","\\":"\xE7","]":"\xE9","`":"\xF9","{":"\xE0","|":"\xF2","}":"\xE8","~":"\xEC"},o.CHARSETS.E=o.CHARSETS[6]={"@":"\xC4","[":"\xC6","\\":"\xD8","]":"\xC5","^":"\xDC","`":"\xE4","{":"\xE6","|":"\xF8","}":"\xE5","~":"\xFC"},o.CHARSETS.Z={"#":"\xA3","@":"\xA7","[":"\xA1","\\":"\xD1","]":"\xBF","{":"\xB0","|":"\xF1","}":"\xE7"},o.CHARSETS.H=o.CHARSETS[7]={"@":"\xC9","[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},o.CHARSETS["="]={"#":"\xF9","@":"\xE0","[":"\xE9","\\":"\xE7","]":"\xEA","^":"\xEE",_:"\xE8","`":"\xF4","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xFB"}},2584:(L,o)=>{var l,h,S;Object.defineProperty(o,"__esModule",{value:!0}),o.C1_ESCAPED=o.C1=o.C0=void 0,function(a){a.NUL="\0",a.SOH="",a.STX="",a.ETX="",a.EOT="",a.ENQ="",a.ACK="",a.BEL="\x07",a.BS="\b",a.HT="	",a.LF=`
`,a.VT="\v",a.FF="\f",a.CR="\r",a.SO="",a.SI="",a.DLE="",a.DC1="",a.DC2="",a.DC3="",a.DC4="",a.NAK="",a.SYN="",a.ETB="",a.CAN="",a.EM="",a.SUB="",a.ESC="\x1B",a.FS="",a.GS="",a.RS="",a.US="",a.SP=" ",a.DEL="\x7F"}(l||(o.C0=l={})),function(a){a.PAD="\x80",a.HOP="\x81",a.BPH="\x82",a.NBH="\x83",a.IND="\x84",a.NEL="\x85",a.SSA="\x86",a.ESA="\x87",a.HTS="\x88",a.HTJ="\x89",a.VTS="\x8A",a.PLD="\x8B",a.PLU="\x8C",a.RI="\x8D",a.SS2="\x8E",a.SS3="\x8F",a.DCS="\x90",a.PU1="\x91",a.PU2="\x92",a.STS="\x93",a.CCH="\x94",a.MW="\x95",a.SPA="\x96",a.EPA="\x97",a.SOS="\x98",a.SGCI="\x99",a.SCI="\x9A",a.CSI="\x9B",a.ST="\x9C",a.OSC="\x9D",a.PM="\x9E",a.APC="\x9F"}(h||(o.C1=h={})),function(a){a.ST=`${l.ESC}\\`}(S||(o.C1_ESCAPED=S={}))},7399:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.evaluateKeyboardEvent=void 0;const h=l(2584),S={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};o.evaluateKeyboardEvent=function(a,p,w,b){const m={type:0,cancel:!1,key:void 0},i=(a.shiftKey?1:0)|(a.altKey?2:0)|(a.ctrlKey?4:0)|(a.metaKey?8:0);switch(a.keyCode){case 0:a.key==="UIKeyInputUpArrow"?m.key=p?h.C0.ESC+"OA":h.C0.ESC+"[A":a.key==="UIKeyInputLeftArrow"?m.key=p?h.C0.ESC+"OD":h.C0.ESC+"[D":a.key==="UIKeyInputRightArrow"?m.key=p?h.C0.ESC+"OC":h.C0.ESC+"[C":a.key==="UIKeyInputDownArrow"&&(m.key=p?h.C0.ESC+"OB":h.C0.ESC+"[B");break;case 8:if(a.altKey){m.key=h.C0.ESC+h.C0.DEL;break}m.key=h.C0.DEL;break;case 9:if(a.shiftKey){m.key=h.C0.ESC+"[Z";break}m.key=h.C0.HT,m.cancel=!0;break;case 13:m.key=a.altKey?h.C0.ESC+h.C0.CR:h.C0.CR,m.cancel=!0;break;case 27:m.key=h.C0.ESC,a.altKey&&(m.key=h.C0.ESC+h.C0.ESC),m.cancel=!0;break;case 37:if(a.metaKey)break;i?(m.key=h.C0.ESC+"[1;"+(i+1)+"D",m.key===h.C0.ESC+"[1;3D"&&(m.key=h.C0.ESC+(w?"b":"[1;5D"))):m.key=p?h.C0.ESC+"OD":h.C0.ESC+"[D";break;case 39:if(a.metaKey)break;i?(m.key=h.C0.ESC+"[1;"+(i+1)+"C",m.key===h.C0.ESC+"[1;3C"&&(m.key=h.C0.ESC+(w?"f":"[1;5C"))):m.key=p?h.C0.ESC+"OC":h.C0.ESC+"[C";break;case 38:if(a.metaKey)break;i?(m.key=h.C0.ESC+"[1;"+(i+1)+"A",w||m.key!==h.C0.ESC+"[1;3A"||(m.key=h.C0.ESC+"[1;5A")):m.key=p?h.C0.ESC+"OA":h.C0.ESC+"[A";break;case 40:if(a.metaKey)break;i?(m.key=h.C0.ESC+"[1;"+(i+1)+"B",w||m.key!==h.C0.ESC+"[1;3B"||(m.key=h.C0.ESC+"[1;5B")):m.key=p?h.C0.ESC+"OB":h.C0.ESC+"[B";break;case 45:a.shiftKey||a.ctrlKey||(m.key=h.C0.ESC+"[2~");break;case 46:m.key=i?h.C0.ESC+"[3;"+(i+1)+"~":h.C0.ESC+"[3~";break;case 36:m.key=i?h.C0.ESC+"[1;"+(i+1)+"H":p?h.C0.ESC+"OH":h.C0.ESC+"[H";break;case 35:m.key=i?h.C0.ESC+"[1;"+(i+1)+"F":p?h.C0.ESC+"OF":h.C0.ESC+"[F";break;case 33:a.shiftKey?m.type=2:a.ctrlKey?m.key=h.C0.ESC+"[5;"+(i+1)+"~":m.key=h.C0.ESC+"[5~";break;case 34:a.shiftKey?m.type=3:a.ctrlKey?m.key=h.C0.ESC+"[6;"+(i+1)+"~":m.key=h.C0.ESC+"[6~";break;case 112:m.key=i?h.C0.ESC+"[1;"+(i+1)+"P":h.C0.ESC+"OP";break;case 113:m.key=i?h.C0.ESC+"[1;"+(i+1)+"Q":h.C0.ESC+"OQ";break;case 114:m.key=i?h.C0.ESC+"[1;"+(i+1)+"R":h.C0.ESC+"OR";break;case 115:m.key=i?h.C0.ESC+"[1;"+(i+1)+"S":h.C0.ESC+"OS";break;case 116:m.key=i?h.C0.ESC+"[15;"+(i+1)+"~":h.C0.ESC+"[15~";break;case 117:m.key=i?h.C0.ESC+"[17;"+(i+1)+"~":h.C0.ESC+"[17~";break;case 118:m.key=i?h.C0.ESC+"[18;"+(i+1)+"~":h.C0.ESC+"[18~";break;case 119:m.key=i?h.C0.ESC+"[19;"+(i+1)+"~":h.C0.ESC+"[19~";break;case 120:m.key=i?h.C0.ESC+"[20;"+(i+1)+"~":h.C0.ESC+"[20~";break;case 121:m.key=i?h.C0.ESC+"[21;"+(i+1)+"~":h.C0.ESC+"[21~";break;case 122:m.key=i?h.C0.ESC+"[23;"+(i+1)+"~":h.C0.ESC+"[23~";break;case 123:m.key=i?h.C0.ESC+"[24;"+(i+1)+"~":h.C0.ESC+"[24~";break;default:if(!a.ctrlKey||a.shiftKey||a.altKey||a.metaKey)if(w&&!b||!a.altKey||a.metaKey)!w||a.altKey||a.ctrlKey||a.shiftKey||!a.metaKey?a.key&&!a.ctrlKey&&!a.altKey&&!a.metaKey&&a.keyCode>=48&&a.key.length===1?m.key=a.key:a.key&&a.ctrlKey&&(a.key==="_"&&(m.key=h.C0.US),a.key==="@"&&(m.key=h.C0.NUL)):a.keyCode===65&&(m.type=1);else{const s=S[a.keyCode],r=s?.[a.shiftKey?1:0];if(r)m.key=h.C0.ESC+r;else if(a.keyCode>=65&&a.keyCode<=90){const n=a.ctrlKey?a.keyCode-64:a.keyCode+32;let u=String.fromCharCode(n);a.shiftKey&&(u=u.toUpperCase()),m.key=h.C0.ESC+u}else if(a.keyCode===32)m.key=h.C0.ESC+(a.ctrlKey?h.C0.NUL:" ");else if(a.key==="Dead"&&a.code.startsWith("Key")){let n=a.code.slice(3,4);a.shiftKey||(n=n.toLowerCase()),m.key=h.C0.ESC+n,m.cancel=!0}}else a.keyCode>=65&&a.keyCode<=90?m.key=String.fromCharCode(a.keyCode-64):a.keyCode===32?m.key=h.C0.NUL:a.keyCode>=51&&a.keyCode<=55?m.key=String.fromCharCode(a.keyCode-51+27):a.keyCode===56?m.key=h.C0.DEL:a.keyCode===219?m.key=h.C0.ESC:a.keyCode===220?m.key=h.C0.FS:a.keyCode===221&&(m.key=h.C0.GS)}return m}},482:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Utf8ToUtf32=o.StringToUtf32=o.utf32ToString=o.stringFromCodePoint=void 0,o.stringFromCodePoint=function(l){return l>65535?(l-=65536,String.fromCharCode(55296+(l>>10))+String.fromCharCode(l%1024+56320)):String.fromCharCode(l)},o.utf32ToString=function(l,h=0,S=l.length){let a="";for(let p=h;p<S;++p){let w=l[p];w>65535?(w-=65536,a+=String.fromCharCode(55296+(w>>10))+String.fromCharCode(w%1024+56320)):a+=String.fromCharCode(w)}return a},o.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(l,h){const S=l.length;if(!S)return 0;let a=0,p=0;if(this._interim){const w=l.charCodeAt(p++);56320<=w&&w<=57343?h[a++]=1024*(this._interim-55296)+w-56320+65536:(h[a++]=this._interim,h[a++]=w),this._interim=0}for(let w=p;w<S;++w){const b=l.charCodeAt(w);if(55296<=b&&b<=56319){if(++w>=S)return this._interim=b,a;const m=l.charCodeAt(w);56320<=m&&m<=57343?h[a++]=1024*(b-55296)+m-56320+65536:(h[a++]=b,h[a++]=m)}else b!==65279&&(h[a++]=b)}return a}},o.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(l,h){const S=l.length;if(!S)return 0;let a,p,w,b,m=0,i=0,s=0;if(this.interim[0]){let u=!1,v=this.interim[0];v&=(224&v)==192?31:(240&v)==224?15:7;let C,M=0;for(;(C=63&this.interim[++M])&&M<4;)v<<=6,v|=C;const _=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,y=_-M;for(;s<y;){if(s>=S)return 0;if(C=l[s++],(192&C)!=128){s--,u=!0;break}this.interim[M++]=C,v<<=6,v|=63&C}u||(_===2?v<128?s--:h[m++]=v:_===3?v<2048||v>=55296&&v<=57343||v===65279||(h[m++]=v):v<65536||v>1114111||(h[m++]=v)),this.interim.fill(0)}const r=S-4;let n=s;for(;n<S;){for(;!(!(n<r)||128&(a=l[n])||128&(p=l[n+1])||128&(w=l[n+2])||128&(b=l[n+3]));)h[m++]=a,h[m++]=p,h[m++]=w,h[m++]=b,n+=4;if(a=l[n++],a<128)h[m++]=a;else if((224&a)==192){if(n>=S)return this.interim[0]=a,m;if(p=l[n++],(192&p)!=128){n--;continue}if(i=(31&a)<<6|63&p,i<128){n--;continue}h[m++]=i}else if((240&a)==224){if(n>=S)return this.interim[0]=a,m;if(p=l[n++],(192&p)!=128){n--;continue}if(n>=S)return this.interim[0]=a,this.interim[1]=p,m;if(w=l[n++],(192&w)!=128){n--;continue}if(i=(15&a)<<12|(63&p)<<6|63&w,i<2048||i>=55296&&i<=57343||i===65279)continue;h[m++]=i}else if((248&a)==240){if(n>=S)return this.interim[0]=a,m;if(p=l[n++],(192&p)!=128){n--;continue}if(n>=S)return this.interim[0]=a,this.interim[1]=p,m;if(w=l[n++],(192&w)!=128){n--;continue}if(n>=S)return this.interim[0]=a,this.interim[1]=p,this.interim[2]=w,m;if(b=l[n++],(192&b)!=128){n--;continue}if(i=(7&a)<<18|(63&p)<<12|(63&w)<<6|63&b,i<65536||i>1114111)continue;h[m++]=i}}return m}}},225:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeV6=void 0;const l=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],h=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let S;o.UnicodeV6=class{constructor(){if(this.version="6",!S){S=new Uint8Array(65536),S.fill(1),S[0]=0,S.fill(0,1,32),S.fill(0,127,160),S.fill(2,4352,4448),S[9001]=2,S[9002]=2,S.fill(2,11904,42192),S[12351]=1,S.fill(2,44032,55204),S.fill(2,63744,64256),S.fill(2,65040,65050),S.fill(2,65072,65136),S.fill(2,65280,65377),S.fill(2,65504,65511);for(let a=0;a<l.length;++a)S.fill(0,l[a][0],l[a][1]+1)}}wcwidth(a){return a<32?0:a<127?1:a<65536?S[a]:function(p,w){let b,m=0,i=w.length-1;if(p<w[0][0]||p>w[i][1])return!1;for(;i>=m;)if(b=m+i>>1,p>w[b][1])m=b+1;else{if(!(p<w[b][0]))return!0;i=b-1}return!1}(a,h)?0:a>=131072&&a<=196605||a>=196608&&a<=262141?2:1}}},5981:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WriteBuffer=void 0;const h=l(8460),S=l(844);class a extends S.Disposable{constructor(w){super(),this._action=w,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new h.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(w,b){if(b!==void 0&&this._syncCalls>b)return void(this._syncCalls=0);if(this._pendingData+=w.length,this._writeBuffer.push(w),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let m;for(this._isSyncWriting=!0;m=this._writeBuffer.shift();){this._action(m);const i=this._callbacks.shift();i&&i()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(w,b){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=w.length,this._writeBuffer.push(w),this._callbacks.push(b),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=w.length,this._writeBuffer.push(w),this._callbacks.push(b)}_innerWrite(w=0,b=!0){const m=w||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const i=this._writeBuffer[this._bufferOffset],s=this._action(i,b);if(s){const n=u=>Date.now()-m>=12?setTimeout(()=>this._innerWrite(0,u)):this._innerWrite(m,u);return void s.catch(u=>(queueMicrotask(()=>{throw u}),Promise.resolve(!1))).then(n)}const r=this._callbacks[this._bufferOffset];if(r&&r(),this._bufferOffset++,this._pendingData-=i.length,Date.now()-m>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}o.WriteBuffer=a},5941:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.toRgbString=o.parseColor=void 0;const l=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,h=/^[\da-f]+$/;function S(a,p){const w=a.toString(16),b=w.length<2?"0"+w:w;switch(p){case 4:return w[0];case 8:return b;case 12:return(b+b).slice(0,3);default:return b+b}}o.parseColor=function(a){if(!a)return;let p=a.toLowerCase();if(p.indexOf("rgb:")===0){p=p.slice(4);const w=l.exec(p);if(w){const b=w[1]?15:w[4]?255:w[7]?4095:65535;return[Math.round(parseInt(w[1]||w[4]||w[7]||w[10],16)/b*255),Math.round(parseInt(w[2]||w[5]||w[8]||w[11],16)/b*255),Math.round(parseInt(w[3]||w[6]||w[9]||w[12],16)/b*255)]}}else if(p.indexOf("#")===0&&(p=p.slice(1),h.exec(p)&&[3,6,9,12].includes(p.length))){const w=p.length/3,b=[0,0,0];for(let m=0;m<3;++m){const i=parseInt(p.slice(w*m,w*m+w),16);b[m]=w===1?i<<4:w===2?i:w===3?i>>4:i>>8}return b}},o.toRgbString=function(a,p=16){const[w,b,m]=a;return`rgb:${S(w,p)}/${S(b,p)}/${S(m,p)}`}},5770:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PAYLOAD_LIMIT=void 0,o.PAYLOAD_LIMIT=1e7},6351:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DcsHandler=o.DcsParser=void 0;const h=l(482),S=l(8742),a=l(5770),p=[];o.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=p,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=p}registerHandler(b,m){this._handlers[b]===void 0&&(this._handlers[b]=[]);const i=this._handlers[b];return i.push(m),{dispose:()=>{const s=i.indexOf(m);s!==-1&&i.splice(s,1)}}}clearHandler(b){this._handlers[b]&&delete this._handlers[b]}setHandlerFallback(b){this._handlerFb=b}reset(){if(this._active.length)for(let b=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;b>=0;--b)this._active[b].unhook(!1);this._stack.paused=!1,this._active=p,this._ident=0}hook(b,m){if(this.reset(),this._ident=b,this._active=this._handlers[b]||p,this._active.length)for(let i=this._active.length-1;i>=0;i--)this._active[i].hook(m);else this._handlerFb(this._ident,"HOOK",m)}put(b,m,i){if(this._active.length)for(let s=this._active.length-1;s>=0;s--)this._active[s].put(b,m,i);else this._handlerFb(this._ident,"PUT",(0,h.utf32ToString)(b,m,i))}unhook(b,m=!0){if(this._active.length){let i=!1,s=this._active.length-1,r=!1;if(this._stack.paused&&(s=this._stack.loopPosition-1,i=m,r=this._stack.fallThrough,this._stack.paused=!1),!r&&i===!1){for(;s>=0&&(i=this._active[s].unhook(b),i!==!0);s--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=s,this._stack.fallThrough=!1,i;s--}for(;s>=0;s--)if(i=this._active[s].unhook(!1),i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=s,this._stack.fallThrough=!0,i}else this._handlerFb(this._ident,"UNHOOK",b);this._active=p,this._ident=0}};const w=new S.Params;w.addParam(0),o.DcsHandler=class{constructor(b){this._handler=b,this._data="",this._params=w,this._hitLimit=!1}hook(b){this._params=b.length>1||b.params[0]?b.clone():w,this._data="",this._hitLimit=!1}put(b,m,i){this._hitLimit||(this._data+=(0,h.utf32ToString)(b,m,i),this._data.length>a.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(b){let m=!1;if(this._hitLimit)m=!1;else if(b&&(m=this._handler(this._data,this._params),m instanceof Promise))return m.then(i=>(this._params=w,this._data="",this._hitLimit=!1,i));return this._params=w,this._data="",this._hitLimit=!1,m}}},2015:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.EscapeSequenceParser=o.VT500_TRANSITION_TABLE=o.TransitionTable=void 0;const h=l(844),S=l(8742),a=l(6242),p=l(6351);class w{constructor(s){this.table=new Uint8Array(s)}setDefault(s,r){this.table.fill(s<<4|r)}add(s,r,n,u){this.table[r<<8|s]=n<<4|u}addMany(s,r,n,u){for(let v=0;v<s.length;v++)this.table[r<<8|s[v]]=n<<4|u}}o.TransitionTable=w;const b=160;o.VT500_TRANSITION_TABLE=function(){const i=new w(4095),s=Array.apply(null,Array(256)).map((M,_)=>_),r=(M,_)=>s.slice(M,_),n=r(32,127),u=r(0,24);u.push(25),u.push.apply(u,r(28,32));const v=r(0,14);let C;for(C in i.setDefault(1,0),i.addMany(n,0,2,0),v)i.addMany([24,26,153,154],C,3,0),i.addMany(r(128,144),C,3,0),i.addMany(r(144,152),C,3,0),i.add(156,C,0,0),i.add(27,C,11,1),i.add(157,C,4,8),i.addMany([152,158,159],C,0,7),i.add(155,C,11,3),i.add(144,C,11,9);return i.addMany(u,0,3,0),i.addMany(u,1,3,1),i.add(127,1,0,1),i.addMany(u,8,0,8),i.addMany(u,3,3,3),i.add(127,3,0,3),i.addMany(u,4,3,4),i.add(127,4,0,4),i.addMany(u,6,3,6),i.addMany(u,5,3,5),i.add(127,5,0,5),i.addMany(u,2,3,2),i.add(127,2,0,2),i.add(93,1,4,8),i.addMany(n,8,5,8),i.add(127,8,5,8),i.addMany([156,27,24,26,7],8,6,0),i.addMany(r(28,32),8,0,8),i.addMany([88,94,95],1,0,7),i.addMany(n,7,0,7),i.addMany(u,7,0,7),i.add(156,7,0,0),i.add(127,7,0,7),i.add(91,1,11,3),i.addMany(r(64,127),3,7,0),i.addMany(r(48,60),3,8,4),i.addMany([60,61,62,63],3,9,4),i.addMany(r(48,60),4,8,4),i.addMany(r(64,127),4,7,0),i.addMany([60,61,62,63],4,0,6),i.addMany(r(32,64),6,0,6),i.add(127,6,0,6),i.addMany(r(64,127),6,0,0),i.addMany(r(32,48),3,9,5),i.addMany(r(32,48),5,9,5),i.addMany(r(48,64),5,0,6),i.addMany(r(64,127),5,7,0),i.addMany(r(32,48),4,9,5),i.addMany(r(32,48),1,9,2),i.addMany(r(32,48),2,9,2),i.addMany(r(48,127),2,10,0),i.addMany(r(48,80),1,10,0),i.addMany(r(81,88),1,10,0),i.addMany([89,90,92],1,10,0),i.addMany(r(96,127),1,10,0),i.add(80,1,11,9),i.addMany(u,9,0,9),i.add(127,9,0,9),i.addMany(r(28,32),9,0,9),i.addMany(r(32,48),9,9,12),i.addMany(r(48,60),9,8,10),i.addMany([60,61,62,63],9,9,10),i.addMany(u,11,0,11),i.addMany(r(32,128),11,0,11),i.addMany(r(28,32),11,0,11),i.addMany(u,10,0,10),i.add(127,10,0,10),i.addMany(r(28,32),10,0,10),i.addMany(r(48,60),10,8,10),i.addMany([60,61,62,63],10,0,11),i.addMany(r(32,48),10,9,12),i.addMany(u,12,0,12),i.add(127,12,0,12),i.addMany(r(28,32),12,0,12),i.addMany(r(32,48),12,9,12),i.addMany(r(48,64),12,0,11),i.addMany(r(64,127),12,12,13),i.addMany(r(64,127),10,12,13),i.addMany(r(64,127),9,12,13),i.addMany(u,13,13,13),i.addMany(n,13,13,13),i.add(127,13,0,13),i.addMany([27,156,24,26],13,14,0),i.add(b,0,2,0),i.add(b,8,5,8),i.add(b,6,0,6),i.add(b,11,0,11),i.add(b,13,13,13),i}();class m extends h.Disposable{constructor(s=o.VT500_TRANSITION_TABLE){super(),this._transitions=s,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new S.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(r,n,u)=>{},this._executeHandlerFb=r=>{},this._csiHandlerFb=(r,n)=>{},this._escHandlerFb=r=>{},this._errorHandlerFb=r=>r,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,h.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new a.OscParser),this._dcsParser=this.register(new p.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(s,r=[64,126]){let n=0;if(s.prefix){if(s.prefix.length>1)throw new Error("only one byte as prefix supported");if(n=s.prefix.charCodeAt(0),n&&60>n||n>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(s.intermediates){if(s.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let v=0;v<s.intermediates.length;++v){const C=s.intermediates.charCodeAt(v);if(32>C||C>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");n<<=8,n|=C}}if(s.final.length!==1)throw new Error("final must be a single byte");const u=s.final.charCodeAt(0);if(r[0]>u||u>r[1])throw new Error(`final must be in range ${r[0]} .. ${r[1]}`);return n<<=8,n|=u,n}identToString(s){const r=[];for(;s;)r.push(String.fromCharCode(255&s)),s>>=8;return r.reverse().join("")}setPrintHandler(s){this._printHandler=s}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(s,r){const n=this._identifier(s,[48,126]);this._escHandlers[n]===void 0&&(this._escHandlers[n]=[]);const u=this._escHandlers[n];return u.push(r),{dispose:()=>{const v=u.indexOf(r);v!==-1&&u.splice(v,1)}}}clearEscHandler(s){this._escHandlers[this._identifier(s,[48,126])]&&delete this._escHandlers[this._identifier(s,[48,126])]}setEscHandlerFallback(s){this._escHandlerFb=s}setExecuteHandler(s,r){this._executeHandlers[s.charCodeAt(0)]=r}clearExecuteHandler(s){this._executeHandlers[s.charCodeAt(0)]&&delete this._executeHandlers[s.charCodeAt(0)]}setExecuteHandlerFallback(s){this._executeHandlerFb=s}registerCsiHandler(s,r){const n=this._identifier(s);this._csiHandlers[n]===void 0&&(this._csiHandlers[n]=[]);const u=this._csiHandlers[n];return u.push(r),{dispose:()=>{const v=u.indexOf(r);v!==-1&&u.splice(v,1)}}}clearCsiHandler(s){this._csiHandlers[this._identifier(s)]&&delete this._csiHandlers[this._identifier(s)]}setCsiHandlerFallback(s){this._csiHandlerFb=s}registerDcsHandler(s,r){return this._dcsParser.registerHandler(this._identifier(s),r)}clearDcsHandler(s){this._dcsParser.clearHandler(this._identifier(s))}setDcsHandlerFallback(s){this._dcsParser.setHandlerFallback(s)}registerOscHandler(s,r){return this._oscParser.registerHandler(s,r)}clearOscHandler(s){this._oscParser.clearHandler(s)}setOscHandlerFallback(s){this._oscParser.setHandlerFallback(s)}setErrorHandler(s){this._errorHandler=s}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(s,r,n,u,v){this._parseStack.state=s,this._parseStack.handlers=r,this._parseStack.handlerPos=n,this._parseStack.transition=u,this._parseStack.chunkPos=v}parse(s,r,n){let u,v=0,C=0,M=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,M=this._parseStack.chunkPos+1;else{if(n===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const _=this._parseStack.handlers;let y=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(n===!1&&y>-1){for(;y>=0&&(u=_[y](this._params),u!==!0);y--)if(u instanceof Promise)return this._parseStack.handlerPos=y,u}this._parseStack.handlers=[];break;case 4:if(n===!1&&y>-1){for(;y>=0&&(u=_[y](),u!==!0);y--)if(u instanceof Promise)return this._parseStack.handlerPos=y,u}this._parseStack.handlers=[];break;case 6:if(v=s[this._parseStack.chunkPos],u=this._dcsParser.unhook(v!==24&&v!==26,n),u)return u;v===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(v=s[this._parseStack.chunkPos],u=this._oscParser.end(v!==24&&v!==26,n),u)return u;v===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,M=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let _=M;_<r;++_){switch(v=s[_],C=this._transitions.table[this.currentState<<8|(v<160?v:b)],C>>4){case 2:for(let g=_+1;;++g){if(g>=r||(v=s[g])<32||v>126&&v<b){this._printHandler(s,_,g),_=g-1;break}if(++g>=r||(v=s[g])<32||v>126&&v<b){this._printHandler(s,_,g),_=g-1;break}if(++g>=r||(v=s[g])<32||v>126&&v<b){this._printHandler(s,_,g),_=g-1;break}if(++g>=r||(v=s[g])<32||v>126&&v<b){this._printHandler(s,_,g),_=g-1;break}}break;case 3:this._executeHandlers[v]?this._executeHandlers[v]():this._executeHandlerFb(v),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:_,code:v,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const y=this._csiHandlers[this._collect<<8|v];let I=y?y.length-1:-1;for(;I>=0&&(u=y[I](this._params),u!==!0);I--)if(u instanceof Promise)return this._preserveStack(3,y,I,C,_),u;I<0&&this._csiHandlerFb(this._collect<<8|v,this._params),this.precedingCodepoint=0;break;case 8:do switch(v){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(v-48)}while(++_<r&&(v=s[_])>47&&v<60);_--;break;case 9:this._collect<<=8,this._collect|=v;break;case 10:const N=this._escHandlers[this._collect<<8|v];let d=N?N.length-1:-1;for(;d>=0&&(u=N[d](),u!==!0);d--)if(u instanceof Promise)return this._preserveStack(4,N,d,C,_),u;d<0&&this._escHandlerFb(this._collect<<8|v),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|v,this._params);break;case 13:for(let g=_+1;;++g)if(g>=r||(v=s[g])===24||v===26||v===27||v>127&&v<b){this._dcsParser.put(s,_,g),_=g-1;break}break;case 14:if(u=this._dcsParser.unhook(v!==24&&v!==26),u)return this._preserveStack(6,[],0,C,_),u;v===27&&(C|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let g=_+1;;g++)if(g>=r||(v=s[g])<32||v>127&&v<b){this._oscParser.put(s,_,g),_=g-1;break}break;case 6:if(u=this._oscParser.end(v!==24&&v!==26),u)return this._preserveStack(5,[],0,C,_),u;v===27&&(C|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&C}}}o.EscapeSequenceParser=m},6242:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.OscHandler=o.OscParser=void 0;const h=l(5770),S=l(482),a=[];o.OscParser=class{constructor(){this._state=0,this._active=a,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(p,w){this._handlers[p]===void 0&&(this._handlers[p]=[]);const b=this._handlers[p];return b.push(w),{dispose:()=>{const m=b.indexOf(w);m!==-1&&b.splice(m,1)}}}clearHandler(p){this._handlers[p]&&delete this._handlers[p]}setHandlerFallback(p){this._handlerFb=p}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=a}reset(){if(this._state===2)for(let p=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;p>=0;--p)this._active[p].end(!1);this._stack.paused=!1,this._active=a,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||a,this._active.length)for(let p=this._active.length-1;p>=0;p--)this._active[p].start();else this._handlerFb(this._id,"START")}_put(p,w,b){if(this._active.length)for(let m=this._active.length-1;m>=0;m--)this._active[m].put(p,w,b);else this._handlerFb(this._id,"PUT",(0,S.utf32ToString)(p,w,b))}start(){this.reset(),this._state=1}put(p,w,b){if(this._state!==3){if(this._state===1)for(;w<b;){const m=p[w++];if(m===59){this._state=2,this._start();break}if(m<48||57<m)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+m-48}this._state===2&&b-w>0&&this._put(p,w,b)}}end(p,w=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let b=!1,m=this._active.length-1,i=!1;if(this._stack.paused&&(m=this._stack.loopPosition-1,b=w,i=this._stack.fallThrough,this._stack.paused=!1),!i&&b===!1){for(;m>=0&&(b=this._active[m].end(p),b!==!0);m--)if(b instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=m,this._stack.fallThrough=!1,b;m--}for(;m>=0;m--)if(b=this._active[m].end(!1),b instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=m,this._stack.fallThrough=!0,b}else this._handlerFb(this._id,"END",p);this._active=a,this._id=-1,this._state=0}}},o.OscHandler=class{constructor(p){this._handler=p,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(p,w,b){this._hitLimit||(this._data+=(0,S.utf32ToString)(p,w,b),this._data.length>h.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(p){let w=!1;if(this._hitLimit)w=!1;else if(p&&(w=this._handler(this._data),w instanceof Promise))return w.then(b=>(this._data="",this._hitLimit=!1,b));return this._data="",this._hitLimit=!1,w}}},8742:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Params=void 0;const l=2147483647;class h{static fromArray(a){const p=new h;if(!a.length)return p;for(let w=Array.isArray(a[0])?1:0;w<a.length;++w){const b=a[w];if(Array.isArray(b))for(let m=0;m<b.length;++m)p.addSubParam(b[m]);else p.addParam(b)}return p}constructor(a=32,p=32){if(this.maxLength=a,this.maxSubParamsLength=p,p>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(a),this.length=0,this._subParams=new Int32Array(p),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(a),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const a=new h(this.maxLength,this.maxSubParamsLength);return a.params.set(this.params),a.length=this.length,a._subParams.set(this._subParams),a._subParamsLength=this._subParamsLength,a._subParamsIdx.set(this._subParamsIdx),a._rejectDigits=this._rejectDigits,a._rejectSubDigits=this._rejectSubDigits,a._digitIsSub=this._digitIsSub,a}toArray(){const a=[];for(let p=0;p<this.length;++p){a.push(this.params[p]);const w=this._subParamsIdx[p]>>8,b=255&this._subParamsIdx[p];b-w>0&&a.push(Array.prototype.slice.call(this._subParams,w,b))}return a}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(a){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(a<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=a>l?l:a}}addSubParam(a){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(a<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=a>l?l:a,this._subParamsIdx[this.length-1]++}}hasSubParams(a){return(255&this._subParamsIdx[a])-(this._subParamsIdx[a]>>8)>0}getSubParams(a){const p=this._subParamsIdx[a]>>8,w=255&this._subParamsIdx[a];return w-p>0?this._subParams.subarray(p,w):null}getSubParamsAll(){const a={};for(let p=0;p<this.length;++p){const w=this._subParamsIdx[p]>>8,b=255&this._subParamsIdx[p];b-w>0&&(a[p]=this._subParams.slice(w,b))}return a}addDigit(a){let p;if(this._rejectDigits||!(p=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const w=this._digitIsSub?this._subParams:this.params,b=w[p-1];w[p-1]=~b?Math.min(10*b+a,l):a}}o.Params=h},5741:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.AddonManager=void 0,o.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let l=this._addons.length-1;l>=0;l--)this._addons[l].instance.dispose()}loadAddon(l,h){const S={instance:h,dispose:h.dispose,isDisposed:!1};this._addons.push(S),h.dispose=()=>this._wrappedAddonDispose(S),h.activate(l)}_wrappedAddonDispose(l){if(l.isDisposed)return;let h=-1;for(let S=0;S<this._addons.length;S++)if(this._addons[S]===l){h=S;break}if(h===-1)throw new Error("Could not dispose an addon that has not been loaded");l.isDisposed=!0,l.dispose.apply(l.instance),this._addons.splice(h,1)}}},8771:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferApiView=void 0;const h=l(3785),S=l(511);o.BufferApiView=class{constructor(a,p){this._buffer=a,this.type=p}init(a){return this._buffer=a,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(a){const p=this._buffer.lines.get(a);if(p)return new h.BufferLineApiView(p)}getNullCell(){return new S.CellData}}},3785:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferLineApiView=void 0;const h=l(511);o.BufferLineApiView=class{constructor(S){this._line=S}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(S,a){if(!(S<0||S>=this._line.length))return a?(this._line.loadCell(S,a),a):this._line.loadCell(S,new h.CellData)}translateToString(S,a,p){return this._line.translateToString(S,a,p)}}},8285:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferNamespaceApi=void 0;const h=l(8771),S=l(8460),a=l(844);class p extends a.Disposable{constructor(b){super(),this._core=b,this._onBufferChange=this.register(new S.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new h.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new h.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}o.BufferNamespaceApi=p},7975:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ParserApi=void 0,o.ParserApi=class{constructor(l){this._core=l}registerCsiHandler(l,h){return this._core.registerCsiHandler(l,S=>h(S.toArray()))}addCsiHandler(l,h){return this.registerCsiHandler(l,h)}registerDcsHandler(l,h){return this._core.registerDcsHandler(l,(S,a)=>h(S,a.toArray()))}addDcsHandler(l,h){return this.registerDcsHandler(l,h)}registerEscHandler(l,h){return this._core.registerEscHandler(l,h)}addEscHandler(l,h){return this.registerEscHandler(l,h)}registerOscHandler(l,h){return this._core.registerOscHandler(l,h)}addOscHandler(l,h){return this.registerOscHandler(l,h)}}},7090:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeApi=void 0,o.UnicodeApi=class{constructor(l){this._core=l}register(l){this._core.unicodeService.register(l)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(l){this._core.unicodeService.activeVersion=l}}},744:function(L,o,l){var h=this&&this.__decorate||function(i,s,r,n){var u,v=arguments.length,C=v<3?s:n===null?n=Object.getOwnPropertyDescriptor(s,r):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(i,s,r,n);else for(var M=i.length-1;M>=0;M--)(u=i[M])&&(C=(v<3?u(C):v>3?u(s,r,C):u(s,r))||C);return v>3&&C&&Object.defineProperty(s,r,C),C},S=this&&this.__param||function(i,s){return function(r,n){s(r,n,i)}};Object.defineProperty(o,"__esModule",{value:!0}),o.BufferService=o.MINIMUM_ROWS=o.MINIMUM_COLS=void 0;const a=l(8460),p=l(844),w=l(5295),b=l(2585);o.MINIMUM_COLS=2,o.MINIMUM_ROWS=1;let m=o.BufferService=class extends p.Disposable{get buffer(){return this.buffers.active}constructor(i){super(),this.isUserScrolling=!1,this._onResize=this.register(new a.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new a.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(i.rawOptions.cols||0,o.MINIMUM_COLS),this.rows=Math.max(i.rawOptions.rows||0,o.MINIMUM_ROWS),this.buffers=this.register(new w.BufferSet(i,this))}resize(i,s){this.cols=i,this.rows=s,this.buffers.resize(i,s),this._onResize.fire({cols:i,rows:s})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(i,s=!1){const r=this.buffer;let n;n=this._cachedBlankLine,n&&n.length===this.cols&&n.getFg(0)===i.fg&&n.getBg(0)===i.bg||(n=r.getBlankLine(i,s),this._cachedBlankLine=n),n.isWrapped=s;const u=r.ybase+r.scrollTop,v=r.ybase+r.scrollBottom;if(r.scrollTop===0){const C=r.lines.isFull;v===r.lines.length-1?C?r.lines.recycle().copyFrom(n):r.lines.push(n.clone()):r.lines.splice(v+1,0,n.clone()),C?this.isUserScrolling&&(r.ydisp=Math.max(r.ydisp-1,0)):(r.ybase++,this.isUserScrolling||r.ydisp++)}else{const C=v-u+1;r.lines.shiftElements(u+1,C-1,-1),r.lines.set(v,n.clone())}this.isUserScrolling||(r.ydisp=r.ybase),this._onScroll.fire(r.ydisp)}scrollLines(i,s,r){const n=this.buffer;if(i<0){if(n.ydisp===0)return;this.isUserScrolling=!0}else i+n.ydisp>=n.ybase&&(this.isUserScrolling=!1);const u=n.ydisp;n.ydisp=Math.max(Math.min(n.ydisp+i,n.ybase),0),u!==n.ydisp&&(s||this._onScroll.fire(n.ydisp))}};o.BufferService=m=h([S(0,b.IOptionsService)],m)},7994:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CharsetService=void 0,o.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(l){this.glevel=l,this.charset=this._charsets[l]}setgCharset(l,h){this._charsets[l]=h,this.glevel===l&&(this.charset=h)}}},1753:function(L,o,l){var h=this&&this.__decorate||function(n,u,v,C){var M,_=arguments.length,y=_<3?u:C===null?C=Object.getOwnPropertyDescriptor(u,v):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(n,u,v,C);else for(var I=n.length-1;I>=0;I--)(M=n[I])&&(y=(_<3?M(y):_>3?M(u,v,y):M(u,v))||y);return _>3&&y&&Object.defineProperty(u,v,y),y},S=this&&this.__param||function(n,u){return function(v,C){u(v,C,n)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CoreMouseService=void 0;const a=l(2585),p=l(8460),w=l(844),b={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:n=>n.button!==4&&n.action===1&&(n.ctrl=!1,n.alt=!1,n.shift=!1,!0)},VT200:{events:19,restrict:n=>n.action!==32},DRAG:{events:23,restrict:n=>n.action!==32||n.button!==3},ANY:{events:31,restrict:n=>!0}};function m(n,u){let v=(n.ctrl?16:0)|(n.shift?4:0)|(n.alt?8:0);return n.button===4?(v|=64,v|=n.action):(v|=3&n.button,4&n.button&&(v|=64),8&n.button&&(v|=128),n.action===32?v|=32:n.action!==0||u||(v|=3)),v}const i=String.fromCharCode,s={DEFAULT:n=>{const u=[m(n,!1)+32,n.col+32,n.row+32];return u[0]>255||u[1]>255||u[2]>255?"":`\x1B[M${i(u[0])}${i(u[1])}${i(u[2])}`},SGR:n=>{const u=n.action===0&&n.button!==4?"m":"M";return`\x1B[<${m(n,!0)};${n.col};${n.row}${u}`},SGR_PIXELS:n=>{const u=n.action===0&&n.button!==4?"m":"M";return`\x1B[<${m(n,!0)};${n.x};${n.y}${u}`}};let r=o.CoreMouseService=class extends w.Disposable{constructor(n,u){super(),this._bufferService=n,this._coreService=u,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new p.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const v of Object.keys(b))this.addProtocol(v,b[v]);for(const v of Object.keys(s))this.addEncoding(v,s[v]);this.reset()}addProtocol(n,u){this._protocols[n]=u}addEncoding(n,u){this._encodings[n]=u}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(n){if(!this._protocols[n])throw new Error(`unknown protocol "${n}"`);this._activeProtocol=n,this._onProtocolChange.fire(this._protocols[n].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(n){if(!this._encodings[n])throw new Error(`unknown encoding "${n}"`);this._activeEncoding=n}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(n){if(n.col<0||n.col>=this._bufferService.cols||n.row<0||n.row>=this._bufferService.rows||n.button===4&&n.action===32||n.button===3&&n.action!==32||n.button!==4&&(n.action===2||n.action===3)||(n.col++,n.row++,n.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,n,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(n))return!1;const u=this._encodings[this._activeEncoding](n);return u&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(u):this._coreService.triggerDataEvent(u,!0)),this._lastEvent=n,!0}explainEvents(n){return{down:!!(1&n),up:!!(2&n),drag:!!(4&n),move:!!(8&n),wheel:!!(16&n)}}_equalEvents(n,u,v){if(v){if(n.x!==u.x||n.y!==u.y)return!1}else if(n.col!==u.col||n.row!==u.row)return!1;return n.button===u.button&&n.action===u.action&&n.ctrl===u.ctrl&&n.alt===u.alt&&n.shift===u.shift}};o.CoreMouseService=r=h([S(0,a.IBufferService),S(1,a.ICoreService)],r)},6975:function(L,o,l){var h=this&&this.__decorate||function(r,n,u,v){var C,M=arguments.length,_=M<3?n:v===null?v=Object.getOwnPropertyDescriptor(n,u):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(r,n,u,v);else for(var y=r.length-1;y>=0;y--)(C=r[y])&&(_=(M<3?C(_):M>3?C(n,u,_):C(n,u))||_);return M>3&&_&&Object.defineProperty(n,u,_),_},S=this&&this.__param||function(r,n){return function(u,v){n(u,v,r)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CoreService=void 0;const a=l(1439),p=l(8460),w=l(844),b=l(2585),m=Object.freeze({insertMode:!1}),i=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let s=o.CoreService=class extends w.Disposable{constructor(r,n,u){super(),this._bufferService=r,this._logService=n,this._optionsService=u,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new p.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new p.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new p.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new p.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,a.clone)(m),this.decPrivateModes=(0,a.clone)(i)}reset(){this.modes=(0,a.clone)(m),this.decPrivateModes=(0,a.clone)(i)}triggerDataEvent(r,n=!1){if(this._optionsService.rawOptions.disableStdin)return;const u=this._bufferService.buffer;n&&this._optionsService.rawOptions.scrollOnUserInput&&u.ybase!==u.ydisp&&this._onRequestScrollToBottom.fire(),n&&this._onUserInput.fire(),this._logService.debug(`sending data "${r}"`,()=>r.split("").map(v=>v.charCodeAt(0))),this._onData.fire(r)}triggerBinaryEvent(r){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${r}"`,()=>r.split("").map(n=>n.charCodeAt(0))),this._onBinary.fire(r))}};o.CoreService=s=h([S(0,b.IBufferService),S(1,b.ILogService),S(2,b.IOptionsService)],s)},9074:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DecorationService=void 0;const h=l(8055),S=l(8460),a=l(844),p=l(6106);let w=0,b=0;class m extends a.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new p.SortedList(r=>r?.marker.line),this._onDecorationRegistered=this.register(new S.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new S.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,a.toDisposable)(()=>this.reset()))}registerDecoration(r){if(r.marker.isDisposed)return;const n=new i(r);if(n){const u=n.marker.onDispose(()=>n.dispose());n.onDispose(()=>{n&&(this._decorations.delete(n)&&this._onDecorationRemoved.fire(n),u.dispose())}),this._decorations.insert(n),this._onDecorationRegistered.fire(n)}return n}reset(){for(const r of this._decorations.values())r.dispose();this._decorations.clear()}*getDecorationsAtCell(r,n,u){var v,C,M;let _=0,y=0;for(const I of this._decorations.getKeyIterator(n))_=(v=I.options.x)!==null&&v!==void 0?v:0,y=_+((C=I.options.width)!==null&&C!==void 0?C:1),r>=_&&r<y&&(!u||((M=I.options.layer)!==null&&M!==void 0?M:"bottom")===u)&&(yield I)}forEachDecorationAtCell(r,n,u,v){this._decorations.forEachByKey(n,C=>{var M,_,y;w=(M=C.options.x)!==null&&M!==void 0?M:0,b=w+((_=C.options.width)!==null&&_!==void 0?_:1),r>=w&&r<b&&(!u||((y=C.options.layer)!==null&&y!==void 0?y:"bottom")===u)&&v(C)})}}o.DecorationService=m;class i extends a.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=h.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=h.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(r){super(),this.options=r,this.onRenderEmitter=this.register(new S.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new S.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=r.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.InstantiationService=o.ServiceCollection=void 0;const h=l(2585),S=l(8343);class a{constructor(...w){this._entries=new Map;for(const[b,m]of w)this.set(b,m)}set(w,b){const m=this._entries.get(w);return this._entries.set(w,b),m}forEach(w){for(const[b,m]of this._entries.entries())w(b,m)}has(w){return this._entries.has(w)}get(w){return this._entries.get(w)}}o.ServiceCollection=a,o.InstantiationService=class{constructor(){this._services=new a,this._services.set(h.IInstantiationService,this)}setService(p,w){this._services.set(p,w)}getService(p){return this._services.get(p)}createInstance(p,...w){const b=(0,S.getServiceDependencies)(p).sort((s,r)=>s.index-r.index),m=[];for(const s of b){const r=this._services.get(s.id);if(!r)throw new Error(`[createInstance] ${p.name} depends on UNKNOWN service ${s.id}.`);m.push(r)}const i=b.length>0?b[0].index:w.length;if(w.length!==i)throw new Error(`[createInstance] First service dependency of ${p.name} at position ${i+1} conflicts with ${w.length} static arguments`);return new p(...w,...m)}}},7866:function(L,o,l){var h=this&&this.__decorate||function(i,s,r,n){var u,v=arguments.length,C=v<3?s:n===null?n=Object.getOwnPropertyDescriptor(s,r):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(i,s,r,n);else for(var M=i.length-1;M>=0;M--)(u=i[M])&&(C=(v<3?u(C):v>3?u(s,r,C):u(s,r))||C);return v>3&&C&&Object.defineProperty(s,r,C),C},S=this&&this.__param||function(i,s){return function(r,n){s(r,n,i)}};Object.defineProperty(o,"__esModule",{value:!0}),o.traceCall=o.setTraceLogger=o.LogService=void 0;const a=l(844),p=l(2585),w={trace:p.LogLevelEnum.TRACE,debug:p.LogLevelEnum.DEBUG,info:p.LogLevelEnum.INFO,warn:p.LogLevelEnum.WARN,error:p.LogLevelEnum.ERROR,off:p.LogLevelEnum.OFF};let b,m=o.LogService=class extends a.Disposable{get logLevel(){return this._logLevel}constructor(i){super(),this._optionsService=i,this._logLevel=p.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),b=this}_updateLogLevel(){this._logLevel=w[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(i){for(let s=0;s<i.length;s++)typeof i[s]=="function"&&(i[s]=i[s]())}_log(i,s,r){this._evalLazyOptionalParams(r),i.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+s,...r)}trace(i,...s){var r,n;this._logLevel<=p.LogLevelEnum.TRACE&&this._log((n=(r=this._optionsService.options.logger)===null||r===void 0?void 0:r.trace.bind(this._optionsService.options.logger))!==null&&n!==void 0?n:console.log,i,s)}debug(i,...s){var r,n;this._logLevel<=p.LogLevelEnum.DEBUG&&this._log((n=(r=this._optionsService.options.logger)===null||r===void 0?void 0:r.debug.bind(this._optionsService.options.logger))!==null&&n!==void 0?n:console.log,i,s)}info(i,...s){var r,n;this._logLevel<=p.LogLevelEnum.INFO&&this._log((n=(r=this._optionsService.options.logger)===null||r===void 0?void 0:r.info.bind(this._optionsService.options.logger))!==null&&n!==void 0?n:console.info,i,s)}warn(i,...s){var r,n;this._logLevel<=p.LogLevelEnum.WARN&&this._log((n=(r=this._optionsService.options.logger)===null||r===void 0?void 0:r.warn.bind(this._optionsService.options.logger))!==null&&n!==void 0?n:console.warn,i,s)}error(i,...s){var r,n;this._logLevel<=p.LogLevelEnum.ERROR&&this._log((n=(r=this._optionsService.options.logger)===null||r===void 0?void 0:r.error.bind(this._optionsService.options.logger))!==null&&n!==void 0?n:console.error,i,s)}};o.LogService=m=h([S(0,p.IOptionsService)],m),o.setTraceLogger=function(i){b=i},o.traceCall=function(i,s,r){if(typeof r.value!="function")throw new Error("not supported");const n=r.value;r.value=function(...u){if(b.logLevel!==p.LogLevelEnum.TRACE)return n.apply(this,u);b.trace(`GlyphRenderer#${n.name}(${u.map(C=>JSON.stringify(C)).join(", ")})`);const v=n.apply(this,u);return b.trace(`GlyphRenderer#${n.name} return`,v),v}}},7302:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.OptionsService=o.DEFAULT_OPTIONS=void 0;const h=l(8460),S=l(844),a=l(6114);o.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:a.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const p=["normal","bold","100","200","300","400","500","600","700","800","900"];class w extends S.Disposable{constructor(m){super(),this._onOptionChange=this.register(new h.EventEmitter),this.onOptionChange=this._onOptionChange.event;const i=Object.assign({},o.DEFAULT_OPTIONS);for(const s in m)if(s in i)try{const r=m[s];i[s]=this._sanitizeAndValidateOption(s,r)}catch(r){console.error(r)}this.rawOptions=i,this.options=Object.assign({},i),this._setupOptions()}onSpecificOptionChange(m,i){return this.onOptionChange(s=>{s===m&&i(this.rawOptions[m])})}onMultipleOptionChange(m,i){return this.onOptionChange(s=>{m.indexOf(s)!==-1&&i()})}_setupOptions(){const m=s=>{if(!(s in o.DEFAULT_OPTIONS))throw new Error(`No option with key "${s}"`);return this.rawOptions[s]},i=(s,r)=>{if(!(s in o.DEFAULT_OPTIONS))throw new Error(`No option with key "${s}"`);r=this._sanitizeAndValidateOption(s,r),this.rawOptions[s]!==r&&(this.rawOptions[s]=r,this._onOptionChange.fire(s))};for(const s in this.rawOptions){const r={get:m.bind(this,s),set:i.bind(this,s)};Object.defineProperty(this.options,s,r)}}_sanitizeAndValidateOption(m,i){switch(m){case"cursorStyle":if(i||(i=o.DEFAULT_OPTIONS[m]),!function(s){return s==="block"||s==="underline"||s==="bar"}(i))throw new Error(`"${i}" is not a valid value for ${m}`);break;case"wordSeparator":i||(i=o.DEFAULT_OPTIONS[m]);break;case"fontWeight":case"fontWeightBold":if(typeof i=="number"&&1<=i&&i<=1e3)break;i=p.includes(i)?i:o.DEFAULT_OPTIONS[m];break;case"cursorWidth":i=Math.floor(i);case"lineHeight":case"tabStopWidth":if(i<1)throw new Error(`${m} cannot be less than 1, value: ${i}`);break;case"minimumContrastRatio":i=Math.max(1,Math.min(21,Math.round(10*i)/10));break;case"scrollback":if((i=Math.min(i,4294967295))<0)throw new Error(`${m} cannot be less than 0, value: ${i}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(i<=0)throw new Error(`${m} cannot be less than or equal to 0, value: ${i}`);break;case"rows":case"cols":if(!i&&i!==0)throw new Error(`${m} must be numeric, value: ${i}`);break;case"windowsPty":i=i??{}}return i}}o.OptionsService=w},2660:function(L,o,l){var h=this&&this.__decorate||function(w,b,m,i){var s,r=arguments.length,n=r<3?b:i===null?i=Object.getOwnPropertyDescriptor(b,m):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(w,b,m,i);else for(var u=w.length-1;u>=0;u--)(s=w[u])&&(n=(r<3?s(n):r>3?s(b,m,n):s(b,m))||n);return r>3&&n&&Object.defineProperty(b,m,n),n},S=this&&this.__param||function(w,b){return function(m,i){b(m,i,w)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OscLinkService=void 0;const a=l(2585);let p=o.OscLinkService=class{constructor(w){this._bufferService=w,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(w){const b=this._bufferService.buffer;if(w.id===void 0){const u=b.addMarker(b.ybase+b.y),v={data:w,id:this._nextId++,lines:[u]};return u.onDispose(()=>this._removeMarkerFromLink(v,u)),this._dataByLinkId.set(v.id,v),v.id}const m=w,i=this._getEntryIdKey(m),s=this._entriesWithId.get(i);if(s)return this.addLineToLink(s.id,b.ybase+b.y),s.id;const r=b.addMarker(b.ybase+b.y),n={id:this._nextId++,key:this._getEntryIdKey(m),data:m,lines:[r]};return r.onDispose(()=>this._removeMarkerFromLink(n,r)),this._entriesWithId.set(n.key,n),this._dataByLinkId.set(n.id,n),n.id}addLineToLink(w,b){const m=this._dataByLinkId.get(w);if(m&&m.lines.every(i=>i.line!==b)){const i=this._bufferService.buffer.addMarker(b);m.lines.push(i),i.onDispose(()=>this._removeMarkerFromLink(m,i))}}getLinkData(w){var b;return(b=this._dataByLinkId.get(w))===null||b===void 0?void 0:b.data}_getEntryIdKey(w){return`${w.id};;${w.uri}`}_removeMarkerFromLink(w,b){const m=w.lines.indexOf(b);m!==-1&&(w.lines.splice(m,1),w.lines.length===0&&(w.data.id!==void 0&&this._entriesWithId.delete(w.key),this._dataByLinkId.delete(w.id)))}};o.OscLinkService=p=h([S(0,a.IBufferService)],p)},8343:(L,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.createDecorator=o.getServiceDependencies=o.serviceRegistry=void 0;const l="di$target",h="di$dependencies";o.serviceRegistry=new Map,o.getServiceDependencies=function(S){return S[h]||[]},o.createDecorator=function(S){if(o.serviceRegistry.has(S))return o.serviceRegistry.get(S);const a=function(p,w,b){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(m,i,s){i[l]===i?i[h].push({id:m,index:s}):(i[h]=[{id:m,index:s}],i[l]=i)})(a,p,b)};return a.toString=()=>S,o.serviceRegistry.set(S,a),a}},2585:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.IDecorationService=o.IUnicodeService=o.IOscLinkService=o.IOptionsService=o.ILogService=o.LogLevelEnum=o.IInstantiationService=o.ICharsetService=o.ICoreService=o.ICoreMouseService=o.IBufferService=void 0;const h=l(8343);var S;o.IBufferService=(0,h.createDecorator)("BufferService"),o.ICoreMouseService=(0,h.createDecorator)("CoreMouseService"),o.ICoreService=(0,h.createDecorator)("CoreService"),o.ICharsetService=(0,h.createDecorator)("CharsetService"),o.IInstantiationService=(0,h.createDecorator)("InstantiationService"),function(a){a[a.TRACE=0]="TRACE",a[a.DEBUG=1]="DEBUG",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.OFF=5]="OFF"}(S||(o.LogLevelEnum=S={})),o.ILogService=(0,h.createDecorator)("LogService"),o.IOptionsService=(0,h.createDecorator)("OptionsService"),o.IOscLinkService=(0,h.createDecorator)("OscLinkService"),o.IUnicodeService=(0,h.createDecorator)("UnicodeService"),o.IDecorationService=(0,h.createDecorator)("DecorationService")},1480:(L,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeService=void 0;const h=l(8460),S=l(225);o.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new h.EventEmitter,this.onChange=this._onChange.event;const a=new S.UnicodeV6;this.register(a),this._active=a.version,this._activeProvider=a}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(a){if(!this._providers[a])throw new Error(`unknown Unicode version "${a}"`);this._active=a,this._activeProvider=this._providers[a],this._onChange.fire(a)}register(a){this._providers[a.version]=a}wcwidth(a){return this._activeProvider.wcwidth(a)}getStringCellWidth(a){let p=0;const w=a.length;for(let b=0;b<w;++b){let m=a.charCodeAt(b);if(55296<=m&&m<=56319){if(++b>=w)return p+this.wcwidth(m);const i=a.charCodeAt(b);56320<=i&&i<=57343?m=1024*(m-55296)+i-56320+65536:p+=this.wcwidth(i)}p+=this.wcwidth(m)}return p}}}},f={};function E(L){var o=f[L];if(o!==void 0)return o.exports;var l=f[L]={exports:{}};return c[L].call(l.exports,l,l.exports,E),l.exports}var R={};return(()=>{var L=R;Object.defineProperty(L,"__esModule",{value:!0}),L.Terminal=void 0;const o=E(9042),l=E(3236),h=E(844),S=E(5741),a=E(8285),p=E(7975),w=E(7090),b=["cols","rows"];class m extends h.Disposable{constructor(s){super(),this._core=this.register(new l.Terminal(s)),this._addonManager=this.register(new S.AddonManager),this._publicOptions=Object.assign({},this._core.options);const r=u=>this._core.options[u],n=(u,v)=>{this._checkReadonlyOptions(u),this._core.options[u]=v};for(const u in this._core.options){const v={get:r.bind(this,u),set:n.bind(this,u)};Object.defineProperty(this._publicOptions,u,v)}}_checkReadonlyOptions(s){if(b.includes(s))throw new Error(`Option "${s}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new p.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new w.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new a.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const s=this._core.coreService.decPrivateModes;let r="none";switch(this._core.coreMouseService.activeProtocol){case"X10":r="x10";break;case"VT200":r="vt200";break;case"DRAG":r="drag";break;case"ANY":r="any"}return{applicationCursorKeysMode:s.applicationCursorKeys,applicationKeypadMode:s.applicationKeypad,bracketedPasteMode:s.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:r,originMode:s.origin,reverseWraparoundMode:s.reverseWraparound,sendFocusMode:s.sendFocus,wraparoundMode:s.wraparound}}get options(){return this._publicOptions}set options(s){for(const r in s)this._publicOptions[r]=s[r]}blur(){this._core.blur()}focus(){this._core.focus()}resize(s,r){this._verifyIntegers(s,r),this._core.resize(s,r)}open(s){this._core.open(s)}attachCustomKeyEventHandler(s){this._core.attachCustomKeyEventHandler(s)}registerLinkProvider(s){return this._core.registerLinkProvider(s)}registerCharacterJoiner(s){return this._checkProposedApi(),this._core.registerCharacterJoiner(s)}deregisterCharacterJoiner(s){this._checkProposedApi(),this._core.deregisterCharacterJoiner(s)}registerMarker(s=0){return this._verifyIntegers(s),this._core.registerMarker(s)}registerDecoration(s){var r,n,u;return this._checkProposedApi(),this._verifyPositiveIntegers((r=s.x)!==null&&r!==void 0?r:0,(n=s.width)!==null&&n!==void 0?n:0,(u=s.height)!==null&&u!==void 0?u:0),this._core.registerDecoration(s)}hasSelection(){return this._core.hasSelection()}select(s,r,n){this._verifyIntegers(s,r,n),this._core.select(s,r,n)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(s,r){this._verifyIntegers(s,r),this._core.selectLines(s,r)}dispose(){super.dispose()}scrollLines(s){this._verifyIntegers(s),this._core.scrollLines(s)}scrollPages(s){this._verifyIntegers(s),this._core.scrollPages(s)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(s){this._verifyIntegers(s),this._core.scrollToLine(s)}clear(){this._core.clear()}write(s,r){this._core.write(s,r)}writeln(s,r){this._core.write(s),this._core.write(`\r
`,r)}paste(s){this._core.paste(s)}refresh(s,r){this._verifyIntegers(s,r),this._core.refresh(s,r)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(s){this._addonManager.loadAddon(this,s)}static get strings(){return o}_verifyIntegers(...s){for(const r of s)if(r===1/0||isNaN(r)||r%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...s){for(const r of s)if(r&&(r===1/0||isNaN(r)||r%1!=0||r<0))throw new Error("This API only accepts positive integers")}}L.Terminal=m})(),R})())})(Pr);var nh=Pr.exports,Br={exports:{}};(function(e,t){(function(c,f){e.exports=f()})(self,()=>(()=>{var c={};return(()=>{var f=c;Object.defineProperty(f,"__esModule",{value:!0}),f.FitAddon=void 0,f.FitAddon=class{activate(E){this._terminal=E}dispose(){}fit(){const E=this.proposeDimensions();if(!E||!this._terminal||isNaN(E.cols)||isNaN(E.rows))return;const R=this._terminal._core;this._terminal.rows===E.rows&&this._terminal.cols===E.cols||(R._renderService.clear(),this._terminal.resize(E.cols,E.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const E=this._terminal._core,R=E._renderService.dimensions;if(R.css.cell.width===0||R.css.cell.height===0)return;const L=this._terminal.options.scrollback===0?0:E.viewport.scrollBarWidth,o=window.getComputedStyle(this._terminal.element.parentElement),l=parseInt(o.getPropertyValue("height")),h=Math.max(0,parseInt(o.getPropertyValue("width"))),S=window.getComputedStyle(this._terminal.element),a=l-(parseInt(S.getPropertyValue("padding-top"))+parseInt(S.getPropertyValue("padding-bottom"))),p=h-(parseInt(S.getPropertyValue("padding-right"))+parseInt(S.getPropertyValue("padding-left")))-L;return{cols:Math.max(2,Math.floor(p/R.css.cell.width)),rows:Math.max(1,Math.floor(a/R.css.cell.height))}}}})(),c})())})(Br);var oh=Br.exports;const ah={class:"content",style:{overflow:"hidden"}},lh={class:"terminal-container"},ch=ut({__name:"remote-login",props:{gatewayDetail:Object},setup(e){const t=e;let c=Ee({}),f=J(null),E=J();J("");let R=J(null),L=J(null),o=J(null),l=J(""),h=J(""),S=J(),a=J(!1),p=J(),w=J(0),b=J();const m=new oh.FitAddon,i=J(null);Mt(async()=>{t.gatewayDetail&&(c=t.gatewayDetail,f.value=c.id,R.value=c.sn,L.value=c.sn,o.value=c.secret),document.getElementById("terminal"),E.value=new nh.Terminal({cols:80,cursorBlink:!0,cursorStyle:"block",scrollback:800,tabStopWidth:4,screenKeys:!0}),E.value.loadAddon(m),m.fit(),E.value.open(i.value),E.value.onData(x=>{y(h.value,x)}),n(),window.onbeforeunload=x=>{_()};const d=window.innerWidth-320,g=window.innerHeight-200;w.value=parseInt(d/9,10),E.value.resize(w.value,parseInt(g/17,10)),E.value.scrollToBottom(),m.fit(),window.addEventListener("resize",()=>{const x=window.innerWidth-320,B=window.innerHeight-370;w.value=parseInt(x/9,10),E.value.resize(w,parseInt(B/17,10)),m.fit(),E.value.scrollToBottom()})});const s=()=>{m.fit()},r=Zr.debounce(()=>s(),800),n=()=>{window.addEventListener("resize",r)};As(()=>{_()});const u=async()=>{if(S.value!=null)return;const d=await gt({gatewayId:c.id});console.log(d.data);let g=d.data.mqttClientId,x=d.data.mqttPassword;S.value=new Ue.Client(d.data.mqttUrl,Number(d.data.mqttPort),g),l.value="/edge/telnet/"+R.value+"/"+L.value+"/reply",h.value="/edge/telnet/"+R.value+"/"+L.value,E.value.writeln("\u8FDE\u63A5\u4E2D...."),p.value=new Ue.Message("telnetClose"),p.value.destinationName=h.value,p.value.qos=0,S.value.onConnectionLost=v,S.value.onMessageArrived=C;let B={timeout:30,userName:d.data.mqttUserName,password:x,keepAliveInterval:60,cleanSession:!0,reconnect:!1,onSuccess:M,onFailure:I};S.value.connect(B),b.value=setTimeout(()=>{a||(E.value.writeln("\u8FDE\u63A5\u8D85\u65F6\uFF0C\u8BF7\u786E\u8BA4\u8FDC\u7A0B\u7F51\u5173\u662F\u5426\u8FD0\u884C."),_())},10*1e3)},v=d=>{clearTimeout(b.value),console.log("MQTT WS \u8FDE\u63A5\u4E22\u5931",d.errorMessage),N("MQTT WS \u8FDE\u63A5\u5173\u95ED:"+d.errorMessage)},C=d=>{let g=JSON.parse(d.payloadString);g.status?(a.value=!0,E.value.write(g.message)):(a.value=!1,E.value.writeln(g.message),_())},M=()=>{console.log("MQTT WS\u94FE\u63A5\u6210\u529F"),S.value.subscribe(l.value,{qos:0,onSuccess:()=>{console.log("success..."),y(h.value,"telnetConnect")},onFailure:d=>{E.value.writeln("\u8BA2\u9605\u5931\u8D25")}})},_=()=>{S.value!=null&&(y(p.value.destinationName,p.value.payloadString),S.value.disconnect(),S.value=null),a.value=!1},y=(d,g)=>{let x=new Ue.Message(g);x.destinationName=d,S.value.send(x)},I=()=>{window.$message.error($t("energy.connection_fail"))},N=d=>{E.value.writeln(""),E.value.writeln(d)};return(d,g)=>{const x=de("n-button");return Se(),Fe("div",ah,[O(S)==null?(Se(),qe(x,{key:0,class:"btn",type:"primary",onClick:u,secondary:""},{default:z(()=>[le(se(d.$t("login.form_button")),1)]),_:1})):(Se(),qe(x,{key:1,class:"btn",type:"error",onClick:_,secondary:""},{default:z(()=>[le(se(d.$t("energy.logout")),1)]),_:1})),ce("div",lh,[ce("xterm",{ref_key:"terminal",ref:i},null,512)])])}}}),hh=At(ch,[["__scopeId","data-v-71c6513f"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/energy/gateway/remote-login.vue"]]),dh={key:0,style:{display:"flex","justify-content":"flex-end",position:"absolute",right:"3%","z-index":"9","margin-top":"6px"}},uh={style:{"font-weight":"700","font-size":"16px"}},_h={key:0},fh={key:1},vh=["innerHTML"],gh={style:{"font-weight":"700","font-size":"16px"}},ph={style:{"font-weight":"700","font-size":"16px"}},mh={style:{height:"calc(100vh - 140px)"}},yh={style:{height:"calc(100vh - 140px)"}},Sh={style:{height:"calc(100vh - 140px)"}},wh={style:{height:"calc(100vh - 140px)"}},bh={style:{"margin-right":"10px"}},Ch=ut({__name:"gatewaydetail",props:{projectParams:Object},setup(e){const t=Ni(),{CloseIcon:c}=Qt.ionicons5,f=Tt(),E=Ui(),R=e,L=J(!1),o=J(!1),l=J(null),h=J(null),S=J(null),a=J(),p=J();let w=J({}),b=Ee({}),m=Ee({}),i=J(),s=J(),r=J(),n=J(""),u=J([]),v=Ee({page:1,size:10});J(!1),J();const C=J(!1),M=J(!1);let _=J(!1),y=J(!1),I=J(!1),N=Ee({ntpCheck:!1,ntpServer:"",cycle:"60"}),d=Ee({startTime:"",systemTime:"",storageSize:"",freeStorage:"",storageUsage:"",memorySize:"",FreeMemory:"",memoryUsage:"",cpuUsage:"",allNet:"",IOPoints:"",longitude:"",latitude:"",imei:"",imsi:"",cops:"",lac_ci:"",csq:""});J([{label:"\u7F51\u5173\u6821\u65F6",key:"verify"}]);const g=[{title:$t("energy.device"),key:"dn"},{title:$t("project.property"),key:"tag"},{title:$t("energy.value"),key:"val"},{title:$t("energy.status"),key:"status"},{title:$t("energy.time"),key:"createTime"},{title:$t("energy.source"),key:"source"}];let x=J([]);const B=J({page:1,size:10,projectId:null,sn:null});let W=J({});const H=X=>{E.success({title:$t("project.confirm"),content:$t("energy.Whether_to_restart_gateway"),positiveText:$t("project.sure"),showIcon:!1,positiveButtonProps:{secondary:!0},negativeText:$t("project.cancel"),onPositiveClick:()=>{k(m)}})},k=async X=>{const Z=await ji({gatewayId:X.id,type:"restart"});var ve=new WebSocket(Z.data);ve.onmessage=ge=>{let Pe=JSON.parse(ge.data).restartStatus,ee=JSON.parse(ge.data).message;JSON.parse(ge.data).type!="tips"?(ee=ee.replace("\\n",`
`),f.error(ee)):f.success(ee),Pe||ve.close()},(await Ps({gatewayId:X.id,projectId:B.value.projectId})).code==200||ve.close()},T=()=>{C.value=!1},A=()=>{_.value=!1},P=X=>{I.value=X},q=X=>{switch(X){case"timing":return _.value=!0,G("verify"),!1;default:return!0}},U=async(X,Z)=>{if((await $i({gatewayId:l.value})).data.status==!1){f.error($t("energy.gateway_not_online"));return}else n.value=X,X=="detail"&&JSON.stringify(Z)!="{}",X=="write"&&De(),X=="warn"&&j()},j=()=>{en({...B.value}).then(X=>{X.code==200&&(W.value=X.data,x.value=X.data.tableLabel.map(Z=>Z.key=="[clientId, deviceName, property]"?{title:Z.title,key:"[clientId, deviceName, property]",render:ve=>ve.clientId+" - "+ve.deviceName+" - "+ve.property}:Z.key=="handler"?{title:Z.title,key:"handler",render:ve=>ve.handler?$t("energy.Processed"):$t("energy.Unprocessed")}:{title:Z.title,key:Z.key}))})},G=async X=>{if((await $i({gatewayId:l.value})).data.status==!1){f.error($t("energy.gateway_not_online"));return}if(X=="verify"){const Z={id:w.value.id,userId:w.value.userId,operate:"getNtp",gwType:w.value.model},ve=await fi(Z);ve.code==200&&(b={param:ve.data,operate:"getNtp"},y.value=!0,D()),_.value=!0}},Q=X=>{X.Data.forEach(Z=>{if(Z.id=="system.START_TIME")d.startTime=Z.val;else if(Z.id=="system.TIME")d.systemTime=Z.val;else if(Z.id=="system.CPU_USAGE")d.cpuUsage=Z.val;else if(Z.id=="system.ALL_NET")d.allNet=Z.val;else if(Z.id=="system.IOPoints")d.IOPoints=Z.val;else if(Z.id=="system.STORAGE"){let ve=JSON.parse(Z.val);d.storageSize=ve[0],d.freeStorage=ve[1],d.storageUsage=ve[2]}else if(Z.id=="system.MEMORY"){let ve=JSON.parse(Z.val);d.memorySize=ve[0],d.FreeMemory=ve[1],d.memoryUsage=ve[2]}else Z.id=="system.IMEI"?d.imei=Z.status=="Good"?Z.val:"":Z.id=="system.IMSI"?d.imsi=Z.status=="Good"?Z.val:"":Z.id=="system.LONGITUDE"?d.longitude=Z.status=="Good"?Z.val:"":Z.id=="system.LATITUDE"?d.latitude=Z.status=="Good"?Z.val:"":Z.id=="system.Lac_ci"?d.lac_ci=Z.status=="Good"?Z.val:"":Z.id=="system.Cops"?d.cops=Z.status=="Good"?Z.val:"":Z.id=="system.CSQ"&&(d.csq=Z.status=="Good"?Z.val:"")})},D=async()=>{const X=await gt({gatewayId:w.value.id});console.log(X,"mqtt\u4E0B\u8F7D");let Z=X.data.mqttClientId,ve=X.data.mqttPassword;i.value=new Ue.Client(X.data.mqttUrl,Number(X.data.mqttPort),Z),i.value.onConnectionLost=ie,i.value.onMessageArrived=ae,s.value={timeout:30,userName:X.data.mqttUserName,password:ve,keepAliveInterval:60,cleanSession:!0,reconnect:!1,onSuccess:Y,onFailure:V},i.value.connect(s.value)},Y=()=>{console.log("\u8FDE\u63A5mqtt websocket\u7AEF\u53E3\u6210\u529F",p.value[0]),i.value.subscribe(p.value[0],{qos:0,onSuccess:()=>{console.log("\u8BA2\u9605\u4E2D..."),K()},onFailure:function(X){console.log("\u8BA2\u9605\u6570\u636E\u5931\u8D25",X),i.value.connect(s.value)}})},V=X=>{f.error($("energy.connection_fail"))},K=()=>{console.log("\u5B9E\u65F6\u6570\u636E....",a.value[0]);let X=new Ue.Message(JSON.stringify(b));X.destinationName=a.value[0],i.value.send(X)},ae=X=>{const Z=JSON.parse(X.payloadString);if(console.log(Z,b,"\u6570\u636E"),Z.message)f.warning(Z.message);else if(b.operate=="getNtp"){y.value=!1;let ve=Z.result[0].split(`
`);N.ntpCheck=JSON.parse(ve[1].split("=")[1]),N.ntpServer=ve[2].split("=")[1],!ve[2].split("=")[1]&&!N.ntpCheck&&(N.ntpServer="things.iotddc.com"),N.cycle=ve[3].split("=")[1],f.success($t("project.operationSuccess"))}else _.value=!1;i.value.end()},ie=()=>{console.log("\u94FE\u63A5\u505C\u6B62/\u4E22\u5931")},me=X=>{let Z={};if(X=="windows")Z={operate:"setTime",id:t.projectDetail.id,userid:w.value.userId};else{var ve={operate:"ntp",id:t.projectDetail.id,userid:w.value.userId};Z={...ve,...N}}un({...Z,gwType:w.value.model}).then(ge=>{b={param:ge.data},D()})},De=()=>{console.log("\u64CD\u4F5C\u65E5\u5FD7"),gn({gatewayId:l.value,...v}).then(X=>{X.code==200&&(u.value=X.data)})},Te=X=>{v.size=X,De()},rt=X=>{v.page=X,De()},_e=X=>{B.value.size=X,j()},dt=X=>{B.value.page=X,j()};return Mt(async()=>{if(Is.currentRoute.value.query.data){let X=decodeURIComponent(Is.currentRoute.value.query.data),Z=JSON.parse(X);L.value=Z.hidden,o.value=Z.hiddenHistory,w.value=Z,l.value=w.value.id,t.setToken(w.value.token),M.value=!0}else R.projectParams&&(w.value=R.projectParams,l.value=w.value.id,M.value=!1);B.value.projectId=w.value.projectId,await $i({gatewayId:l.value}).then(X=>{if(X.data.fourthGeneration){let Z={Data:JSON.parse(X.data.fourthGeneration)};Q(Z),U("detail",X.data)}h.value=X.id,m=X.data,n.value="detail",r.value=X.data.name,B.value.sn=m.sn,S.value=X.data.sandboxId?X.data.sandboxId:null,a.value=["/edge/complexCommand/"+m.sn+"/"+m.sn],p.value=["/edge/complexCommand/"+m.sn+"/"+m.sn+"/reply"]})}),Gt(()=>{}),(X,Z)=>{const ve=de("n-button"),ge=de("n-descriptions-item"),Pe=de("n-descriptions"),ee=de("n-tab-pane"),re=de("n-data-table"),ue=de("n-pagination"),pe=de("n-spin"),Ve=de("n-tabs"),Dt=de("n-text"),Ge=de("n-icon"),nt=de("n-space"),Me=de("n-checkbox"),ot=de("n-form-item"),hi=de("n-input"),Oe=de("n-form"),Ur=de("n-card"),Cs=de("n-modal");return Se(),Fe("div",{style:Fi({paddingLeft:O(t).getIsShowMenuAndHeader?"":"1%"})},[M.value?(Se(),Fe("div",dh,[F(ve,{secondary:"",type:"primary",onClick:H},{default:z(()=>Z[12]||(Z[12]=[le("\u91CD\u542F")])),_:1}),F(ve,{style:{"margin-left":"10px"},secondary:"",type:"primary",onClick:Z[0]||(Z[0]=()=>{C.value=!0})},{default:z(()=>Z[13]||(Z[13]=[le("\u56FA\u4EF6\u5347\u7EA7")])),_:1})])):Ae("v-if",!0),F(Ve,{"onUpdate:value":U,onBeforeLeave:q},{default:z(()=>[F(ee,{name:"detail",tab:X.$t("energy.gateway")+X.$t("energy.detail")},{default:z(()=>[ce("span",uh,se(X.$t("energy.gateway"))+se(X.$t("energy.data")),1),F(Pe,{"label-placement":"left",column:3,bordered:"",style:{"margin-top":"20px","margin-bottom":"10px"}},{default:z(()=>[F(ge,{label:X.$t("energy.gateway")+X.$t("energy.name")},{default:z(()=>[le(se(O(r)),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.gateway")+X.$t("project.type")},{default:z(()=>[le(se(O(m).model),1)]),_:1},8,["label"]),F(ge,{label:X.$t("project.status")},{default:z(()=>[O(m).status?(Se(),Fe("span",_h,[Z[14]||(Z[14]=ce("span",{class:"green-dot"},null,-1)),le(se(X.$t("energy.online")),1)])):(Se(),Fe("span",fh,[Z[15]||(Z[15]=ce("span",{class:"red-dot"},null,-1)),le(se(X.$t("energy.offline")),1)]))]),_:1},8,["label"]),F(ge,{label:X.$t("energy.gateway")+"SN"},{default:z(()=>[le(se(O(m).sn),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.ip_address")},{default:z(()=>[ce("div",{innerHTML:O(m).ip},null,8,vh)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.Last_connection_time")},{default:z(()=>[le(se(O(m).lastTime),1)]),_:1},8,["label"])]),_:1}),ce("span",gh,se(X.$t("energy.System_point_data")),1),F(Pe,{"label-placement":"left",column:3,bordered:"",style:{"margin-top":"20px","margin-bottom":"10px"}},{default:z(()=>[F(ge,{label:X.$t("energy.starting_time")},{default:z(()=>[le(se(O(d).startTime),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.system_time")},{default:z(()=>[le(se(O(d).systemTime),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.CPU_utilization")+"(%)"},{default:z(()=>[le(se(O(d).cpuUsage),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.Storage_size")+"(M)"},{default:z(()=>[le(se(O(d).storageSize),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.free_size")+"(M)"},{default:z(()=>[le(se(O(d).freeStorage),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.usage_rate")+"(%)"},{default:z(()=>[le(se(O(d).storageUsage),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.memory_size")+"(M)"},{default:z(()=>[le(se(O(d).memorySize),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.free_size")+"(M)"},{default:z(()=>[le(se(O(d).FreeMemory),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.usage_rate")+"(%)"},{default:z(()=>[le(se(O(d).memoryUsage),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.total_points")},{default:z(()=>[le(se(O(d).IOPoints),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.interface_list")},{default:z(()=>[le(se(O(d).allNet),1)]),_:1},8,["label"])]),_:1}),ce("span",ph,se("4G "+X.$t("energy.data")),1),F(Pe,{"label-placement":"left",column:3,bordered:"",style:{"margin-top":"20px","margin-bottom":"10px"}},{default:z(()=>[F(ge,{label:X.$t("energy.service_provider")},{default:z(()=>[le(se(O(d).cops),1)]),_:1},8,["label"]),F(ge,{label:"IMSI(SIM"+X.$t("energy.card_identification")+")"},{default:z(()=>[le(se(O(d).imsi),1)]),_:1},8,["label"]),F(ge,{label:"IMEI("+X.$t("energy.radio_module_identification")+")"},{default:z(()=>[le(se(O(d).imsi),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.longitude")},{default:z(()=>[le(se(O(d).longitude),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.latitude")},{default:z(()=>[le(se(O(d).latitude),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.location_area_number_Cell")+"ID"},{default:z(()=>[le(se(O(d).lac_ci),1)]),_:1},8,["label"]),F(ge,{label:X.$t("energy.signal_quality")},{default:z(()=>[le(se(O(d).csq),1)]),_:1},8,["label"])]),_:1})]),_:1},8,["tab"]),F(ee,{name:"realData",tab:X.$t("energy.real_time_data")},{default:z(()=>[ce("div",mh,[O(n)=="realData"?(Se(),qe(Cn,{key:0,gatewayDetail:O(m)},null,8,["gatewayDetail"])):Ae("v-if",!0)])]),_:1},8,["tab"]),o.value!=!0?(Se(),qe(ee,{key:0,name:"historyData",tab:X.$t("energy.historical_data")},{default:z(()=>[ce("div",yh,[F(Kc,{gatewayDetail:O(m)},null,8,["gatewayDetail"])])]),_:1},8,["tab"])):Ae("v-if",!0),F(ee,{name:"log",tab:X.$t("energy.log")},{default:z(()=>[ce("div",Sh,[O(n)=="log"?(Se(),qe(rh,{key:0,gatewayDetail:O(m)},null,8,["gatewayDetail"])):Ae("v-if",!0)])]),_:1},8,["tab"]),F(ee,{name:"login",tab:X.$t("energy.telnet")},{default:z(()=>[ce("div",{style:Fi({height:O(t).getIsShowMenuAndHeader?"calc(100vh - 140px)":""})},[O(n)=="login"?(Se(),qe(hh,{key:0,gatewayDetail:O(m)},null,8,["gatewayDetail"])):Ae("v-if",!0)],4)]),_:1},8,["tab"]),L.value!=!0?(Se(),qe(ee,{key:1,name:"write",tab:X.$t("energy.Write_operation_log")},{default:z(()=>[F(re,{columns:g,data:O(u).list},null,8,["data"]),F(ue,{class:"pagination-top",page:O(u).pageNumber,"onUpdate:page":Z[1]||(Z[1]=Be=>O(u).pageNumber=Be),"page-size":O(u).pageSize,"onUpdate:pageSize":Z[2]||(Z[2]=Be=>O(u).pageSize=Be),"item-count":O(u).totalRow,"page-sizes":[10,20,50,100],"show-size-picker":"","on-update:page":rt,"on-update:page-size":Te},null,8,["page","page-size","item-count"])]),_:1},8,["tab"])):Ae("v-if",!0),L.value!=!0?(Se(),qe(ee,{key:2,name:"warn",tab:X.$t("energy.warn")},{default:z(()=>[F(re,{columns:O(x),data:O(W).tableData},null,8,["columns","data"]),F(ue,{class:"pagination-top",page:B.value.page,"onUpdate:page":Z[3]||(Z[3]=Be=>B.value.page=Be),"page-size":B.value.size,"onUpdate:pageSize":Z[4]||(Z[4]=Be=>B.value.size=Be),"item-count":B.value.totalElements,"page-sizes":[10,20,50,100],"show-size-picker":"","on-update:page":dt,"on-update:page-size":_e},null,8,["page","page-size","item-count"])]),_:1},8,["tab"])):Ae("v-if",!0),F(ee,{name:"ipconfig",tab:X.$t("energy.network_settings")},{default:z(()=>[F(pe,{show:O(I)},{default:z(()=>[ce("div",wh,[O(n)=="ipconfig"?(Se(),qe(Un,{key:0,onChangeLoading:P,gatewayDetail:O(m)},null,8,["gatewayDetail"])):Ae("v-if",!0)])]),_:1},8,["show"])]),_:1},8,["tab"]),F(ee,{name:"timing",tab:X.$t("energy.ntpdate")},null,8,["tab"]),Ae(` <template #suffix>
        <n-dropdown trigger="click" :options="options" @select="handleSelect">
          <n-button>
            \u66F4\u591A\u64CD\u4F5C |
            <n-icon size="30" class="search-icon">
              <ChevronDownOutlineIcon></ChevronDownOutlineIcon>
            </n-icon>
          </n-button>
        </n-dropdown>
      </template> `)]),_:1}),O(n)=="detail"&&JSON.stringify(O(m))!="{}"?(Se(),qe(kn,{key:1,gatewayDetail:O(m),onRealSystemData:Q},null,8,["gatewayDetail"])):Ae("v-if",!0),O(_)?(Se(),qe(Cs,{key:2,show:O(_),"onUpdate:show":Z[10]||(Z[10]=Be=>vt(_)?_.value=Be:_=Be),"mask-closable":!1,closeOnEsc:!1,style:{width:"50%"}},{default:z(()=>[Ae(" <timemodal :projectParams = 'verifyParams' :projectParams1 = 'childList'></timemodal> "),F(Ur,null,{header:z(()=>[F(nt,{style:{display:"flex","justify-content":"space-between"}},{default:z(()=>[F(Dt,null,{default:z(()=>[le(se(X.$t("energy.ntpdate")),1)]),_:1}),F(Ge,{size:"30",class:"search-icon"},{default:z(()=>[F(O(c),{onClick:A})]),_:1})]),_:1})]),default:z(()=>[F(Oe,{model:O(N),inline:"","label-width":80,"label-placement":"right",size:"small",style:{"margin-bottom":"30px"}},{default:z(()=>[F(ot,null,{default:z(()=>[F(Me,{checked:O(N).ntpCheck,"onUpdate:checked":Z[5]||(Z[5]=Be=>O(N).ntpCheck=Be)},{default:z(()=>[le(se(X.$t("energy.Sync_with_the_NTP_server")),1)]),_:1},8,["checked"])]),_:1}),F(ot,null,{default:z(()=>[F(hi,{value:O(N).ntpServer,"onUpdate:value":Z[6]||(Z[6]=Be=>O(N).ntpServer=Be),style:{width:"250px"}},null,8,["value"])]),_:1}),ce("span",bh,se(X.$t("energy.Check_every")),1),F(ot,null,{default:z(()=>[F(hi,{value:O(N).cycle,"onUpdate:value":Z[7]||(Z[7]=Be=>O(N).cycle=Be),style:{width:"50px"}},null,8,["value"])]),_:1}),ce("span",null,se(X.$t("energy.minutes"))+"("+se(X.$t("energy.Effective_after_reboot"))+")",1)]),_:1},8,["model"]),F(nt,{style:{display:"flex","justify-content":"space-between"}},{default:z(()=>[F(ve,{onClick:Z[8]||(Z[8]=Be=>me("windows"))},{default:z(()=>[le(se(X.$t("energy.Sync_with_the_computer_time")),1)]),_:1}),F(ve,{size:"medium",type:"primary",onClick:Z[9]||(Z[9]=Be=>me("custom")),secondary:""},{default:z(()=>[le(se(X.$t("energy.save")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])):Ae("v-if",!0),Ae(" \u56FA\u4EF6\u5347\u7EA7 "),C.value?(Se(),qe(Cs,{key:3,show:C.value,"onUpdate:show":Z[11]||(Z[11]=Be=>C.value=Be),style:{width:"60%"}},{default:z(()=>[F(Ns,{projectParams:O(m),onCloseFirmware:T},null,8,["projectParams"])]),_:1},8,["show"])):Ae("v-if",!0)],4)}}}),Nr=At(Ch,[["__scopeId","data-v-f5fd357e"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/energy/gateway/gatewaydetail.vue"]]),Eh=Object.freeze(Object.defineProperty({__proto__:null,default:Nr},Symbol.toStringTag,{value:"Module"}));export{rn as a,Nr as b,nn as c,on as d,ln as e,Ns as f,ji as g,Eh as h,an as i,cn as p,Ps as r};
