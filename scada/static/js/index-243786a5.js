import{d as L,V as O,ae as R,u as V,r as i,ak as q,b as _,o as F,O as c,ar as G,af as J,as as K,f as d,h as k,i as M,l as n,w as r,n as v,ap as w,an as Q,p as $,t as h,j as b,at as W,au as X,D as Y,_ as Z}from"./index-35337fd3.js";import{A as ee,B as ae}from"./energy-f0146bb7.js";import te from"./addPopup-6f7ae1f2.js";import{i as le}from"./icon-ebc544b2.js";import"./RadioButton-47b7c95b.js";const ne=L({__name:"index",setup(re){const j=O(()=>window.innerHeight-210),{ChevronDownIcon:x}=le.ionicons5,z=R("permission"),g=V(),N=i(),u=i(!1);i([]);const m=i({data:[],totalElements:0}),f=i([]),U=i("add"),C=q(),E=_({}),a=_({page:1,size:10,projectId:g.projectDetail.id,checkType:"",deviceName:"",handler:!1}),P=i([{label:$t("energy.Processed"),value:!0},{label:$t("energy.Unprocessed"),value:!1},{label:$t("energy.All"),value:""}]),A=e=>{a.page=e,o()},D=e=>{a.size=e,o()};F(()=>{o()});const o=()=>{ee({...a}).then(e=>{e.code===200&&(g.setCheckNum(e.data.totalElements),f.value=e.data.tableLabel.map(t=>t.key=="[clientId, deviceName, property]"?{title:t.title,key:"[clientId, deviceName, property]",render:l=>l.clientId+" - "+l.deviceName+" - "+l.property}:t.key=="handler"?{title(){return c(G,{options:P.value,showArrow:!0,onSelect:(l,p)=>{a.handler=p.value,o()}},{default:()=>c("div",[c("span",{},a.handler===!1?$t("energy.Unprocessed"):a.handler===""?$t("energy.All"):$t("energy.Processed")),c(x,{style:{height:"10px",width:"10px"}})])})},key:"handler",render:l=>J(c(K,{value:l.handler,"onUpdate:value":p=>{C.success({title:$t("energy.handle_alarm"),positiveText:$t("project.sure"),showIcon:!1,positiveButtonProps:{secondary:!0},negativeText:$t("energy.close"),onPositiveClick:()=>{ae({id:l.id}).then(y=>{if(y.code==200)return o(),l.handler=p})}})}}),[[z,[$t("energy.warn_list"),"change"]]])}:{title:t.title,key:t.key}),m.value.data=e.data.tableData,m.value.totalElements=e.data.totalElements)})},I=()=>{a.page=1,o()},S=e=>{e&&o(),u.value=!1};return(e,t)=>{const l=d("n-form-item"),p=d("n-form"),y=d("n-pagination"),T=d("n-space"),B=d("n-card"),H=d("n-modal");return k(),M("div",null,[n(B,null,{default:r(()=>[n(p,{ref_key:"formRef",ref:N,inline:"","label-width":110,model:a,"label-placement":"left"},{default:r(()=>[n(l,{label:e.$t("energy.Alert_Name")},{default:r(()=>[n(v(w),{value:a.checkType,"onUpdate:value":t[0]||(t[0]=s=>a.checkType=s),placeholder:e.$t("energy.please_enter")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(l,{label:e.$t("energy.Device_Name")},{default:r(()=>[n(v(w),{value:a.deviceName,"onUpdate:value":t[1]||(t[1]=s=>a.deviceName=s),placeholder:e.$t("energy.please_enter")},null,8,["value","placeholder"])]),_:1},8,["label"]),n(l,null,{default:r(()=>[n(v(Q),{"attr-type":"button",onClick:I},{default:r(()=>[$(h(e.$t("energy.Search")),1)]),_:1})]),_:1}),b(` <n-form-item>
          <div>
            <n-button v-permission="['\u544A\u8B66\u8BB0\u5F55', 'add']" @click="handleAddClick('add')">
              \u6DFB\u52A0\u89C4\u5219
            </n-button>
          </div>
        </n-form-item> `)]),_:1},8,["model"]),n(v(W),{columns:f.value,data:m.value.data,style:X({height:`${j.value}px`}),"flex-height":""},null,8,["columns","data","style"]),n(T,{justify:"end",style:{"margin-top":"15px"}},{default:r(()=>[n(y,{page:a.page,"onUpdate:page":[t[2]||(t[2]=s=>a.page=s),A],"page-size":a.size,"onUpdate:pageSize":[t[3]||(t[3]=s=>a.size=s),D],"page-sizes":[10,20,50,100],"item-count":m.value.totalElements,"show-size-picker":"","page-slot":7},{prefix:r(({itemCount:s})=>[$(h(e.$t("project.total"))+" "+h(s)+" "+h(e.$t("project.items")),1)]),_:1},8,["page","page-size","item-count"])]),_:1})]),_:1}),u.value?(k(),Y(H,{key:0,show:u.value,"onUpdate:show":t[4]||(t[4]=s=>u.value=s),style:{width:"70%"}},{default:r(()=>[n(te,{projectParams:E,isEdit:U.value,onClosePopup:S},null,8,["projectParams","isEdit"])]),_:1},8,["show"])):b("v-if",!0)])}}}),se=Z(ne,[["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/energy/warn/index.vue"]]);export{se as default};
