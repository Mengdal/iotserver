import{d as A,g as V,S as K,b as N,o as B,ao as T,f as o,h as r,i as g,l as t,w as l,p as E,t as k,F as U,a9 as R,D as x,j as S,n as v,_ as F,ae as J,r as f,ak as M,af as Z,O as G,an as q,aq as Q}from"./index-35337fd3.js";import{q as W,s as X,t as Y,u as ee,v as le}from"./energy-f0146bb7.js";const te={key:1},ae=A({__name:"popup",props:{isEdit:String,roleList:Object},emits:["closePopup"],setup(L,{emit:z}){const y=V(K.GO_LANG_STORE)?.lang||"ZH",p=L,a=N({name:"",description:"",permission:[]}),w=z,j=()=>{a.permission=JSON.stringify(a.permission),p.isEdit==="add"?X(a).then(e=>{e.code===200?(window.$message.success($t("energy.add")+$t("energy.successfully")),w("closePopup","creat")):O()}):Y(a).then(e=>{e.code===200&&(window.$message.success($t("energy.edit")+$t("energy.successfully")),w("closePopup","edit"))})},O=()=>{w("closePopup","")};return B(()=>{if(p.isEdit==="edit"||p.isEdit==="look"){const e=T(p.roleList);a.name=e.name,a.description=e.desc,a.id=e.id,a.permission=e.permission,console.log(a)}else W({}).then(e=>{a.permission=e.data.permission})}),(e,c)=>{const I=o("n-text"),P=o("n-space"),h=o("n-input"),$=o("n-form-item"),H=o("n-checkbox"),n=o("n-collapse-item"),s=o("n-collapse"),m=o("n-form"),b=o("n-button"),C=o("n-card");return r(),g("div",null,[t(C,null,{header:l(()=>[t(P,null,{default:l(()=>[t(I,null,{default:l(()=>[E(k(L.isEdit=="add"?e.$t("energy.add"):e.$t("energy.edit"))+k(e.$t("energy.role")),1)]),_:1})]),_:1})]),default:l(()=>[t(m,{model:a,"label-placement":"left","label-width":"120px",style:{height:"80vh","overflow-y":"auto"}},{default:l(()=>[t($,{label:e.$t("energy.role")+e.$t("energy.name")},{default:l(()=>[t(h,{value:a.name,"onUpdate:value":c[0]||(c[0]=i=>a.name=i),placeholder:e.$t("energy.please_enter")},null,8,["value","placeholder"])]),_:1},8,["label"]),t($,{label:e.$t("energy.role")+e.$t("energy.desc")},{default:l(()=>[t(h,{value:a.description,"onUpdate:value":c[1]||(c[1]=i=>a.description=i),placeholder:e.$t("energy.please_enter")},null,8,["value","placeholder"])]),_:1},8,["label"]),t($,{label:e.$t("energy.permission_setting")},{default:l(()=>[t(s,null,{default:l(()=>[(r(!0),g(U,null,R(a.permission,i=>(r(),g(U,{key:i.value},[i.tag?(r(),g("div",te,[t($,{label:v(y)=="ZH"?i.label:i.label_en},{default:l(()=>[(r(!0),g(U,null,R(i.children,d=>(r(),x(H,{key:v(y)=="ZH"?d.label:d.label_en,checked:d[d.key],"onUpdate:checked":u=>d[d.key]=u,label:v(y)=="ZH"?d.label:d.label_en},null,8,["checked","onUpdate:checked","label"]))),128))]),_:2},1032,["label"])])):(r(),x(n,{key:0,title:v(y)=="ZH"?i.label:i.label_en,name:i.value},{default:l(()=>[(r(!0),g(U,null,R(i.children,d=>(r(),g("div",{key:d.value,"item-style":"display: flex;"},[t($,{label:v(y)=="ZH"?d.label:d.label_en},{default:l(()=>[(r(!0),g(U,null,R(d.children,u=>(r(),x(H,{key:v(y)=="ZH"?u.label:u.label_en,checked:u[u.key],"onUpdate:checked":D=>u[u.key]=D,label:v(y)=="ZH"?u.label:u.label_en},null,8,["checked","onUpdate:checked","label"]))),128))]),_:2},1032,["label"])]))),128))]),_:2},1032,["title","name"]))],64))),128))]),_:1})]),_:1},8,["label"])]),_:1},8,["model"]),t(P,{justify:"flex-end"},{default:l(()=>[t(P,null,{default:l(()=>[t(b,{size:"medium",onClick:O},{default:l(()=>[E(k(e.$t("project.cancel")),1)]),_:1}),L.isEdit!="look"?(r(),x(b,{key:0,size:"medium",type:"primary",onClick:j,secondary:""},{default:l(()=>[E(k(e.$t("energy.save")),1)]),_:1})):S("v-if",!0)]),_:1})]),_:1})]),_:1})])}}}),ne=F(ae,[["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/energy/role/popup.vue"]]),oe=A({__name:"index",setup(L){const z=J("permission"),y=f(),p=f(!1);f([]),f(!1);const a=f({data:[],totalRow:0});f(!1);const w=f([]),j=f("add"),O=M();f(),f({accountId:"",projectId:""});const e=N({}),c=N({page:1,size:10}),I=n=>{c.page=n,h()},P=n=>{c.size=n,h()};B(()=>{h()});const h=()=>{ee({...c}).then(n=>{w.value=n.data.tableLabel.map(s=>s.key=="button"?{title:s.title,key:"button",render(m){const b=[];return m.userId!=0?b.push(Z(G(q,{quaternary:!0,type:"success",size:"small",style:{marginLeft:"10px"},onClick:()=>{console.log(T(m)),p.value=!0,Object.assign(e,{...m}),j.value="edit"}},{default:()=>$t("energy.edit")}),[[z,[$t("energy.role_list"),"change"]]])):b.push(Z(G(q,{quaternary:!0,type:"info",size:"small",style:{marginLeft:"10px"},onClick:()=>{console.log(T(m)),p.value=!0,Object.assign(e,{...m}),j.value="look"}},{default:()=>$t("energy.look")}),[[z,[$t("energy.role_list"),"look"]]])),m.id>3&&b.push(Z(G(q,{quaternary:!0,type:"error",size:"small",style:{marginLeft:"10px"},onClick:()=>{O.error({title:$t("project.confirm"),showIcon:!1,content:()=>$t("project.deleteConfirmation")+"\uFF1F",positiveText:$t("project.sure"),positiveButtonProps:{secondary:!0},negativeText:$t("project.cancel"),onPositiveClick:()=>{le({id:m.id}).then(C=>{C.code==200&&(window.$message.success($t("project.deleteSuccess")),h())})}})}},{default:()=>$t("energy.del")}),[[z,[$t("energy.role_list"),"del"]]])),b}}:{title:s.title,key:s.key}),a.value.data=n.data.tableData,a.value.totalRow=n.data.totalRow})},$=n=>{j.value=n,p.value=!0},H=n=>{n&&h(),p.value=!1};return(n,s)=>{const m=o("n-form-item"),b=o("n-form"),C=o("n-data-table"),i=o("n-space"),d=o("n-card"),u=o("n-modal"),D=J("permission");return r(),g("div",null,[t(d,null,{default:l(()=>[t(b,{ref_key:"formRef",ref:y,inline:"","label-width":80,model:c,"label-placement":"left"},{default:l(()=>[S(` <n-form-item label="\u89D2\u8272\u540D\u79F0">
          <n-input v-model:value="params.name" placeholder="\u8BF7\u8F93\u5165" />
        </n-form-item> `),S(` <n-form-item>
          <n-button attr-type="button" @click="handleValidateClick">
            \u67E5\u8BE2
          </n-button>
        </n-form-item> `),t(m,null,{default:l(()=>[Z((r(),x(v(q),{"attr-type":"button",onClick:s[0]||(s[0]=_=>$("add"))},{default:l(()=>[E(k(n.$t("energy.add")),1)]),_:1})),[[D,[n.$t("energy.role_list"),"add"]]])]),_:1})]),_:1},8,["model"]),t(C,{remote:"","item-count":100,columns:w.value,data:a.value.data,bordered:!1},null,8,["columns","data"]),t(i,{justify:"end",style:{"margin-top":"15px"}},{default:l(()=>[t(v(Q),{page:c.page,"onUpdate:page":[s[1]||(s[1]=_=>c.page=_),I],"page-size":c.size,"onUpdate:pageSize":[s[2]||(s[2]=_=>c.size=_),P],"page-sizes":[10,20,50,100],"item-count":a.value.totalRow,"show-size-picker":"","page-slot":7},{prefix:l(({itemCount:_})=>[E(k(n.$t("project.total"))+" "+k(_)+" "+k(n.$t("project.items")),1)]),_:1},8,["page","page-size","item-count"])]),_:1})]),_:1}),p.value?(r(),x(u,{key:0,show:p.value,"onUpdate:show":s[3]||(s[3]=_=>p.value=_),closeOnEsc:!1,style:{width:"40%",height:"90vh"}},{default:l(()=>[t(ne,{roleList:e,isEdit:j.value,onClosePopup:H},null,8,["roleList","isEdit"])]),_:1},8,["show"])):S("v-if",!0),S(` <n-modal v-model:show="bindProjectPopup" v-if="bindProjectPopup" :closeOnEsc="false">
      <n-card :bordered="false" role="dialog" size="small" aria-modal="true" style="width: 500px; height:200px;">
        <template #header>
          <n-space>
            <n-text>\u7ED1\u5B9A\u9879\u76EE</n-text>
          </n-space>
        </template>
        <n-form ref="formRef" inline label-placement="left">
          <n-form-item label="\u9879\u76EE\u540D\u79F0">
            <n-select style="width: 200px;" v-model:value="bindProjectParams.projectId" placeholder="\u8BF7\u9009\u62E9\u5B9E\u4F8B"
              :options="projectData" label-field="name" value-field="id" />
          </n-form-item>
        </n-form>
        <template #action>
          <n-space justify="
                flex-end">
            <n-space>
              <n-button size="medium" @click="() => { bindProjectPopup = false }">\u53D6\u6D88</n-button>
              <n-button size="medium" type="primary" @click="bindProject">\u4FDD\u5B58</n-button>
            </n-space>
          </n-space>
        </template>
      </n-card>
    </n-modal> `)])}}}),se=F(oe,[["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/energy/role/index.vue"]]);export{se as default};
