import{d as N,u as A,r as i,o as G,h as c,i as M,l,w as o,n as t,av as z,aw as W,p as d,t as h,ax as O,ay as g,ap as v,aA as B,D as _,j as y,an as b,aB as H,_ as Z,V as K,ae as L,ak as V,af as U,O as T,b as J,f as C,au as Q}from"./index-35337fd3.js";import{K as X,L as Y,M as ee,D as ae}from"./energy-f0146bb7.js";import{N as E}from"./RadioButton-47b7c95b.js";const te=N({__name:"groupPopup",props:{isEdit:String,taskParams:Object},emits:["closePopup"],setup(P,{emit:S}){const $=A(),p=P,u=i(null),e=i({name:"",type:"email",desc:"",email:"",phone:"",wechat:"",webhook:""}),k={name:[{required:!0,message:$t("energy.please_enter"),trigger:"blur"}],type:[{required:!0,message:$t("energy.please_select"),trigger:["change","blur"]}],email:[{pattern:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,},*$|^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u548C\u82F1\u6587\u9017\u53F7",trigger:"blur"}],phone:[{pattern:/^[0-9,]*$/,message:$t("energy.Separated_by_English_commas"),trigger:"blur"}],wechat:[{pattern:/https:\/\//,message:$t("energy.Please_enter_the_correct_URL"),trigger:"blur"},{pattern:/^[^\uFF0C]*$/,message:$t("energy.Separated_by_English_commas"),trigger:"blur"}],webhook:[{pattern:/https:\/\//,message:$t("energy.Please_enter_the_correct_URL"),trigger:"blur"},{pattern:/^[^\uFF0C]*$/,message:$t("energy.Separated_by_English_commas"),trigger:"blur"}]};i([]),i([]),i([]);const f=S,w=a=>{e.value.type=a,e.value.phone="",e.value.webhook="",e.value.wechat="",e.value.email=""},j=a=>{console.log(e.value);let n={name:e.value.name,desc:e.value.desc,is_email:e.value.type==="email",is_phone:e.value.type==="phone",is_wechat:e.value.type==="wechat",is_webhook:e.value.type==="webhook",email:e.value.email,phone:e.value.phone,wechat:e.value.wechat,webhook:e.value.webhook};a.preventDefault(),u.value?.validate(s=>{s?console.log("Invalid"):p.isEdit==="add"?X({...n,projectId:$.projectDetail.id}).then(r=>{r.code===200&&(window.$message.success($t("energy.add")+$t("energy.successfully")),f("closePopup","creat"))}):Y({...n,id:p.taskParams.id}).then(r=>{r.code===200&&(window.$message.success($t("energy.edit")+$t("energy.successfully")),f("closePopup","edit"))})})},x=()=>{f("closePopup","")};return G(()=>{if(console.log(p.taskParams,p.isEdit),p.isEdit==="edit"){let a=p.taskParams;e.value.name=a.name,e.value.desc=a.desc,a.isEmail&&(e.value.type="email",e.value.email=a.email),a.isPhone&&(e.value.type="phone",e.value.phone=a.phone),a.isWechat&&(e.value.type="wechat",e.value.wechat=a.wechat),a.isWebhook&&(e.value.type="webhook",e.value.webhook=a.webhook),console.log(e.value)}}),(a,n)=>(c(),M("div",null,[l(t(H),null,{header:o(()=>[l(t(z),null,{default:o(()=>[l(t(W),null,{default:o(()=>[d(h(P.isEdit=="add"?a.$t("energy.add"):a.$t("energy.edit"))+h(a.$t("energy.Notification_Group")),1)]),_:1})]),_:1})]),default:o(()=>[l(t(O),{model:e.value,"label-placement":"left","label-width":"150",rules:k,ref_key:"formRef",ref:u},{default:o(()=>[l(t(g),{label:a.$t("energy.Notification_Group_Name"),path:"name"},{default:o(()=>[l(t(v),{value:e.value.name,"onUpdate:value":n[0]||(n[0]=s=>e.value.name=s),placeholder:a.$t("energy.please_enter")},null,8,["value","placeholder"])]),_:1},8,["label"]),l(t(g),{label:a.$t("energy.Notification_Group_Description")},{default:o(()=>[l(t(v),{value:e.value.desc,"onUpdate:value":n[1]||(n[1]=s=>e.value.desc=s),placeholder:a.$t("energy.please_enter")},null,8,["value","placeholder"])]),_:1},8,["label"]),l(t(g),{label:a.$t("energy.Notification_Type"),path:"type"},{default:o(()=>[l(t(B),{name:"radiogroup2",value:e.value.type,"onUpdate:value":n[2]||(n[2]=s=>e.value.type=s),"on-update:value":w},{default:o(()=>[l(t(E),{value:"email"},{default:o(()=>[d(h(a.$t("energy.Email_notification")),1)]),_:1}),l(t(E),{value:"phone"},{default:o(()=>[d(h(a.$t("energy.SMS_notification")),1)]),_:1}),l(t(E),{value:"wechat"},{default:o(()=>[d(h(a.$t("energy.Enterprise_wechat_notification")),1)]),_:1}),l(t(E),{value:"webhook"},{default:o(()=>n[7]||(n[7]=[d(" webhook ")])),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),e.value.type=="email"?(c(),_(t(g),{key:0,label:a.$t("energy.Mailbox_Setup"),path:"email"},{default:o(()=>[l(t(v),{type:"textarea",value:e.value.email,"onUpdate:value":n[3]||(n[3]=s=>e.value.email=s),placeholder:a.$t("energy.Multiple_mailboxes_can_be_separated_by_English_commas")},null,8,["value","placeholder"])]),_:1},8,["label"])):y("v-if",!0),e.value.type=="phone"?(c(),_(t(g),{key:1,label:a.$t("energy.Set_phone_number"),path:"phone"},{default:o(()=>[l(t(v),{type:"textarea",value:e.value.phone,"onUpdate:value":n[4]||(n[4]=s=>e.value.phone=s),placeholder:a.$t("energy.Multiple_phone_numbers_can_be_separated_by_English_commas")},null,8,["value","placeholder"])]),_:1},8,["label"])):y("v-if",!0),e.value.type=="wechat"?(c(),_(t(g),{key:2,label:a.$t("energy.Set_enterprise_wechat"),path:"wechat"},{default:o(()=>[l(t(v),{type:"textarea",value:e.value.wechat,"onUpdate:value":n[5]||(n[5]=s=>e.value.wechat=s),placeholder:"https://"},null,8,["value"])]),_:1},8,["label"])):y("v-if",!0),e.value.type=="webhook"?(c(),_(t(g),{key:3,label:"Webhook URL",path:"webhook"},{default:o(()=>[l(t(v),{type:"textarea",value:e.value.webhook,"onUpdate:value":n[6]||(n[6]=s=>e.value.webhook=s),placeholder:"https://"},null,8,["value"])]),_:1})):y("v-if",!0),l(t(z),{justify:"flex-end"},{default:o(()=>[l(t(z),null,{default:o(()=>[l(t(b),{size:"medium",onClick:x},{default:o(()=>[d(h(a.$t("project.cancel")),1)]),_:1}),l(t(b),{size:"medium",type:"primary",onClick:j,secondary:""},{default:o(()=>[d(h(a.$t("project.sure")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]))}}),le=Z(te,[["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/energy/warn/groupPopup.vue"]]),oe=N({__name:"warnGroup",setup(P){const S=K(()=>window.innerHeight-210),$=L("permission"),p=A(),u=i(!1),e=V();let k=i([]);const f=i([{title:$t("energy.Notification_Group_Name"),key:"name"},{title:$t("energy.Notification_Group_Description"),key:"desc"},{title:$t("energy.Notification_Type"),key:"isEmail",render(r){return r.isEmail?$t("energy.Email_notification"):r.isPhone?$t("energy.SMS_notification"):r.isWechat?$t("energy.Enterprise_wechat_notification"):"webhook"}},{title:$t("energy.Operations"),key:"actions",render(r){return[U(T(b,{quaternary:!0,type:"success",size:"small",onClick:m=>{u.value=!0,w.value="edit",j.value=r}},{default:()=>$t("energy.edit")}),[[$,[$t("energy.warn_group"),"change"]]]),U(T(b,{type:"error",quaternary:!0,size:"small",style:{marginLeft:"10px"},onClick:()=>{e.error({title:$t("project.confirm"),content:()=>$t("project.deleteConfirmation"),showIcon:!1,positiveText:$t("project.sure"),positiveButtonProps:{secondary:!0},negativeText:$t("project.cancel"),onPositiveClick:()=>{ee({id:r.id}).then(m=>{m.code==200&&(window.$message.success($t("project.deleteSuccess")),a())})}})}},{default:()=>$t("project.delete")}),[[$,[$t("energy.warn_group"),"del"]]])]}}]),w=i("add");let j=i({});const x=J({page:1,size:10,projectId:p.projectDetail.id,checkType:"",deviceName:"",handler:""});G(()=>{a()});const a=()=>{ae({...x}).then(r=>{r.code==200&&(k.value=r.data)})},n=r=>{w.value=r,u.value=!0},s=r=>{r&&a(),u.value=!1};return(r,m)=>{const q=C("n-data-table"),F=C("n-card"),I=C("n-modal"),R=L("permission");return c(),M("div",null,[l(F,null,{default:o(()=>[U((c(),_(t(b),{style:{"margin-bottom":"10px"},onClick:m[0]||(m[0]=D=>n("add"))},{default:o(()=>[d(h(r.$t("energy.add")),1)]),_:1})),[[R,[r.$t("energy.warn_group"),"add"]]]),l(q,{columns:f.value,data:t(k),style:Q({height:`${S.value}px`}),"flex-height":""},null,8,["columns","data","style"]),y(` <n-space justify="end" style="margin-top:15px">
                <n-pagination v-model:page="params.page" v-model:page-size="params.size" :page-sizes="[10, 20, 50, 100]"
                    :item-count="tableData.totalElements" show-size-picker :page-slot="7" @update:page="changePage"
                    @update:page-size="changeSize">
                    <template #prefix="{ itemCount }">\u5171 {{ itemCount }} \u9879 </template>
                </n-pagination>
            </n-space> `)]),_:1}),u.value?(c(),_(I,{key:0,show:u.value,"onUpdate:show":m[1]||(m[1]=D=>u.value=D),style:{width:"50%"}},{default:o(()=>[l(le,{taskParams:t(j),isEdit:w.value,onClosePopup:s},null,8,["taskParams","isEdit"])]),_:1},8,["show"])):y("v-if",!0)])}}}),ne=Z(oe,[["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/energy/warn/warnGroup.vue"]]);export{ne as default};
