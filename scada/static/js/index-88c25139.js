import{d as P,T as Q,r as b,V as G,cc as Ce,eX as N,X as W,f as n,h as v,i as R,n as l,D as U,w as a,l as e,p as o,k as r,j as Y,F as X,cp as xe,ao as Z,_ as J,aH as ke,eq as De,ep as Se,bU as i,cn as Ie,co as ee,d4 as Ue,af as ae,a9 as te,t as j,aC as le,aD as Te,__tla as qe}from"./index-35337fd3.js";import{i as B}from"./icon-ebc544b2.js";import{T as K,D as M}from"./index.d-c5c0bb56.js";import{m as ne,F as se,__tla as Fe}from"./chartEditStore-a8bbc3da.js";import{M as Re,__tla as Ee}from"./EditorWorker-f1a821bc.js";import"./editorWorker-259d4dbf.js";import{g as ze}from"./plugin-11a308bb.js";import{r as $e,d as Ae}from"./file-a76b285e.js";let oe,Le=Promise.all([(()=>{try{return qe}catch{}})(),(()=>{try{return Fe}catch{}})(),(()=>{try{return Ee}catch{}})()]).then(async()=>{const re={class:"go-ml-4"},ue={class:"editor-data-show"},de={class:"editor-data-show"},ie={class:"editor-data-show"},ce={class:"go-flex-items-center"},fe=P({__name:"index",setup(I){const{DocumentTextIcon:m}=B.ionicons5,{FilterIcon:C,FilterEditIcon:h}=B.carbon,{targetData:c,chartEditStore:E}=ne();Q(c.value.request),Q(E.getRequestGlobalConfig);const f=b(!1),x=b(c.value.filter||"return data"),w=b(!1),k=b(""),T=async()=>{try{const d=await xe(Z(c.value.request),Z(E.getRequestGlobalConfig));if(d){k.value=d;return}window.$message.warning("\u6CA1\u6709\u62FF\u5230\u8FD4\u56DE\u503C\uFF0C\u8BF7\u68C0\u67E5\u63A5\u53E3\uFF01")}catch(d){console.error(d),window.$message.warning("\u6570\u636E\u5F02\u5E38\uFF0C\u8BF7\u68C0\u67E5\u53C2\u6570\uFF01")}},O=G(()=>{try{const d=new Function("data","res",x.value),t=Ce(k.value),s=d(t?.data,t);return w.value=!1,N(s)}catch(d){return w.value=!0,`\u8FC7\u6EE4\u51FD\u6570\u9519\u8BEF\uFF0C\u65E5\u5FD7\uFF1A${d}`}}),z=()=>{f.value=!0},H=()=>{ze({message:"\u662F\u5426\u5220\u9664\u8FC7\u6EE4\u5668",onPositiveCallback:()=>{c.value.filter=void 0}})},$=()=>{f.value=!1},A=()=>{if(w.value){window.$message.error("\u8FC7\u6EE4\u51FD\u6570\u9519\u8BEF\uFF0C\u65E0\u6CD5\u8FDB\u884C\u4FDD\u5B58");return}c.value.filter=x.value,$()};return W(()=>f.value,d=>{d&&(T(),x.value=c.value.filter||"return data")}),(d,t)=>{const s=n("n-code"),p=n("n-icon"),_=n("n-button"),u=n("n-space"),y=n("n-card"),D=n("n-text"),S=n("n-tag"),q=n("n-divider"),L=n("n-scrollbar"),V=n("n-modal");return v(),R(X,null,[l(c).filter?(v(),U(y,{key:0},{footer:a(()=>[e(u,{justify:"end"},{default:a(()=>[e(_,{type:"primary",tertiary:"",size:"small",onClick:z},{icon:a(()=>[e(p,null,{default:a(()=>[e(l(h))]),_:1})]),default:a(()=>[t[2]||(t[2]=o(" \u7F16\u8F91 "))]),_:1}),e(_,{tertiary:"",size:"small",onClick:H},{default:a(()=>t[3]||(t[3]=[o(" \u5220\u9664 ")])),_:1})]),_:1})]),default:a(()=>[t[4]||(t[4]=r("p",null,[r("span",{class:"func-keyword"},"function"),o("\xA0\xA0filter(data, res)\xA0\xA0{")],-1)),r("div",re,[e(s,{code:l(c).filter,language:"typescript"},null,8,["code"])]),t[5]||(t[5]=r("p",null,"}",-1))]),_:1})):(v(),U(_,{key:1,class:"go-ml-3",onClick:z},{icon:a(()=>[e(p,null,{default:a(()=>[e(l(C))]),_:1})]),default:a(()=>[t[6]||(t[6]=o(" \u65B0\u589E\u8FC7\u6EE4\u5668 "))]),_:1})),Y(" \u5F39\u7A97 "),e(V,{class:"go-chart-data-monaco-editor",show:f.value,"onUpdate:show":t[1]||(t[1]=F=>f.value=F),"mask-closable":!1,closeOnEsc:!1},{default:a(()=>[e(y,{bordered:!1,role:"dialog",size:"small","aria-modal":"true",style:{width:"1000px",height:"600px"}},{header:a(()=>[e(u,null,{default:a(()=>[e(D,null,{default:a(()=>t[7]||(t[7]=[o("\u8FC7\u6EE4\u5668\u51FD\u6570\u7F16\u8F91\u5668")])),_:1})]),_:1})]),"header-extra":a(()=>t[8]||(t[8]=[])),action:a(()=>[e(u,{justify:"space-between"},{default:a(()=>[r("div",ce,[e(S,{bordered:!1,type:"primary"},{icon:a(()=>[e(p,{component:l(m)},null,8,["component"])]),default:a(()=>[t[14]||(t[14]=o(" \u89C4\u5219 "))]),_:1}),e(D,{class:"go-ml-2",depth:"2"},{default:a(()=>t[15]||(t[15]=[o("\u8FC7\u6EE4\u5668\u9ED8\u8BA4\u5904\u7406\u63A5\u53E3\u8FD4\u56DE\u503C\u7684\u300Cdata\u300D\u5B57\u6BB5")])),_:1})]),e(u,null,{default:a(()=>[e(_,{size:"medium",onClick:$},{default:a(()=>t[16]||(t[16]=[o("\u53D6\u6D88")])),_:1}),e(_,{size:"medium",type:"primary",onClick:A},{default:a(()=>t[17]||(t[17]=[o("\u4FDD\u5B58")])),_:1})]),_:1})]),_:1})]),default:a(()=>[e(u,{size:"small",vertical:""},{default:a(()=>[e(u,{justify:"space-between"},{default:a(()=>[r("div",null,[e(u,{vertical:""},{default:a(()=>[e(S,{type:"info"},{default:a(()=>t[9]||(t[9]=[r("span",{class:"func-keyword"},"function",-1),o("\xA0\xA0filter(data, res)\xA0\xA0{ ")])),_:1}),e(l(Re),{modelValue:x.value,"onUpdate:modelValue":t[0]||(t[0]=F=>x.value=F),width:"460px",height:"380px",language:"javascript"},null,8,["modelValue"]),e(S,{type:"info"},{default:a(()=>t[10]||(t[10]=[o("}")])),_:1})]),_:1})]),e(q,{vertical:"",style:{height:"480px"}}),e(L,{style:{"max-height":"480px"}},{default:a(()=>[e(u,{size:15,vertical:""},{default:a(()=>[r("div",ue,[e(u,null,{default:a(()=>[e(D,{depth:"3"},{default:a(()=>t[11]||(t[11]=[o("\u9ED8\u8BA4\u8FC7\u6EE4\u6570\u636E(data)\uFF1A")])),_:1}),e(s,{code:l(N)(k.value?.data)||"\u6682\u65E0",language:"json","word-wrap":!0},null,8,["code"])]),_:1})]),r("div",de,[e(u,null,{default:a(()=>[e(D,{depth:"3"},{default:a(()=>t[12]||(t[12]=[o("\u63A5\u53E3\u8FD4\u56DE\u6570\u636E(res)\uFF1A")])),_:1}),e(s,{code:l(N)(k.value)||"\u6682\u65E0",language:"json","word-wrap":!0},null,8,["code"])]),_:1})]),r("div",ie,[e(u,null,{default:a(()=>[e(D,{depth:"3"},{default:a(()=>t[13]||(t[13]=[o("\u8FC7\u6EE4\u5668\u7ED3\u679C\uFF1A")])),_:1}),e(s,{code:O.value||"\u6682\u65E0",language:"json","word-wrap":!0},null,8,["code"])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])],64)}}}),pe=J(fe,[["__scopeId","data-v-0ef98f64"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentConfigurations/components/ChartData/components/ChartDataMonacoEditor/index.vue"]]),_e=I=>{const m=b();return{uploadFileListRef:m,beforeUpload:({file:C})=>{m.value=[];const h=C.file.type;return h!==se.JSON&&h!==se.TXT?(window.$message.warning("\u4EC5\u652F\u6301\u4E0A\u4F20 \u3010JSON\u3011 \u683C\u5F0F\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\uFF01"),!1):!0},customRequest:C=>{const{file:h}=C;ke(()=>{h.file?$e(h.file).then(c=>{I.value.option.dataset=De(c)}):window.$message.error("\u5BFC\u5165\u6570\u636E\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")})},download:()=>{try{window.$message.success("\u4E0B\u8F7D\u4E2D\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5F85..."),Ae(Se(I.value.option.dataset),void 0,"json")}catch{window.$message.error("\u4E0B\u8F7D\u5931\u8D25\uFF0C\u6570\u636E\u9519\u8BEF\uFF01")}}}},me=P({__name:"index",props:{show:{type:Boolean,required:!1},ajax:{type:Boolean,required:!0}},setup(I){const{targetData:m}=ne(),C=[i.global.t("project.field"),i.global.t("project.mapping"),i.global.t("project.status")],{HelpOutlineIcon:h}=B.ionicons5,{DocumentAddIcon:c,DocumentDownloadIcon:E}=B.carbon,f=b(),x=b(),w=b(),k=b(!1),{uploadFileListRef:T,customRequest:O,beforeUpload:z,download:H}=_e(m),$=G(()=>m.value.request.requestDataType!==Ie.STATIC),A=G(()=>m.value.chartConfig.chartFrame===ee.ECHARTS),d=s=>{let p=M.SUCCESS;for(let _=0;_<f.value.length;_++)if(f.value[_][s]===void 0)return p=M.FAILURE,p;return M.SUCCESS},t=()=>{try{return x.value.map((s,p)=>p===0?{field:i.global.t("project.universalIdentifier"),mapping:s,result:M.NULL}:{field:`${i.global.t("project.dataItem")}-${p}`,mapping:s,result:d(s)})}catch{return[]}};return W(()=>m.value?.option?.dataset,s=>{s&&m?.value?.chartConfig?.chartFrame===ee.ECHARTS?(f.value=s,A.value&&(x.value=s.dimensions,w.value=t())):s!=null?(w.value=null,f.value=s):(k.value=!0,f.value=i.global.t("project.noDataSource")),Ue(s)&&(w.value=null)},{immediate:!0}),(s,p)=>{const _=n("n-badge"),u=n("n-text"),y=n("n-space"),D=n("n-table"),S=n("n-timeline-item"),q=n("n-icon"),L=n("n-button"),V=n("n-upload"),F=n("n-tooltip"),we=n("n-code"),ye=n("n-card"),be=n("n-timeline");return v(),U(be,{class:"go-chart-configurations-timeline"},{default:a(()=>[ae(e(S,{type:"info",title:l(K).MAPPING},{default:a(()=>[e(D,{striped:""},{default:a(()=>[r("thead",null,[r("tr",null,[(v(),R(X,null,te(C,g=>r("th",{key:g},j(g),1)),64))])]),r("tbody",null,[(v(!0),R(X,null,te(w.value,(g,je)=>(v(),R("tr",{key:je},[r("td",null,j(g.field),1),r("td",null,j(g.mapping),1),r("td",null,[g.result===0?(v(),U(y,{key:0,wrap:!1},{default:a(()=>[e(_,{dot:"",type:"success"}),e(u,null,{default:a(()=>[o(j(l(i).global.t("project.none")),1)]),_:1})]),_:1})):(v(),U(y,{key:1,wrap:!1},{default:a(()=>[e(_,{dot:"",type:g.result===1?"success":"error"},null,8,["type"]),e(u,null,{default:a(()=>[o(j(g.result===1?l(i).global.t("project.suc"):l(i).global.t("project.err")),1)]),_:2},1024)]),_:2},1024))])]))),128))])]),_:1})]),_:1},8,["title"]),[[le,A.value&&w.value]]),ae(e(S,{color:"#97846c",title:l(K).FILTER},{default:a(()=>[e(y,{size:18,vertical:""},{default:a(()=>[e(u,{depth:"3"},{default:a(()=>[o(j(l(i).global.t("project.filterDefaultHandling")),1)]),_:1}),e(l(pe))]),_:1})]),_:1},8,["title"]),[[le,$.value]]),e(S,{type:"success",title:l(K).CONTENT},{default:a(()=>[e(y,{vertical:"",wrap:!1},{default:a(()=>[e(y,{class:"source-btn-box"},{default:a(()=>[e(V,{"file-list":l(T),"onUpdate:fileList":p[0]||(p[0]=g=>Te(T)?T.value=g:null),"show-file-list":!1,customRequest:l(O),onBeforeUpload:l(z)},{default:a(()=>[e(y,{wrap:!1},{default:a(()=>[I.ajax?Y("v-if",!0):(v(),U(L,{key:0,class:"sourceBtn-item",disabled:k.value},{icon:a(()=>[e(q,null,{default:a(()=>[e(l(c))]),_:1})]),default:a(()=>[o(" "+j(l(i).global.t("project.import")),1)]),_:1},8,["disabled"]))]),_:1})]),_:1},8,["file-list","customRequest","onBeforeUpload"]),r("div",null,[e(L,{class:"sourceBtn-item",disabled:k.value,onClick:l(H)},{icon:a(()=>[e(q,null,{default:a(()=>[e(l(E))]),_:1})]),default:a(()=>[o(" "+j(l(i).global.t("project.download")),1)]),_:1},8,["disabled","onClick"]),e(F,{trigger:"hover"},{trigger:a(()=>[e(q,{class:"go-ml-1",size:"21",depth:3},{default:a(()=>[e(l(h))]),_:1})]),default:a(()=>[e(u,{depth:"3"},{default:a(()=>[o(j(l(i).global.t("project.clickToDownload")),1)]),_:1})]),_:1})])]),_:1}),e(ye,{size:"small"},{default:a(()=>[e(we,{code:l(N)(f.value),language:"json"},null,8,["code"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})}}}),ve=J(me,[["__scopeId","data-v-17d4cfcb"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentConfigurations/components/ChartData/components/ChartDataMatchingAndShow/index.vue"]]),ge={class:"go-chart-configurations-data-point"},he=P({__name:"index",setup(I){return(m,C)=>(v(),R("div",ge,[e(l(ve),{show:!1,ajax:!1})]))}});oe=J(he,[["__scopeId","data-v-3c099e77"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentConfigurations/components/ChartData/components/ChartDataStatic/index.vue"]])});export{Le as __tla,oe as default};
