import{d as T,r as D,eo as c,aj as L,S as P,ep as g,f as o,h as u,i as R,l as n,w as t,k as F,p as i,n as l,D as f,j as r,em as M,eq as N,_ as V,__tla as z}from"./index-35337fd3.js";import{M as G,__tla as B}from"./EditorWorker-f1a821bc.js";import"./editorWorker-259d4dbf.js";import{g as H,__tla as J}from"./storage-74447fc1.js";import"./querySelectorAll-a0b713c4.js";import{g as p}from"./plugin-11a308bb.js";import{i as K}from"./icon-ebc544b2.js";import{__tla as U}from"./chartEditStore-a8bbc3da.js";let v,q=Promise.all([(()=>{try{return z}catch{}})(),(()=>{try{return B}catch{}})(),(()=>{try{return J}catch{}})(),(()=>{try{return U}catch{}})()]).then(async()=>{const y={class:"go-edit"},C=T({__name:"index",setup(Z){const{ChevronBackOutlineIcon:Q,DownloadIcon:h,AnalyticsIcon:k}=K.ionicons5,d=window.showOpenFilePicker,s=D("");window.$message.warning("\u8BF7\u4E0D\u8981\u5237\u65B0\u6B64\u7A97\u53E3\uFF01");async function b(){const e=await H();M(`\u7F16\u8F91-${e.editCanvasConfig.projectName}`),s.value=g(e)}setTimeout(b);function O(){p({message:"\u5BFC\u5165\u6570\u636E\u5C06\u8986\u76D6\u5185\u5BB9\uFF0C\u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\u56DE\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F",isMaskClosable:!0,transformOrigin:"center",onPositiveCallback:async()=>{try{const e=await(await d())[0].getFile(),a=new FileReader;a.readAsText(e),a.onloadend=()=>{s.value=(a.result||"").toString()},window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(e){window.$message.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u662F\u5426\u635F\u574F\uFF01"),console.log(e)}}})}window.opener.addEventListener(c.CHART,e=>{window.$message.success("\u6B63\u5728\u8FDB\u884C\u66F4\u65B0..."),L(P.GO_CHART_STORAGE_LIST,[e.detail]),s.value=g(e.detail)}),document.addEventListener("keydown",function(e){e.keyCode==83&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&(e.preventDefault(),m())});async function m(){if(!window.opener)return window.$message.error("\u6E90\u7A97\u53E3\u5DF2\u5173\u95ED\uFF0C\u89C6\u56FE\u540C\u6B65\u5931\u8D25\uFF01");p({message:"\u662F\u5426\u8986\u76D6\u6E90\u89C6\u56FE\u5185\u5BB9? \u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\uFF01",isMaskClosable:!0,transformOrigin:"center",onPositiveCallback:()=>{try{const e=N(s.value);delete e.id,window.opener.dispatchEvent(new CustomEvent(c.JSON,{detail:e})),window.$message.success("\u6B63\u5728\u540C\u6B65\u5185\u5BB9...")}catch(e){window.$message.error("\u5185\u5BB9\u683C\u5F0F\u6709\u8BEF"),console.log(e)}}})}return window.onbeforeunload=()=>{window.opener&&window.opener.dispatchEvent(new CustomEvent(c.CLOSE))},(e,a)=>{const S=o("n-text"),w=o("n-icon"),_=o("n-button"),E=o("n-tag"),$=o("n-space"),x=o("n-layout-header"),j=o("n-layout-content"),A=o("n-layout");return u(),R("div",y,[n(A,null,{default:t(()=>[n(x,{class:"go-edit-header go-px-5 go-flex-items-center",bordered:""},{default:t(()=>[F("div",null,[n(S,{class:"go-edit-title go-mr-4"},{default:t(()=>a[1]||(a[1]=[i("\u9875\u9762\u5728\u7EBF\u7F16\u8F91\u5668")])),_:1}),l(d)?(u(),f(_,{key:0,class:"go-mr-3",size:"medium",onClick:O},{icon:t(()=>[n(w,null,{default:t(()=>[n(l(h))]),_:1})]),default:t(()=>[a[2]||(a[2]=i(" \u5BFC\u5165 "))]),_:1})):r("v-if",!0)]),n($,null,{default:t(()=>[r(" \u6682\u65F6\u5173\u95ED "),r(' <n-tag :bordered="false" type="warning"> \u300C\u9875\u9762\u5931\u7126\u4FDD\u5B58\u300D </n-tag> '),n(E,{bordered:!1,type:"warning"},{default:t(()=>a[3]||(a[3]=[i(" \u300CCtrl + S \u66F4\u65B0\u89C6\u56FE\u300D ")])),_:1}),l(d)?(u(),f(_,{key:0,class:"go-mr-3",size:"medium",onClick:m},{icon:t(()=>[n(w,null,{default:t(()=>[n(l(k))]),_:1})]),default:t(()=>[a[4]||(a[4]=i(" \u4FDD\u5B58 "))]),_:1})):r("v-if",!0)]),_:1})]),_:1}),n(j,null,{default:t(()=>[n(l(G),{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=I=>s.value=I),language:"json",editorOptions:{lineNumbers:"on",minimap:{enabled:!0}}},null,8,["modelValue"])]),_:1})]),_:1})])}}});v=V(C,[["__scopeId","data-v-89a81625"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/edit/index.vue"]])});export{q as __tla,v as default};
