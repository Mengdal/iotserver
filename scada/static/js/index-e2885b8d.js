import{o as ke,W as Pe,eP as Kt,eq as Nt,eQ as A,c8 as Ce,eC as Ie,ao as Yt,d as te,cQ as pe,a as ve,V as U,h as I,i as j,K as Se,j as M,F as le,a9 as ie,bN as ne,au as X,n as i,k as D,_ as ae,ei as Ae,D as oe,w as S,M as He,ea as De,ef as fe,eg as Le,eb as Ke,cb as Z,U as Xt,b as Ue,cc as Ne,X as ce,ci as Ye,f as $,eR as Gt,T as ye,r as G,eS as Xe,l as w,bU as E,I as zt,t as N,p as Me,cD as Bt,es as z,et as Y,be as Ft,z as Vt,bm as Wt,ai as qt,__tla as Zt}from"./index-35337fd3.js";import{u as Qt,__tla as Jt}from"./useSync.hook-92e9f5f7.js";import{u as je,d as ea,__tla as ta}from"./index-dd2f15f1.js";import{u as se,av as B,e as aa,aw as x,ax as _e,a as oa,ay as sa,__tla as na}from"./chartEditStore-a8bbc3da.js";import{a as la,__tla as ra}from"./useKeyboard.hook-792725d0.js";import{a as ca,b as Ge,l as ia}from"./plugin-11a308bb.js";import{C as da}from"./index-f68e7159.js";import"./querySelectorAll-a0b713c4.js";import{l as ze}from"./listen-42d046d4.js";import{u as Be,C as Fe,__tla as ua}from"./chartLayoutStore-6d3b55f0.js";import{i as he}from"./icon-ebc544b2.js";import"./index-51a85937.js";import"./index-a6d36fad.js";import"./energy-f0146bb7.js";let Ve,pa=Promise.all([(()=>{try{return Zt}catch{}})(),(()=>{try{return Jt}catch{}})(),(()=>{try{return ta}catch{}})(),(()=>{try{return na}catch{}})(),(()=>{try{return ra}catch{}})(),(()=>{try{return ua}catch{}})()]).then(async()=>{const de=se(),We=t=>{let o=()=>{};ke(async()=>{de.setEditCanvas(B.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),de.setEditCanvas(B.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content")),await t(),o=de.listenerScale()}),Pe(()=>{de.setEditCanvas(B.EDIT_LAYOUT_DOM,null),de.setEditCanvas(B.EDIT_CONTENT_DOM,null),o()})},h=se(),{onClickOutSide:qe}=je(),Ze=async t=>{t.preventDefault();try{ca();const o=t.dataTransfer.getData(Kt.DRAG_KEY);if(!o){Ge();return}h.setEditCanvas(B.IS_CREATE,!1);const s=Nt(o);if(s.disabled)return;let n=await aa(s);s.redirectComponent&&(s.dataset&&(n.option.dataset=s.dataset),n.chartConfig.title=s.title,n.chartConfig.chartFrame=s.chartFrame),A(n,t.offsetX-n.attr.w/2,t.offsetY-n.attr.h/2),h.addComponentList(n,!1,!0),console.log("====\u9009\u4E2D"),h.setTargetSelectChart(n.id),Ge()}catch(o){console.log("error",o),ia(),window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...")}},$e=t=>{t.preventDefault(),t.stopPropagation(),t.dataTransfer&&(t.dataTransfer.dropEffect="copy")},Oe=(t,o)=>{if(o){h.setTargetSelectChart(o.id);return}h.setTargetSelectChart(void 0)},Qe=(t,o)=>{if(t.which==2||window.$KeyboardActive?.space)return;Oe();const s=t.offsetX,n=t.offsetY,a=t.screenX,f=t.screenY,u=h.getEditCanvas.scale;h.setMousePosition(void 0,void 0,s,n);const m=Ce.throttle(c=>{h.setTargetSelectChart(),h.setEditCanvas(B.IS_SELECT,!0);const C=s+c.screenX-a,l=n+c.screenY-f;h.setMousePosition(C,l);const e={x1:0,y1:0,x2:0,y2:0};C>s&&l>n?(e.x1=s,e.y1=n,e.x2=Math.round(s+(c.screenX-a)/u),e.y2=Math.round(n+(c.screenY-f)/u)):C>s&&l<n?(e.x1=s,e.y1=Math.round(n-(f-c.screenY)/u),e.x2=Math.round(s+(c.screenX-a)/u),e.y2=n):C<s&&l>n?(e.x1=Math.round(s-(a-c.screenX)/u),e.y1=n,e.x2=s,e.y2=Math.round(n+(c.screenY-f)/u)):(e.x1=Math.round(s-(a-c.screenX)/u),e.y1=Math.round(n-(f-c.screenY)/u),e.x2=s,e.y2=n),h.getComponentList.forEach(g=>{if(!h.getTargetChart.selectId.includes(g.id)){const{x:d,y:r,w:v,h:y}=g.attr,T={x1:d,y1:r,x2:d+v,y2:r+y};T.x1-e.x1>=0&&T.y1-e.y1>=0&&T.x2-e.x2<=0&&T.y2-e.y2<=0&&!g.status.lock&&!g.status.hide&&h.setTargetSelectChart(g.id,!0)}})},30),p=()=>{m.cancel(),h.setEditCanvas(B.IS_SELECT,!1),h.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",p)};document.addEventListener("mousemove",m),document.addEventListener("mouseup",p)},Re=()=>({mouseClickHandle:(t,o)=>{if(t.preventDefault(),t.stopPropagation(),!o.status.lock&&window.$KeyboardActive?.ctrl)if(h.targetChart.selectId.includes(o.id)){const s=h.targetChart.selectId.filter(n=>n!==o.id);console.log("---",s),h.setTargetSelectChart(s)}else console.log("---",o.id),h.setTargetSelectChart(o.id,!0)},mousedownHandle:(t,o)=>{if(t.preventDefault(),t.stopPropagation(),o.status.lock||(qe(),t.buttons===Ie.LEFT&&window.$KeyboardActive?.ctrl))return;const s=h.getTargetChart.selectId;if(t.buttons===Ie.RIGHT&&s.length>1&&s.includes(o.id)||(h.setTargetSelectChart(o.id),t.buttons===Ie.RIGHT))return;const n=h.getEditCanvas.scale,a=h.getEditCanvasConfig.width,f=h.getEditCanvasConfig.height,u=new Map;h.getTargetChart.selectId.forEach(e=>{const g=h.fetchTargetIndex(e);if(g!==-1){const{x:d,y:r,w:v,h:y}=Yt(h.getComponentList[g]).attr;u.set(e,{x:d,y:r,w:v,h:y})}});const m=t.screenX,p=t.screenY;let c=[];h.getTargetChart.selectId.forEach(e=>{if(!u.has(e))return;const g=h.fetchTargetIndex(e);c.push(Ce.cloneDeep(h.getComponentList[g]))}),h.setMousePosition(void 0,void 0,m,p);const C=Ce.throttle(e=>{h.setEditCanvas(B.IS_DRAG,!0),h.setMousePosition(e.screenX,e.screenY);let g=(e.screenX-m)/n,d=(e.screenY-p)/n;h.getTargetChart.selectId.forEach(r=>{if(!u.has(r))return;const v=h.fetchTargetIndex(r),{x:y,y:T,w:L,h:k}=u.get(r),K=h.getComponentList[v];let O=Math.round(y+g),F=Math.round(T+d);const R=50;O=O<-L+R?-L+R:O,F=F<-k+R?-k+R:F,O=O>a-R?a-R:O,F=F>f-R?f-R:F,K&&(K.attr=Object.assign(K.attr,{x:O,y:F}))})},20),l=()=>{try{if(h.setMousePosition(0,0,0,0),h.setEditCanvas(B.IS_DRAG,!1),c.length){h.getTargetChart.selectId.forEach(g=>{if(!u.has(g))return;const d=h.fetchTargetIndex(g),r=h.getComponentList[d];c.forEach(v=>{v.id===g&&(v.attr=Object.assign(v.attr,{offsetX:r.attr.x-v.attr.x,offsetY:r.attr.y-v.attr.y}))})});const e=c.filter(g=>g.attr.offsetX!==0&&g.attr.offsetY!==0);e.length&&h.moveComponentList(e)}document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",l)}catch(e){console.log(e)}};document.addEventListener("mousemove",C),document.addEventListener("mouseup",l)},mouseenterHandle:(t,o)=>{t.preventDefault(),t.stopPropagation(),h.getEditCanvas.isSelect||h.setTargetHoverChart(o.id)},mouseleaveHandle:(t,o)=>{t.preventDefault(),t.stopPropagation(),h.setEditCanvas(B.IS_DRAG,!1),h.setTargetHoverChart(void 0)}}),Je=(t,o,s)=>{t.stopPropagation(),t.preventDefault(),h.setEditCanvas(B.IS_DRAG,!0);const n=h.getEditCanvas.scale,a=s.x,f=s.y,u=s.w,m=s.h,p=t.screenX,c=t.screenY;h.setMousePosition(p,c);const C=Ce.throttle(e=>{h.setMousePosition(e.screenX,e.screenY);let g=Math.round((e.screenX-p)/n),d=Math.round((e.screenY-c)/n);const r=/t/.test(o),v=/b/.test(o),y=/l/.test(o),T=/r/.test(o),L=m+(r?-d:v?d:0),k=u+(y?-g:T?g:0);s.h=L>0?L:0,s.w=k>0?k:0,s.x=a+(y?g:0),s.y=f+(r?d:0)},50),l=()=>{h.setEditCanvas(B.IS_DRAG,!1),h.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",l)};document.addEventListener("mousemove",C),document.addEventListener("mouseup",l)},ge=(t,o)=>t?{zIndex:o+1,left:`${t.x}px`,top:`${t.y}px`}:{},re=(t,o)=>t?{width:`${o?o*t.w:t.w}px`,height:`${o?o*t.h:t.h}px`}:{},et=(t,o,s,n)=>{const{w:a,h:f}=s,u=/t/.test(t),m=/b/.test(t),p=/l/.test(t),c=/r/.test(t);let C=0,l=0;return t.length===2?(C=p?0:a,l=u?0:f):((u||m)&&(C=a/2,l=u?0:f),(p||c)&&(C=p?0:a,l=Math.floor(f/2))),{left:`${C}px`,top:`${l}px`,cursor:n[o]+"-resize"}},tt=["onMousedown"],at=te({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(t){pe(l=>({"a127b3d5-themeColor":u.value}));const o=t,s=ve(),n=se(),a=["t","r","b","l","lt","rt","lb","rb"],f=["n","e","s","w","nw","ne","sw","se"],u=U(()=>s.getAppTheme),m=U(()=>n.getEditCanvas[B.IS_DRAG]||o.item.status.lock?!1:o.item.id===n.getTargetChart.hoverId),p=U(()=>{const l=o.item.id;return o.item.status.lock?!1:n.getTargetChart.selectId.find(e=>e===l)}),c=U(()=>o.item.status.lock),C=U(()=>o.item.status.hide);return(l,e)=>(I(),j("div",{class:ne(["go-shape-box",{lock:c.value,hide:C.value}])},[Se(l.$slots,"default",{},void 0,!0),M(" \u951A\u70B9 "),t.hiddenPoint?M("v-if",!0):(I(!0),j(le,{key:0},ie(p.value?a:[],(g,d)=>(I(),j("div",{class:ne(`shape-point ${g}`),key:d,style:X(i(et)(g,d,t.item.attr,f)),onMousedown:r=>i(Je)(r,g,t.item.attr)},null,46,tt))),128)),M(" \u9009\u4E2D "),D("div",{class:"shape-modal",style:X(i(re)(t.item.attr))},[D("div",{class:ne(["shape-modal-select",{active:p.value}])},null,2),D("div",{class:ne(["shape-modal-change",{selectActive:p.value,hoverActive:m.value}])},null,2)],4)],2))}}),we=ae(at,[["__scopeId","data-v-a127b3d5"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentEdit/components/EditShapeBox/index.vue"]]),ot={class:"go-edit-group-box"},st=te({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(t){const o=se(),{handleContextMenu:s}=je(),{mouseenterHandle:n,mouseleaveHandle:a,mousedownHandle:f,mouseClickHandle:u}=Re(),m=(C,l,e)=>{const g=d=>l.filter(r=>d.includes(r.key));if(o.getTargetChart.selectId.length>1)return g([Z.GROUP,Z.DELETE]);{const d=[];e.status.lock?d.push(Z.LOCK):d.push(Z.UNLOCK),e.status.hide?d.push(Z.HIDE):d.push(Z.SHOW);const r=[Z.UN_GROUP];return[...g(r),ea(),...C.filter(v=>!d.includes(v.key))]}},p=U(()=>Ae(o.getEditCanvasConfig.chartCustomThemeColorInfo)[o.getEditCanvasConfig.chartThemeColor]),c=U(()=>o.getEditCanvasConfig.chartThemeSetting);return(C,l)=>(I(),j("div",ot,[(I(),oe(i(we),{key:t.groupData.id,"data-id":t.groupData.id,index:t.groupIndex,item:t.groupData,hiddenPoint:!0,class:ne(i(De)(t.groupData.styles.animations)),style:X({...i(ge)(t.groupData.attr,t.groupIndex),...i(re)(t.groupData.attr),...i(fe)(t.groupData.styles),...i(Le)(t.groupData.styles),...i(Ke)(t.groupData.styles)}),onClick:l[0]||(l[0]=e=>i(u)(e,t.groupData)),onMousedown:l[1]||(l[1]=e=>i(f)(e,t.groupData)),onMouseenter:l[2]||(l[2]=e=>i(n)(e,t.groupData)),onMouseleave:l[3]||(l[3]=e=>i(a)(e,t.groupData)),onContextmenu:l[4]||(l[4]=e=>i(s)(e,t.groupData,m))},{default:S(()=>[M(" \u7EC4\u5408\u7EC4\u4EF6 "),(I(!0),j(le,null,ie(t.groupData.groupList,e=>(I(),oe(i(we),{key:e.id,"data-id":e.id,index:t.groupIndex,item:e,hiddenPoint:!0,style:X({...i(ge)(e.attr,t.groupIndex)})},{default:S(()=>[(I(),oe(He(e.chartConfig.chartKey),{class:ne(["edit-content-chart",i(De)(e.styles.animations)]),chartConfig:e,themeSetting:c.value,themeColor:p.value,style:X({...i(re)(e.attr),...i(fe)(e.styles),...i(Le)(e.styles)})},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}}),nt=ae(st,[["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentEdit/components/EditGroup/index.vue"]]),lt={class:"go-edit-align-line"},rt=te({__name:"index",setup(t){pe(d=>({"c6fbc864-themeColor":u.value}));const o=ve(),s=se(),n=Xt(),a=Ue({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),f=d=>d?{left:`${d.x?d.x:0}px`,top:`${d.y?d.y:0}px`}:{},u=U(()=>o.getAppTheme),m=U(()=>n.getChartAlignRange),p=U(()=>s.getEditCanvas[B.IS_DRAG]),c=(d,r)=>Math.abs(d-r)<=m.value,C=U(()=>s.getTargetChart.selectId),l=U(()=>s.getComponentList[s.fetchTargetIndex()]),e=U(()=>l.value?.attr||{}),g=U(()=>({id:"0",attr:{w:Ne(s.getEditCanvasConfig.width),h:Ne(s.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0}}));return ce(()=>s.getMousePosition,Ye(()=>{try{if(!p.value||C.value.length!==1)return;const d=e.value.w,r=e.value.h,v=e.value.x,y=v+d/2,T=v+d,L=[v,y,T],k=e.value.y,K=k+r/2,O=k+r,F=[k,K,O];a.select.clear(),a.sorptioned.y=!1;const R=s.getComponentList.map(b=>({id:b.id,attr:b.attr}));R.push(g.value),a.lineArr.forEach(b=>{R.forEach(Q=>{if(C.value[0]===Q.id)return;const _=Q.attr.w,P=Q.attr.h,H=Q.attr.x,V=H+_/2,J=H+_,xe=[H,V,J],W=Q.attr.y,ee=W+P/2,q=W+P,ue=[W,ee,q];b.includes("rowt")&&(c(k,W)&&(a.select.set(b,{y:W}),A(l.value,v,W)),c(k,ee)&&(a.select.set(b,{y:ee}),A(l.value,v,ee)),c(k,q)&&(a.select.set(b,{y:q}),A(l.value,v,q))),b.includes("rowc")&&(c(K,W)&&(a.select.set(b,{y:W}),A(l.value,v,W-r/2)),c(K,ee)&&(a.select.set(b,{y:ee}),A(l.value,v,ee-r/2)),c(K,q)&&(a.select.set(b,{y:q}),A(l.value,v,q-r/2))),b.includes("rowb")&&(c(O,W)&&(a.select.set(b,{y:W}),A(l.value,v,W-r)),c(O,ee)&&(a.select.set(b,{y:ee}),A(l.value,v,ee-r)),c(O,q)&&(a.select.set(b,{y:q}),A(l.value,v,q-r))),b.includes("coll")&&(c(v,H)&&(a.select.set(b,{x:H}),A(l.value,H,k)),c(v,V)&&(a.select.set(b,{x:V}),A(l.value,V,k)),c(v,J)&&(a.select.set(b,{x:J}),A(l.value,J,k))),b.includes("colc")&&(c(y,H)&&(a.select.set(b,{x:H}),A(l.value,H-d/2,k)),c(y,V)&&(a.select.set(b,{x:V}),A(l.value,V-d/2,k)),c(y,J)&&(a.select.set(b,{x:J}),A(l.value,J-d/2,k))),b.includes("colr")&&(c(T,H)&&(a.select.set(b,{x:H}),A(l.value,H-d,k)),c(T,V)&&(a.select.set(b,{x:V}),A(l.value,V-d,k)),c(T,J)&&(a.select.set(b,{x:J}),A(l.value,J-d,k)))})})}catch(d){console.log(d)}},200),{deep:!0}),ce(()=>p.value,d=>{d||(a.select.clear(),a.sorptioned.y=!1)}),(d,r)=>(I(),j("div",lt,[(I(!0),j(le,null,ie(a.lineArr,v=>(I(),j("div",{class:ne(["line",[v.includes("row")?"row":"col",a.select.has(v)&&"visible"]]),key:v,style:X(f(a.select.get(v)))},null,6))),128))]))}}),ct=ae(rt,[["__scopeId","data-v-c6fbc864"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentEdit/components/EditAlignLine/index.vue"]]),it=te({__name:"index",setup(t){return(o,s)=>{const n=$("n-watermark");return I(),oe(n,{id:"go-edit-watermark",content:i(Gt),cross:"",selectable:"","font-size":16,"line-height":16,width:500,height:150,"x-offset":12,"y-offset":80,rotate:-15},null,8,["content"])}}}),dt=ae(it,[["__scopeId","data-v-90e17467"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentEdit/components/EditWatermark/index.vue"]]),ut=te({__name:"index",setup(t){pe(m=>({"d18ec301-themeColor":f.value}));const o=ve(),s=se(),{isSelect:n,scale:a}=ye(s.getEditCanvas),f=U(()=>o.getAppTheme),u=G();return ce(()=>s.getMousePosition,m=>{if(!n.value)return;const{startX:p,startY:c,x:C,y:l}=m,e={zIndex:Xe,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0};C>p&&l>c?(e.x=p,e.y=c,e.w=Math.round((C-p)/a.value),e.h=Math.round((l-c)/a.value)):C>p&&l<c?(e.x=p,e.w=Math.round((C-p)/a.value),e.h=Math.round((c-l)/a.value),e.y=c-e.h):C<p&&l>c?(e.y=c,e.w=Math.round((p-C)/a.value),e.h=Math.round((l-c)/a.value),e.x=p-e.w):(e.w=Math.round((p-C)/a.value),e.h=Math.round((c-l)/a.value),e.x=p-e.w,e.y=c-e.h),u.value={...ge(e,Xe),...re(e)}},{deep:!0}),(m,p)=>i(n)?(I(),j("div",{key:0,class:"go-edit-select",style:X(u.value)},p[0]||(p[0]=[D("div",{class:"select-background"},null,-1),D("div",{class:"select-border"},null,-1)]),4)):M("v-if",!0)}}),pt=ae(ut,[["__scopeId","data-v-d18ec301"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentEdit/components/EditSelect/index.vue"]]),vt=te({__name:"index",setup(t){const o=se(),{getEditCanvasConfig:s,getEditCanvas:n}=ye(o),a=U(()=>({w:s.value.width,h:s.value.height})),f=U(()=>{const m={transform:`scale(${n.value.scale})`};return console.log("\u7F29\u653E",m),{...re(a.value),...m}}),u=U(()=>{const m=n.value.isCreate&&{"z-index":99999};return{...re(a.value),...m}});return(m,p)=>(I(),j("div",{class:"go-edit-range go-transition",style:X(f.value),onMousedown:p[0]||(p[0]=c=>i(Qe)(c,void 0))},[Se(m.$slots,"default",{},void 0,!0),M(" \u6C34\u5370 "),w(i(dt)),M(" \u62D6\u62FD\u65F6\u7684\u8F85\u52A9\u7EBF "),w(i(ct)),M(" \u6846\u9009\u65F6\u7684\u6837\u5F0F\u6846 "),w(i(pt)),M(" \u62D6\u62FD\u65F6\u7684\u906E\u7F69 "),D("div",{class:"go-edit-range-model",style:X(u.value)},null,4)],36))}}),ht=ae(vt,[["__scopeId","data-v-69bc885d"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentEdit/components/EditRange/index.vue"]]),gt={class:"go-sketch-rule"},be=20,mt=te({__name:"index",setup(t){pe(_=>({"6c481a9a-themeColor":k.value,"6c481a9a-containerWidth":T.value,"6c481a9a-cursorStyle":l.value}));const o=se(),s=Be(),n=ve();let a=[0,0],f=[0,0];const u=G(),m=G(!0),p=G(),c=G(),C=G(!1),l=G("auto"),{width:e,height:g}=ye(o.getEditCanvasConfig),d=G(0),r=G(0),v=Ue({h:[],v:[]}),y=U(()=>o.getEditCanvas.scale),T=U(()=>`${g.value*2}px`),L=U(()=>n.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),k=U(()=>n.getAppTheme),K=_=>{if(_.ctrlKey||_.metaKey){_.preventDefault();let P=y.value;if(_.wheelDelta>=0&&y.value<2){P=y.value+.05,o.setScale(P);return}_.wheelDelta<0&&y.value>.1&&(P=y.value-.05,o.setScale(P))}},O=()=>{if(!u.value)return;const _=u.value.getBoundingClientRect(),P=p.value.getBoundingClientRect();d.value=(_.left+be-P.left)/y.value,r.value=(_.top+be-P.top)/y.value},F=_=>{if(_.preventDefault(),_.stopPropagation(),_.which==2)C.value=!0;else if(!window.$KeyboardActive?.space)return;document.activeElement?.blur();const P=_.pageX,H=_.pageY,V=ze(window,"mousemove",xe=>{const W=xe.pageX-P,ee=xe.pageY-H,[q,ue]=a,[Te,me]=f;a=[ue,W],f=[me,ee],u.value.scrollLeft-=ue>q?Math.abs(ue-q):-Math.abs(ue-q),u.value.scrollTop-=me>Te?Math.abs(me-Te):-Math.abs(me-Te)}),J=ze(window,"mouseup",()=>{V(),J(),a=[0,0],f=[0,0],C.value=!1})},R=()=>{const _=document.getElementById("go-chart-edit-layout");return _?{height:_.clientHeight-20,width:_.clientWidth-20}:{width:e.value,height:g.value}},b=Ye(()=>{m.value=!1,setTimeout(()=>{m.value=!0},10)},20),Q=()=>{const{width:_,height:P}=c.value.getBoundingClientRect(),{width:H,height:V}=R();u.value.scrollLeft=_/2-H/2,u.value.scrollTop=P/2-V/2};return ce(()=>n.getDarkTheme,()=>{b()}),ce(()=>y.value,(_,P)=>{P!==_&&s.getRePositionCanvas?(s.setItemUnHandle(Fe.RE_POSITION_CANVAS,!1),O(),setTimeout(()=>{Q(),b()},400)):b()}),ce(()=>C.value,_=>{l.value=_?"grab":"auto"}),ke(()=>{u.value&&(u.value.addEventListener("wheel",K,{passive:!1}),Q())}),Pe(()=>{u.value&&u.value.removeEventListener("wheel",K)}),window.onKeySpacePressHold=_=>{C.value=_},(_,P)=>{const H=$("sketch-rule");return I(),j("div",gt,[m.value?(I(),oe(H,{key:0,thick:be,scale:y.value,width:R().width,height:R().height,startX:d.value,startY:r.value,lines:v,palette:L.value},null,8,["scale","width","height","startX","startY","lines","palette"])):M("v-if",!0),D("div",{ref_key:"$app",ref:u,class:"edit-screens",onScroll:O},[D("div",{ref_key:"$container",ref:c,class:"edit-screen-container",style:X({width:i(e)*2+"px"})},[D("div",{ref_key:"refSketchRuleBox",ref:p,class:"canvas",onMousedown:F,style:X({marginLeft:"-"+(R().width/2-25)+"px"})},[D("div",{style:X({pointerEvents:C.value?"none":"auto"})},[Se(_.$slots,"default",{},void 0,!0)],4)],36)],4)],544),M(" \u4FEE\u590D\u53F3\u4E0B\u89D2\u767D\u70B9\u7528\u7684 "),M(' <div v-if="designStore.getDarkTheme" class="fix-edit-screens-block"></div> ')])}}}),Ct=ae(mt,[["__scopeId","data-v-6c481a9a"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentEdit/components/EditRule/index.vue"]]),Ee={[x.ADD]:E.global.t("project.addNew"),[x.DELETE]:E.global.t("project.delete"),[x.UPDATE]:E.global.t("project.update"),[x.MOVE]:E.global.t("project.move1"),[x.PASTE]:E.global.t("project.paste"),[x.COPY]:E.global.t("project.copy"),[x.CUT]:E.global.t("project.cut"),[x.TOP]:E.global.t("project.bringToFront"),[x.BOTTOM]:E.global.t("project.sendToBack"),[x.UP]:E.global.t("project.moveUp"),[x.DOWN]:E.global.t("project.moveDown"),[x.GROUP]:E.global.t("project.group"),[x.UN_GROUP]:E.global.t("project.ungroup"),[x.LOCK]:E.global.t("project.lock"),[x.UNLOCK]:E.global.t("project.unlock"),[x.HIDE]:E.global.t("project.hide"),[x.SHOW]:E.global.t("project.show"),[_e.CANVAS]:E.global.t("project.canvasInitialization")};var ft=Array.prototype,yt=ft.reverse;function _t(t){return t==null?t:yt.call(t)}var wt=_t;const bt=zt(wt),Et={class:"go-flex-items-center"},xt={class:"btn-text"},Tt={class:"history-list-box"},kt=["title"],It=te({__name:"index",setup(t){const{DesktopOutlineIcon:o,PencilIcon:s,TrashIcon:n,CopyIcon:a,LayersIcon:f,DuplicateIcon:u,HelpOutlineIcon:m,LockClosedOutlineIcon:p,LockOpenOutlineIcon:c,EyeOffOutlineIcon:C,EyeOutlineIcon:l}=he.ionicons5,{StackedMoveIcon:e,Carbon3DCursorIcon:g,Carbon3DSoftwareIcon:d}=he.carbon,r=oa(),v=L=>{if(L.targetType===_e.CANVAS)return o;switch(L.actionType){case x.UPDATE:return s;case x.DELETE:return n;case x.PASTE:return a;case x.TOP:return f;case x.BOTTOM:return f;case x.UP:return f;case x.DOWN:return f;case x.MOVE:return e;case x.ADD:return u;case x.GROUP:return g;case x.UN_GROUP:return d;case x.LOCK:return p;case x.UNLOCK:return c;case x.HIDE:return C;case x.SHOW:return l;default:return s}},y=L=>{if(L.targetType===_e.CANVAS)return Ee[_e.CANVAS];if(L.actionType===x.GROUP||L.actionType===x.UN_GROUP)return`${Ee[L.actionType]}`;if(L.historyData.length)return`${Ee[L.actionType]} - ${L.historyData[0].chartConfig.title}`},T=U(()=>{const L=r.getBackStack.map(k=>({label:y(k),icon:v(k)}));return bt(L.filter(k=>k.label))});return(L,k)=>{const K=$("n-button"),O=$("n-icon"),F=$("n-text"),R=$("n-scrollbar"),b=$("n-popover"),Q=$("n-tooltip");return I(),j("div",Et,[w(b,{class:"edit-history-popover","show-arrow":!1,size:"small",trigger:"click",placement:"top-start"},{trigger:S(()=>[w(K,{class:"mr-10",secondary:"",size:"small",disabled:T.value.length===0},{default:S(()=>[D("span",xt,N(i(E).global.t("project.historyRecords")),1)]),_:1},8,["disabled"])]),default:S(()=>[D("div",Tt,[w(R,{style:{"max-height":"500px"}},{default:S(()=>[(I(!0),j(le,null,ie(T.value,(_,P)=>(I(),j("div",{class:"list-item go-flex-items-center go-ellipsis-1",key:P,title:_.label},[w(O,{class:"item-icon",size:"16",depth:2,component:_.icon},null,8,["component"]),w(F,{depth:"2"},{default:S(()=>[Me(N(_.label),1)]),_:2},1024)],8,kt))),128))]),_:1}),k[0]||(k[0]=D("div",{class:"popover-modal"},null,-1))])]),_:1}),w(Q,{trigger:"hover"},{trigger:S(()=>[w(O,{size:"21",depth:3},{default:S(()=>[w(i(m))]),_:1})]),default:S(()=>[D("span",null,N(i(E).global.t("project.maxRecords"))+" "+N(i(Bt))+" "+N(i(E).global.t("project.maxRecords1")),1)]),_:1})])}}}),St=ae(It,[["__scopeId","data-v-10fc7dce"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentEdit/components/EditHistory/index.vue"]]),Dt={key:0},Lt={key:1},Ut=te({__name:"ShortcutKeyModal",props:{modelShow:Boolean},emits:["update:modelShow"],setup(t,{emit:o}){const{CloseIcon:s}=he.ionicons5,n=G(!1),a=o,f=t;ce(()=>f.modelShow,p=>{n.value=p});const u=[{label:E.global.t("project.dragCanvas"),win:`${z.SPACE.toUpperCase()} + \u{1F5B1}\uFE0F `,mac:`${Y.SPACE.toUpperCase()} + \u{1F5B1}\uFE0F `,macSource:!0},{label:E.global.t("project.move"),win:`${z.CTRL.toUpperCase()} + \u2191 or \u2192 or \u2193 or \u2190`,mac:`${Y.CTRL.toUpperCase()} + \u2191 `},{label:E.global.t("project.lock"),win:`${z.CTRL.toUpperCase()} + L `,mac:`${Y.CTRL.toUpperCase()} + L `},{label:E.global.t("project.unlock"),win:`${z.CTRL.toUpperCase()} + ${z.SHIFT.toUpperCase()}+ L `,mac:`${Y.CTRL.toUpperCase()} + ${Y.SHIFT.toUpperCase()} + L `},{label:E.global.t("project.display"),win:`${z.CTRL.toUpperCase()} + H `,mac:`${Y.CTRL.toUpperCase()} + H `},{label:E.global.t("project.hide"),win:`${z.CTRL.toUpperCase()} + ${z.SHIFT.toUpperCase()} + H `,mac:`${Y.CTRL.toUpperCase()} + ${Y.SHIFT.toUpperCase()} + H `},{label:E.global.t("project.delete"),win:"Delete".toUpperCase(),mac:`${Y.CTRL.toUpperCase()} + Backspace `},{label:E.global.t("project.copy"),win:`${z.CTRL.toUpperCase()} + C `,mac:`${Y.CTRL.toUpperCase()} + C `},{label:E.global.t("project.cut"),win:`${z.CTRL.toUpperCase()} + X `,mac:`${Y.CTRL.toUpperCase()} + X `},{label:E.global.t("project.paste"),win:`${z.CTRL.toUpperCase()} + V `,mac:`${Y.CTRL.toUpperCase()} + V `},{label:E.global.t("project.backward"),win:`${z.CTRL.toUpperCase()} + Z `,mac:`${Y.CTRL.toUpperCase()} + Z `},{label:E.global.t("project.forward"),win:`${z.CTRL.toUpperCase()} + ${z.SHIFT.toUpperCase()} + Z `,mac:`${Y.CTRL.toUpperCase()} + ${Y.SHIFT.toUpperCase()} + Z `},{label:E.global.t("project.multiSelect"),win:`${z.CTRL.toUpperCase()} + \u{1F5B1}\uFE0F `,mac:`${Y.CTRL_SOURCE_KEY.toUpperCase()} + \u{1F5B1}\uFE0F `}],m=()=>{a("update:modelShow",!1)};return(p,c)=>{const C=$("n-icon"),l=$("n-space"),e=$("n-gradient-text"),g=$("n-table"),d=$("n-modal");return I(),oe(d,{show:n.value,"onUpdate:show":c[0]||(c[0]=r=>n.value=r),"mask-closable":!0,onAfterLeave:m},{default:S(()=>[w(g,{class:"model-content",bordered:!1,"single-line":!1},{default:S(()=>[D("thead",null,[D("tr",null,[D("th",null,N(p.$t("project.feature")),1),D("th",null,"Win "+N(p.$t("project.shortcutKeys")),1),D("th",null,[w(l,{justify:"space-between"},{default:S(()=>[D("span",null," Mac "+N(p.$t("project.shortcutKeys")),1),w(C,{size:"20",class:"go-cursor-pointer",onClick:m},{default:S(()=>[w(i(s))]),_:1})]),_:1})])])]),D("tbody",null,[(I(),j(le,null,ie(u,(r,v)=>D("tr",{key:v},[D("td",null,N(r.label),1),D("td",null,N(r.win),1),r.macSource?(I(),j("td",Dt,N(r.mac),1)):(I(),j("td",Lt,[w(e,{size:22},{default:S(()=>[Me(N(r.mac.substr(0,1)),1)]),_:2},1024),Me(" + "+N(r.mac.substr(3)),1)]))])),64))])]),_:1})]),_:1},8,["show"])}}}),Mt=ae(Ut,[["__scopeId","data-v-7cc1b7e4"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentEdit/components/EditShortcutKey/ShortcutKeyModal.vue"]]),jt={class:"go-edit-shortcut"},$t=te({__name:"index",setup(t){const{DicomOverlayIcon:o}=he.carbon,s=G(!1);return(n,a)=>{const f=$("n-icon"),u=$("n-button"),m=$("n-tooltip");return I(),j("div",jt,[w(Mt,{modelShow:s.value,"onUpdate:modelShow":a[0]||(a[0]=p=>s.value=p)},null,8,["modelShow"]),w(m,{trigger:"hover"},{trigger:S(()=>[w(u,{class:"scale-btn",secondary:"",size:"small",onClick:a[1]||(a[1]=p=>s.value=!0)},{default:S(()=>[w(f,{size:"21",depth:3},{default:S(()=>[w(i(o))]),_:1})]),_:1})]),default:S(()=>[D("span",null,N(n.$t("project.shortcutKeys")),1)]),_:1})])}}}),Ot=ae($t,[["__scopeId","data-v-caa0d0bc"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentEdit/components/EditShortcutKey/index.vue"]]),Rt={class:"go-edit-bottom"},Pt=te({__name:"index",setup(t){pe(T=>({"d72b5d6c-themeColor":a.value}));const{LockClosedOutlineIcon:o,LockOpenOutlineIcon:s}=he.ionicons5,n=ve(),a=G(n.getAppTheme),f=Be(),u=se(),{lockScale:m,scale:p}=ye(u.getEditCanvas),c=G(null);let C=[{label:"200%",value:200},{label:"150%",value:150},{label:"100%",value:100},{label:"50%",value:50},{label:E.global.t("project.responsive"),value:0}];const l=G(""),e=T=>{if(c.value?.blur(),T===0){f.setItemUnHandle(Fe.RE_POSITION_CANVAS,!0),u.computedScale();return}u.setScale(T/100)},g=()=>{u.setEditCanvas(B.LOCK_SCALE,!m.value)},d=G(100),r=T=>`${T}%`,v=T=>{u.setScale(T/100)},y=Ue({100:""});return Ft(()=>{const T=(p.value*100).toFixed(0);l.value=`${T}%`,d.value=parseInt(T)}),(T,L)=>{const k=$("n-text"),K=$("n-space"),O=$("n-select"),F=$("n-icon"),R=$("n-button"),b=$("n-tooltip"),Q=$("n-slider");return I(),j("div",Rt,[w(K,null,{default:S(()=>[M(" \u5386\u53F2\u8BB0\u5F55 "),w(i(St)),M(" CTRL\u6309\u952E\u89E6\u53D1\u5C55\u793A "),w(k,{id:"keyboard-dress-show",depth:"3"})]),_:1}),w(K,{class:"bottom-ri"},{default:S(()=>[M(" \u5FEB\u6377\u952E\u63D0\u793A "),w(Ot),M(" \u7F29\u653E\u6BD4\u4F8B "),w(O,{ref_key:"selectInstRef",ref:c,class:"scale-btn",value:l.value,"onUpdate:value":[L[0]||(L[0]=_=>l.value=_),e],size:"mini",disabled:i(m),options:i(C)},null,8,["value","disabled","options"]),M(" \u9501\u5B9A\u7F29\u653E "),w(b,{trigger:"hover"},{trigger:S(()=>[w(R,{onClick:g,text:""},{default:S(()=>[w(F,{class:ne(["lock-icon",{color:i(m)}]),size:"18",depth:2},{default:S(()=>[i(m)?(I(),oe(i(o),{key:0})):(I(),oe(i(s),{key:1}))]),_:1},8,["class"])]),_:1})]),default:S(()=>[D("span",null,N(i(m)?T.$t("project.unlock"):T.$t("project.lock"))+N(T.$t("project.currentRatio")),1)]),_:1}),M(" \u62D6\u52A8 "),w(Q,{class:"scale-slider",value:d.value,"onUpdate:value":[L[1]||(L[1]=_=>d.value=_),v],"default-value":50,min:10,max:200,step:5,"format-tooltip":r,disabled:i(m),marks:y},null,8,["value","disabled","marks"])]),_:1})])}}}),At=ae(Pt,[["__scopeId","data-v-d72b5d6c"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentEdit/components/EditBottom/index.vue"]]),Ht=te({__name:"index",setup(t){const o=Vt(),{updateComponent:s}=Qt(),n=se(),{handleContextMenu:a}=je();Wt(sa,null),We(async()=>{}),console.log("hello!"),isNaN(o.params.id[0]-0)||qt({id:o.params.id[0]-0}).then(async g=>{if(g.code==200){let d=JSON.parse(g.data);n.componentList=[],console.log("\u8FDB\u5165\u7F16\u8F91???"),await s(d,!1,!1,!0),sessionStorage.setItem("editId",o.params.id[0])}}).catch(g=>{console.log(g)});const{mouseenterHandle:f,mouseleaveHandle:u,mousedownHandle:m,mouseClickHandle:p}=Re(),c=(g,d,r)=>{if(n.getTargetChart.selectId.length>1)return d.filter(y=>[Z.GROUP,Z.DELETE].includes(y.key));const v=[];return r.status.lock?v.push(Z.LOCK):v.push(Z.UNLOCK),r.status.hide?v.push(Z.HIDE):v.push(Z.SHOW),g.filter(y=>!v.includes(y.key))},C=U(()=>n.getEditCanvasConfig.chartThemeSetting),l=U(()=>Ae(n.getEditCanvasConfig.chartCustomThemeColorInfo)[n.getEditCanvasConfig.chartThemeColor]);U(()=>n.getEditCanvasConfig.filterShow);const e=U(()=>{const g=n.getEditCanvasConfig.background,d=n.getEditCanvasConfig.backgroundImage;return{...n.getEditCanvasConfig.selectColor?{background:g||void 0}:{background:`url(${d}) no-repeat center center / cover !important`},width:"inherit",height:"inherit"}});return ke(()=>{la()}),(g,d)=>(I(),j(le,null,[M(" <edit-rule></edit-rule> "),w(i(da),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:i(Oe),onDrop:i(Ze),onDragover:i($e),onDragenter:i($e)},{bottom:S(()=>[w(i(At))]),default:S(()=>[w(i(Ct),null,{default:S(()=>[M(" \u753B\u5E03\u4E3B\u4F53 "),D("div",{id:"go-chart-edit-content",onContextmenu:d[0]||(d[0]=(...r)=>i(a)&&i(a)(...r))},[M(" \u5C55\u793A "),w(i(ht),null,{default:S(()=>[M(" \u6EE4\u955C\u9884\u89C8 "),D("div",{style:X({...i(fe)(i(n).getEditCanvasConfig),...e.value})},[M(" \u56FE\u8868 "),(I(!0),j(le,null,ie(i(n).getComponentList,(r,v)=>(I(),j("div",{key:r.id},[M(" \u5206\u7EC4 "),r.isGroup?(I(),oe(i(nt),{key:0,groupData:r,groupIndex:v},null,8,["groupData","groupIndex"])):(I(),j(le,{key:1},[M(" \u5355\u7EC4\u4EF6 "),w(i(we),{"data-id":r.id,index:v,style:X({...i(ge)(r.attr,v),...i(Ke)(r.styles)}),item:r,onClick:y=>i(p)(y,r),onMousedown:y=>i(m)(y,r),onMouseenter:y=>i(f)(y,r),onMouseleave:y=>i(u)(y,r),onContextmenu:y=>i(a)(y,r,c)},{default:S(()=>[(I(),oe(He(r.chartConfig.chartKey),{class:ne(["edit-content-chart",i(De)(r.styles.animations)]),chartConfig:r,themeSetting:C.value,themeColor:l.value,style:X({...i(re)(r.attr),...i(fe)(r.styles),...i(Le)(r.styles)})},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu"])],2112))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"])],2112))}});Ve=ae(Ht,[["__scopeId","data-v-77e0df84"],["__file","/Users/cyj/Desktop/work project/Scada-4.21/newScada/src/views/chart/ContentEdit/index.vue"]])});export{pa as __tla,Ve as default};
